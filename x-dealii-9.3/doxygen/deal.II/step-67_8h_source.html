<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step-67_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: doc/doxygen/tutorial/step-67.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.3.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.3.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e68e8157741866f444e17edd764ebbae.html">doc</a></li><li class="navelem"><a class="el" href="dir_04f2ecc425faf0d475a3caf484e551f3.html">doxygen</a></li><li class="navelem"><a class="el" href="dir_7f921e14d817774bc32ca4338fe11225.html">tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-67.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="step-67_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; *     stage_5_order_4, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; *     stage_7_order_4, <span class="comment">/* Tselios, Simos, 2007 */</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; *     stage_9_order_5, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; *   };</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; *   constexpr LowStorageRungeKuttaScheme lsrk_scheme = stage_5_order_4;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; * </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; * </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; * Eventually, we select a detail of the spatial discretization, namely the</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; * numerical flux (Riemann solver) at the faces between cells. For <span class="keyword">this</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; * program, we have implemented a modified variant of the Lax--Friedrichs</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; * flux and the Harten--Lax--van Leer (HLL) flux.</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; * </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; * @code</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; *   <span class="keyword">enum</span> EulerNumericalFlux</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; *   {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; *     lax_friedrichs_modified,</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; *     harten_lax_vanleer,</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; *   };</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; *   constexpr EulerNumericalFlux numerical_flux_type = lax_friedrichs_modified;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; * </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; * </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; * </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; * </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; * </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Equationdata&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; * &lt;h3&gt;Equation data&lt;/h3&gt;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; * </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; * </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; * We now define a <span class="keyword">class </span>with the exact solution for the test case 0 and <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; * with a background flow field <span class="keywordflow">for</span> test <span class="keywordflow">case</span> 1 of the channel. Given that</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; * the Euler equations are a problem with @f$d+2@f$ equations in @f$d@f$ dimensions,</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; * we need to tell the <a class="code" href="classFunction.html">Function</a> base <span class="keyword">class </span>about the correct number of</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; * components.</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; * </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; * @code</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; *   <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; *   {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; *   <span class="keyword">public</span>:</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; *     ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> time)</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; *       : <a class="code" href="classFunction.html">Function&lt;dim&gt;</a>(dim + 2, time)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; *     {}</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; * </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; *     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; *                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; *   };</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; * </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; * </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; * </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; * </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; * As far as the actual <span class="keyword">function</span> implemented is concerned, the analytical</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; * test <span class="keywordflow">case</span> is an isentropic vortex <span class="keywordflow">case</span> (see <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. the book by Hesthaven</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; * and Warburton, Example 6.1 in Section 6.6 on page 209) which fulfills the</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; * Euler equations with <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> force term on the right hand side. Given that</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; * definition, we <span class="keywordflow">return</span> either the density, the momentum, or the energy</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; * depending on which component is requested. Note that the original</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; * definition of the density involves the @f$\frac{1}{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> -1}@f$-th power of</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; * some expression. Since `<a class="code" href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow</a>()` has pretty slow implementations on</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; * some systems, we replace it by logarithm followed by exponentiation (of</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; * base 2), which is mathematically equivalent but usually much better</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; * optimized. This formula might lose accuracy in the last digits</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; * <span class="keywordflow">for</span> very small <a class="code" href="namespacenumbers.html">numbers</a> compared to `<a class="code" href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow</a>()`, but we are happy with</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; * it anyway, since small <a class="code" href="namespacenumbers.html">numbers</a> map to data close to 1.</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; *   </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; * </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; * For the channel test <span class="keywordflow">case</span>, we simply select a density of 1, a velocity of</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; * 0.4 in @f$x@f$ direction and <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> in the other directions, and an energy that</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; * corresponds to a speed of sound of 1.3 measured against the background</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; * velocity field, computed from the relation @f$E = \frac{c^2}{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> (\<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; * -1)} + \frac 12 \rho \|u\|^2@f$.</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; * </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; * @code</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; *   <span class="keywordtype">double</span> ExactSolution&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; x,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; *                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component) <span class="keyword">const</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; *   {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; *     <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; * </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; *     <span class="keywordflow">switch</span> (testcase)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; *       {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; *         <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; *           {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; *             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(dim == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> beta = 5;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; * </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; *             x0[0] = 5.;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; *               (x - x0).norm_square() - 2. * (x[0] - x0[0]) * t + t * t;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> factor =</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; *               beta / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; *               std::abs(1. - (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.) / <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * 0.25 * factor * factor));</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> density = std::exp2(density_log * (1. / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.)));</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - factor * (x[1] - x0[1]);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; *             <span class="keyword">const</span> <span class="keywordtype">double</span> v       = factor * (x[0] - t - x0[0]);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; * </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; *             <span class="keywordflow">if</span> (component == 0)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; *               <span class="keywordflow">return</span> density;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 1)</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; *               <span class="keywordflow">return</span> density * u;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 2)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; *               <span class="keywordflow">return</span> density * v;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; *             <span class="keywordflow">else</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; *               {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; *                 <span class="keyword">const</span> <span class="keywordtype">double</span> pressure =</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; *                   std::exp2(density_log * (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.)));</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; *                 <span class="keywordflow">return</span> pressure / (<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> - 1.) +</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; *                        0.5 * (density * u * u + density * v * v);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; *               }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; *           }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; * </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; *         <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; *           {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; *             <span class="keywordflow">if</span> (component == 0)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; *               <span class="keywordflow">return</span> 1.;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == 1)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; *               <span class="keywordflow">return</span> 0.4;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (component == dim + 1)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160; *               <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; *             <span class="keywordflow">else</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; *               <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; *           }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; * </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; *         <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; *           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; *           <span class="keywordflow">return</span> 0.;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; *       }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; *   }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; * </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; * </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; * </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; * </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; * </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; * &lt;a name=<span class="stringliteral">&quot;LowstorageexplicitRungeKuttatimeintegrators&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; * &lt;h3&gt;Low-storage <span class="keyword">explicit</span> Runge--Kutta time integrators&lt;/h3&gt;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; * </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; * </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; * The next few lines implement a few low-storage variants of Runge--Kutta</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; * methods. These methods have specific Butcher tableaux with coefficients</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; * @f$b_i@f$ and @f$a_i@f$ as shown in the introduction. As usual in Runge--Kutta</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; * method, we can deduce time steps, @f$c_i = \sum_{j=1}^{i-2} b_i + a_{i-1}@f$</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; * from those coefficients. The main advantage of <span class="keyword">this</span> kind of scheme is the</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; * fact that only two vectors are needed per stage, namely the accumulated</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; * part of the solution @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$ (that will hold the solution</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; * @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^{n+1}@f$ at the <span class="keyword">new</span> time @f$t^{n+1}@f$ after the last stage), the</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; * update vector @f$\mathbf{r}_i@f$ that gets evaluated during the stages, plus</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> vector @f$\mathbf{k}_i@f$ to hold the evaluation of the <span class="keyword">operator</span>. Such a</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; * Runge--Kutta setup reduces the memory storage and memory access. As the</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; * memory bandwidth is often the performance-limiting factor on modern</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; * hardware when the evaluation of the differential <span class="keyword">operator</span> is</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; * well-optimized, performance can be improved over standard time</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; * integrators. This is <span class="keyword">true</span> also when taking into account that a</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; * conventional Runge--Kutta scheme might allow <span class="keywordflow">for</span> slightly larger time</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; * steps as more <a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> parameters allow <span class="keywordflow">for</span> better stability properties.</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; *   </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; * </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; * In <span class="keyword">this</span> tutorial programs, we concentrate on a few variants of</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; * low-storage schemes defined in the article by Kennedy, Carpenter, and</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; * Lewis (2000), as well as <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> variant described by Tselios and Simos</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; * (2007). There is a large series of other schemes available, which could</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; * be addressed by additional sets of coefficients or slightly different</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; * update formulas.</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; *   </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; * </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; * We define a single <span class="keyword">class</span> <span class="keywordflow">for</span> the four integrators, distinguished by the</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; * <span class="keyword">enum</span> described above. To each scheme, we then fill the vectors <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; * @f$b_i@f$ and @f$a_i@f$ to the given variables in the <span class="keyword">class</span>.</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; * </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; * @code</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; *   <span class="keyword">class</span> LowStorageRungeKuttaIntegrator</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; *   {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; *   <span class="keyword">public</span>:</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; *     LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> LowStorageRungeKuttaScheme scheme)</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; *     {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; *       <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; * </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; * First comes the three-stage scheme of order three by Kennedy et al.</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; * (2000). While its stability region is significantly smaller than <span class="keywordflow">for</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; * the other schemes, it only involves three stages, so it is very</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; * competitive in terms of the work per stage.</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; * </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; * @code</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160; *       switch (scheme)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; *         {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; *           <span class="keywordflow">case</span> stage_3_order_3:</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; *             {</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; *               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; *             }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; * </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; * </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; * The next scheme is a five-stage scheme of order four, again</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; * defined in the paper by Kennedy et al. (2000).</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; * </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; * @code</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; *           <span class="keywordflow">case</span> stage_5_order_4:</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; *             {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; *               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; *             }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; * </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; * </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; * The following scheme of seven stages and order four has been</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; * explicitly derived <span class="keywordflow">for</span> acoustics problems. It is a balance of</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; * accuracy <span class="keywordflow">for</span> imaginary <a class="code" href="classSymmetricTensor.html#a45c9cd0a3fecbd58ae133dfdd104f9f9">eigenvalues</a> among fourth order schemes,</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; * combined with a large stability region. Since DG schemes are</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; * dissipative among the highest frequencies, <span class="keyword">this</span> does not</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; * necessarily translate to the highest possible time step per</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; * stage. In the context of the present tutorial program, the</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; * numerical flux plays a crucial role in the dissipation and thus</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; * also the maximal stable time step size. For the modified</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; * Lax--Friedrichs flux, <span class="keyword">this</span> scheme is similar to the</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; * `stage_5_order_4` scheme in terms of step size per stage <span class="keywordflow">if</span> only</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; * stability is considered, but somewhat less efficient <span class="keywordflow">for</span> the HLL</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; * flux.</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; * </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; * @code</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; *           <span class="keywordflow">case</span> stage_7_order_4:</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; *             {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; *               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; *             }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; * </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; * </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; * The last scheme included here is the nine-stage scheme of order</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; * five from Kennedy et al. (2000). It is the most accurate among</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; * the schemes used here, but the higher order of accuracy</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; * sacrifices some stability, so the step length normalized per</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; * stage is less than <span class="keywordflow">for</span> the fourth order schemes.</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; * </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; * @code</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; *           <span class="keywordflow">case</span> stage_9_order_5:</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; *             {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; *               lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; *               <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; *             }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; * </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; *           <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; *             <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; *         }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; *       <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; *         <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; *         rk_integrator(lsrk);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; *       rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; *     }</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; * </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; *     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages() const</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; *     {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; *       <span class="keywordflow">return</span> bi.size();</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; *     }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; * </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; * </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; * The main <span class="keyword">function</span> of the time integrator is to go through the stages,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; * evaluate the <span class="keyword">operator</span>, prepare the @f$\mathbf{r}_i@f$ vector <span class="keywordflow">for</span> the next</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; * evaluation, and update the solution vector @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$. We hand off</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; * the work to the `pde_operator` involved in order to be able to <a class="code" href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">merge</a></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; * the vector operations of the Runge--Kutta setup with the evaluation of</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; * the differential <span class="keyword">operator</span> <span class="keywordflow">for</span> better performance, so all we <span class="keywordflow">do</span> here is</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; * to delegate the vectors and coefficients.</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; *     </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; * </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; * We separately <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> the <span class="keyword">operator</span> <span class="keywordflow">for</span> the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> stage because we need</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; * slightly modified arguments there: We evaluate the solution from</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; * the old solution @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^n@f$ rather than a @f$\mathbf r_i@f$ vector, so</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; * the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> argument is `solution`. We here let the stage vector</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; * @f$\mathbf{r}_i@f$ also hold the temporary result of the evaluation, as it</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; * is not used otherwise. For all subsequent stages, we use the vector</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; * `vec_ki` as the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> vector argument to store the result of the</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; * <span class="keyword">operator</span> evaluation. Finally, when we are at the last stage, we must</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; * skip the computation of the vector @f$\mathbf{r}_{s+1}@f$ as there is no</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; * coefficient @f$a_s@f$ available (nor will it be used).</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; * </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; * @code</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; *     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; *     <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> Operator &amp;pde_operator,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; *                            <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; *                            <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; *                            VectorType &amp;    solution,</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; *                            VectorType &amp;    vec_ri,</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; *                            VectorType &amp;    vec_ki) <span class="keyword">const</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; *     {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; *       <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; * </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; *       pde_operator.perform_stage(current_time,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; *                                  bi[0] * time_step,</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; *                                  ai[0] * time_step,</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; *                                  solution,</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; *                                  vec_ri,</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; *                                  solution,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; *                                  vec_ri);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; * </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; *       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> stage = 1; stage &lt; bi.size(); ++stage)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; *         {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; *           <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[stage];</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; *           pde_operator.perform_stage(current_time + c_i * time_step,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; *                                      bi[stage] * time_step,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; *                                      (stage == bi.size() - 1 ?</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; *                                         0 :</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; *                                         ai[stage] * time_step),</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; *                                      vec_ri,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; *                                      vec_ki,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; *                                      solution,</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; *                                      vec_ri);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; *         }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; *     }</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; * </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; *   <span class="keyword">private</span>:</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; *     std::vector&lt;double&gt; bi;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; *     std::vector&lt;double&gt; ai;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; *     std::vector&lt;double&gt; ci;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; *   };</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; * </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; * </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; * </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; * </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; * </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; * &lt;a name=<span class="stringliteral">&quot;ImplementationofpointwiseoperationsoftheEulerequations&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; * &lt;h3&gt;Implementation of <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a>-wise operations of the Euler equations&lt;/h3&gt;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; * </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; * </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; * In the following <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, we implement the various problem-specific</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; * operators pertaining to the Euler equations. Each <span class="keyword">function</span> acts on the</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; * vector of conserved variables @f$[\rho, \rho\mathbf{u}, <a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>]@f$ that we hold in</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; * the solution vectors, and computes various derived quantities.</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; *   </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; * </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; * First out is the computation of the velocity, that we derive from the</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; * momentum variable @f$\rho \mathbf{u}@f$ by division by @f$\rho@f$. One thing to</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; * note here is that we decorate all those <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> with the keyword</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; * `<a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a>`. This is a special macro that maps to a</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; * compiler-specific keyword that tells the compiler to never create a</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; * <span class="keyword">function</span> <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> <span class="keywordflow">for</span> any of those <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, and instead move the</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; * implementation &lt;a</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; * href=<span class="stringliteral">&quot;https://en.wikipedia.org/wiki/Inline_function&quot;</span>&gt;<span class="keyword">inline</span>&lt;/a&gt; to where</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; * they are called. This is critical <span class="keywordflow">for</span> performance because we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> into some</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; * of those <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> millions or billions of times: For example, we both use</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; * the velocity <span class="keywordflow">for</span> the computation of the flux further down, but also <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; * computation of the pressure, and both of these places are evaluated at</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; * every quadrature <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> of every cell. Making sure these <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> are</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; * inlined ensures not only that the processor does not have to execute a jump</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; * instruction into the <span class="keyword">function</span> (and the corresponding <span class="keywordflow">return</span> jump), but also</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; * that the compiler can re-use intermediate information from <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keyword">function</span><span class="stringliteral">&#39;s</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="stringliteral"> * context in code that comes after the place where the function was called.</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="stringliteral"> * (We note that compilers are generally quite good at figuring out which</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="stringliteral"> * functions to inline by themselves. Here is a place where compilers may or</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="stringliteral"> * may not have figured it out by themselves but where we know for sure that</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="stringliteral"> * inlining is a win.)</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="stringliteral"> *   </span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="stringliteral"> * Another trick we apply is a separate variable for the inverse density</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="stringliteral"> * @f$\frac{1}{\rho}@f$. This enables the compiler to only perform a single</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="stringliteral"> * division for the flux, despite the division being used at several</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="stringliteral"> * places. As divisions are around ten to twenty times as expensive as</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="stringliteral"> * multiplications or additions, avoiding redundant divisions is crucial for</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="stringliteral"> * performance. We note that taking the inverse first and later multiplying</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="stringliteral"> * with it is not equivalent to a division in floating point arithmetic due</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="stringliteral"> * to roundoff effects, so the compiler is not allowed to exchange one way by</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="stringliteral"> * the other with standard optimization flags. However, it is also not</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="stringliteral"> * particularly difficult to write the code in the right way.</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="stringliteral"> *   </span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="stringliteral"> * To summarize, the chosen strategy of always inlining and careful</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="stringliteral"> * definition of expensive arithmetic operations allows us to write compact</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="stringliteral"> * code without passing all intermediate results around, despite making sure</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="stringliteral"> * that the code maps to excellent machine code.</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="stringliteral"> * @code</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="stringliteral"> *   template &lt;int dim, typename Number&gt;</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="stringliteral"> *   inline DEAL_II_ALWAYS_INLINE </span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="stringliteral"> *     Tensor&lt;1, dim, Number&gt;</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="stringliteral"> *     euler_velocity(const Tensor&lt;1, dim + 2, Number&gt; &amp;conserved_variables)</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="stringliteral"> *   {</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="stringliteral"> *     const Number inverse_density = Number(1.) / conserved_variables[0];</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="stringliteral"> *     Tensor&lt;1, dim, Number&gt; velocity;</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="stringliteral"> *     for (unsigned int d = 0; d &lt; dim; ++d)</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="stringliteral"> *       velocity[d] = conserved_variables[1 + d] * inverse_density;</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="stringliteral"> *     return velocity;</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="stringliteral"> *   }</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="stringliteral"> * @endcode</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="stringliteral"> * The next function computes the pressure from the vector of conserved</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="stringliteral"> * variables, using the formula @f$p = (\gamma - 1) \left(E - \frac 12 \rho</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="stringliteral"> * \mathbf{u}\cdot \mathbf{u}\right)@f$. As explained above, we use the</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="stringliteral"> * velocity from the `euler_velocity()` function. Note that we need to</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="stringliteral"> * specify the first template argument `dim` here because the compiler is</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="stringliteral"> * not able to deduce it from the arguments of the tensor, whereas the</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="stringliteral"> * second argument (number type) can be automatically deduced.</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="stringliteral"> * @code</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="stringliteral"> *   template &lt;int dim, typename Number&gt;</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="stringliteral"> *   inline DEAL_II_ALWAYS_INLINE </span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="stringliteral"> *     Number</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="stringliteral"> *     euler_pressure(const Tensor&lt;1, dim + 2, Number&gt; &amp;conserved_variables)</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="stringliteral"> *   {</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="stringliteral"> *     const Tensor&lt;1, dim, Number&gt; velocity =</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="stringliteral"> *       euler_velocity&lt;dim&gt;(conserved_variables);</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="stringliteral"> *     Number rho_u_dot_u = conserved_variables[1] * velocity[0];</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="stringliteral"> *     for (unsigned int d = 1; d &lt; dim; ++d)</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="stringliteral"> *       rho_u_dot_u += conserved_variables[1 + d] * velocity[d];</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="stringliteral"> *     return (gamma - 1.) * (conserved_variables[dim + 1] - 0.5 * rho_u_dot_u);</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="stringliteral"> *   }</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="stringliteral"> * @endcode</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="stringliteral"> * Here is the definition of the Euler flux function, i.e., the definition</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="stringliteral"> * of the actual equation. Given the velocity and pressure (that the</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="stringliteral"> * compiler optimization will make sure are done only once), this is</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="stringliteral"> * straight-forward given the equation stated in the introduction.</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="stringliteral"> * @code</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="stringliteral"> *   template &lt;int dim, typename Number&gt;</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="stringliteral"> *   inline DEAL_II_ALWAYS_INLINE </span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="stringliteral"> *     Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;&gt;</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="stringliteral"> *     euler_flux(const Tensor&lt;1, dim + 2, Number&gt; &amp;conserved_variables)</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="stringliteral"> *   {</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="stringliteral"> *     const Tensor&lt;1, dim, Number&gt; velocity =</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="stringliteral"> *       euler_velocity&lt;dim&gt;(conserved_variables);</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="stringliteral"> *     const Number pressure = euler_pressure&lt;dim&gt;(conserved_variables);</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="stringliteral"> *     Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;&gt; flux;</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="stringliteral"> *     for (unsigned int d = 0; d &lt; dim; ++d)</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="stringliteral"> *       {</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="stringliteral"> *         flux[0][d] = conserved_variables[1 + d];</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="stringliteral"> *         for (unsigned int e = 0; e &lt; dim; ++e)</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="stringliteral"> *           flux[e + 1][d] = conserved_variables[e + 1] * velocity[d];</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="stringliteral"> *         flux[d + 1][d] += pressure;</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="stringliteral"> *         flux[dim + 1][d] =</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="stringliteral"> *           velocity[d] * (conserved_variables[dim + 1] + pressure);</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="stringliteral"> *       }</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="stringliteral"> *     return flux;</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="stringliteral"> *   }</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="stringliteral"> * @endcode</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="stringliteral"> * This next function is a helper to simplify the implementation of the</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="stringliteral"> * numerical flux, implementing the action of a tensor of tensors (with</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="stringliteral"> * non-standard outer dimension of size `dim + 2`, so the standard overloads</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="stringliteral"> * provided by deal.II&#39;</span>s tensor classes <span class="keywordflow">do</span> not <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a> here) with another</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; * tensor of the same inner dimension, i.e., a <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-vector product.</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; * </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; * @code</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; *     <a class="code" href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, n_components, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>,</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; *               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         vector)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; *   {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> result;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; n_components; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; *       result[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * vector;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; *     <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; *   }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; * </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; * </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; * This <span class="keyword">function</span> implements the numerical flux (Riemann solver). It gets the</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; * state from the two sides of an <span class="keyword">interface </span>and the normal vector, oriented</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; * from the side of the solution @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$ towards the solution</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; * @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$. In finite <a class="code" href="namespaceGridTools.html#a9e8169dc4981e90ba5d2386a87efa042">volume</a> methods which rely on piece-wise</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160; * constant data, the numerical flux is the central ingredient as it is the</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; * only place where the physical information is entered. In DG methods, the</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; * numerical flux is less central due to the polynomials within the elements</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; * and the physical flux used there. As a result of higher-degree</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; * interpolation with consistent <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> from both sides in the limit of a</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; * continuous solution, the numerical flux can be seen as a control of the</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; * jump of the solution from both sides to weakly impose continuity. It is</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; * important to realize that a numerical flux alone cannot stabilize a</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; * high-order DG method in the presence of shocks, and thus any DG method</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; * must be combined with further shock-capturing techniques to handle those</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; * cases. In <span class="keyword">this</span> tutorial, we focus on wave-like solutions of the Euler</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; * equations in the subsonic regime without strong discontinuities where our</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; * basic scheme is sufficient.</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; *   </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; * </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; * Nonetheless, the numerical flux is decisive in terms of the numerical</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; * dissipation of the overall scheme and influences the admissible time step</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; * size with <span class="keyword">explicit</span> Runge--Kutta methods. We consider two choices, a</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; * modified Lax--Friedrichs scheme and the widely used Harten--Lax--van Leer</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; * (HLL) flux. For both variants, we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> need to get the velocities and</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; * pressures from both sides of the interface and evaluate the physical</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; * Euler flux.</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160; *   </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; * </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; * For the local Lax--Friedrichs flux, the definition is @f$\hat{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}}</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; * =\frac{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}(\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-)+\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">F</a>}(\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+)}{2} +</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; * \frac{\lambda}{2}\left[\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^--\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+\right]\otimes</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160; * \mathbf{n^-}@f$, where the factor @f$\lambda =</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; * \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)@f$ gives the</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; * maximal wave speed and @f$c = \<a class="code" href="classVectorizedArray.html#a935e528bb3b525ac056167a64d7ab71d">sqrt</a>{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p / \rho}@f$ is the speed of</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; * sound. Here, we choose two modifications of that expression <span class="keywordflow">for</span> reasons</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; * of computational efficiency, given the small impact of the flux on the</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; * solution. For the above definition of the factor @f$\lambda@f$, we would need</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; * to take four square roots, two <span class="keywordflow">for</span> the two velocity norms and two <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; * speed of sound on either side. The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> modification is hence to rather</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; * use @f$<a class="code" href="classVectorizedArray.html#a935e528bb3b525ac056167a64d7ab71d">\sqrt</a>{\|\mathbf{u}\|^2+c^2}@f$ as an estimate of the maximal speed</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; * (which is at most a factor of 2 away from the actual maximum, as shown in</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; * the introduction). This allows us to pull the square root out of the</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; * maximum and get away with a single square root computation. The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; * modification is to further relax on the parameter @f$\lambda@f$---the smaller</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; * it is, the smaller the dissipation factor (which is multiplied by the</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; * jump in @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}@f$, which might result in a smaller or bigger</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; * dissipation in the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a>). This allows us to fit the spectrum into the</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; * stability region of the <span class="keyword">explicit</span> Runge--Kutta integrator with bigger time</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160; * steps. However, we cannot make dissipation too small because otherwise</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; * imaginary <a class="code" href="classSymmetricTensor.html#a45c9cd0a3fecbd58ae133dfdd104f9f9">eigenvalues</a> grow larger. Finally, the current conservative</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; * formulation is not energy-stable in the limit of @f$\lambda\to 0@f$ as it is</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; * not skew-<a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a>, and would need additional measures such as <a class="code" href="namespaceAdaptationStrategies_1_1Refinement.html#a0fda1b577bf969eb15b3992120d682a3">split</a>-form</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; * DG schemes in that <span class="keywordflow">case</span>.</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160; *   </div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; * </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; * For the HLL flux, we follow the formula from literature, introducing an</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; * additional weighting of the two states from Lax--Friedrichs by a</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; * parameter @f$s@f$. It is derived from the physical transport directions of</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; * the Euler equations in terms of the current direction of velocity and</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; * sound speed. For the velocity, we here choose a simple arithmetic average</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; * which is sufficient <span class="keywordflow">for</span> DG scenarios and moderate jumps in material</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; * parameters.</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; *   </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; * </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; * Since the numerical flux is multiplied by the normal vector in the weak</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; * form, we multiply by the result by the normal vector <span class="keywordflow">for</span> all terms in the</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; * equation. In these multiplications, the `<span class="keyword">operator</span>*` defined above enables</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; * a compact notation similar to the mathematical definition.</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; *   </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; * </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; * In <span class="keyword">this</span> and the following <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, we use variable suffixes `_m` and</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; * `_p` to indicate quantities derived from @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$ and @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160; * i.e., <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="stringliteral">&quot;here&quot;</span> and <span class="stringliteral">&quot;there&quot;</span> relative to the current cell when looking</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; * at a neighbor cell.</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; * </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; * @code</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; *   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; *     euler_numerical_flux(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; *                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; *                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    normal)</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; *   {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; * </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; * </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; *     <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; * </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160; *     <span class="keywordflow">switch</span> (numerical_flux_type)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; *       {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; *         <span class="keywordflow">case</span> lax_friedrichs_modified:</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; *           {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="group__Exceptions.html#gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> =</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; *               0.5 * <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(velocity_p.norm_square() +</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; *                                          <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; *                                        velocity_m.norm_square() +</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; *                                          <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; * </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; *             <span class="keywordflow">return</span> 0.5 * (flux_m * normal + flux_p * normal) +</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; *                    0.5 * lambda * (u_m - u_p);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; *           }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160; * </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; *         <span class="keywordflow">case</span> harten_lax_vanleer:</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; *           {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; *               0.5 * ((velocity_m + velocity_p) * normal);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(std::abs(</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; *               0.5 * <a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> *</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; *               (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; *             <span class="keyword">const</span> Number s_pos =</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(Number(), avg_velocity_normal + avg_c);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; *             <span class="keyword">const</span> Number s_neg =</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">std::min</a>(Number(), avg_velocity_normal - avg_c);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; *             <span class="keyword">const</span> Number inverse_s = Number(1.) / (s_pos - s_neg);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; * </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; *             <span class="keywordflow">return</span> inverse_s *</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; *                    ((s_pos * (flux_m * normal) - s_neg * (flux_p * normal)) -</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160; *                     s_pos * s_neg * (u_m - u_p));</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; *           }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; * </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; *         <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; *           {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; *             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; *             <span class="keywordflow">return</span> {};</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; *           }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; *       }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; *   }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; * </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160; * </div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; * </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; * </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; * This and the next <span class="keyword">function</span> are helper <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> to provide compact</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; * evaluation calls as multiple points get batched together via a</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; * <a class="code" href="classVectorizedArray.html">VectorizedArray</a> argument (see the @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span> tutorial <span class="keywordflow">for</span> details). This</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; * <span class="keyword">function</span> is used <span class="keywordflow">for</span> the subsonic outflow boundary conditions where we</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; * need to <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the energy component to a prescribed <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>. The next <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; * requests the solution on all components and is used <span class="keywordflow">for</span> inflow boundaries</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; * where all components of the solution are <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a>.</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; * </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; * @code</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; *   <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; *   evaluate_function(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; *                     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;dim, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; *                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         component)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; *   {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; *     <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> result;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v)</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; *       {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; *         <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> p;</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; *           p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v];</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; *         result[v] = <span class="keyword">function</span>.value(p, component);</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; *       }</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160; *     <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; *   }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; * </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; * </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; *   <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; *   evaluate_function(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; *                     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;dim, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; *   {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; *     <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.n_components, n_components);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; result;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; *       {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; *         <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> p;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; *           p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v];</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; n_components; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160; *           result[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v] = <span class="keyword">function</span>.<a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(p, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; *       }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; *     <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; *   }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; * </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160; * </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; * </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; * </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; * </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; * &lt;a name=<span class="stringliteral">&quot;TheEulerOperationclass&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; * &lt;h3&gt;The EulerOperation <span class="keyword">class</span>&lt;/h3&gt;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; * </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; * </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; * This <span class="keyword">class </span>implements the evaluators for the Euler problem, in analogy to</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; * the `LaplaceOperator` <span class="keyword">class </span>of @ref step_37 &quot;step-37&quot; or @ref step_59 &quot;step-59&quot;. Since the present</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; * <span class="keyword">operator</span> is non-linear and does not require a <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> interface (to be</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; * handed over to preconditioners), we skip the various `vmult` <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; * otherwise present in <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> operators and only implement an `<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>`</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; * <span class="keyword">function</span> as well as the combination of `<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>` with the required vector</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; * updates <span class="keywordflow">for</span> the low-storage Runge--Kutta time integrator mentioned above</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; * (called `perform_stage`). Furthermore, we have added three additional</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; * <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> involving <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> routines, namely <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> to compute an</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; * estimate of the time step scaling (that is combined with the Courant</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; * number <span class="keywordflow">for</span> the actual time step size) based on the velocity and speed of</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; * sound in the elements, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">for</span> the projection of solutions (specializing</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; * <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>() <span class="keywordflow">for</span> the DG <span class="keywordflow">case</span>), and <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> to compute the errors</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; * against a possible analytical solution or norms against some background</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; * state.</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; *   </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; * </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; * The rest of the <span class="keyword">class </span>is similar to other <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> tutorials. As</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; * discussed in the introduction, we provide a few <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> to allow a user</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; * to pass in various forms of boundary conditions on different parts of the</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; * domain boundary marked by <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a> variables, as well as</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; * possible body forces.</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; * </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; * @code</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; *   <span class="keyword">class </span>EulerOperator</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; *   {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; *   <span class="keyword">public</span>:</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; *     <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; * </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; *     EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; * </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   mapping,</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; *                 <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; * </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; *     <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; *                              std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; * </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; *     <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; *       <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>,</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; *       std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; * </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; *     <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160; * </div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; *     <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; * </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; *                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; *                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; * </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; *     <span class="keywordtype">void</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; *     perform_stage(<span class="keyword">const</span> Number cur_time,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; *                   <span class="keyword">const</span> Number factor_solution,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; *                   <span class="keyword">const</span> Number factor_ai,</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; *                   <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      solution,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; *                   <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; * </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; *                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; * </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; *     std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; * </div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; *     <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160; * </div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; *     <span class="keywordtype">void</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; *     initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;vector) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; * </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; *   <span class="keyword">private</span>:</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; *     <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> data;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; * </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; *     <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160; * </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; *     std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; *       inflow_boundaries;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; *     std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; *                                    subsonic_outflow_boundaries;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; *     std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; *     std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; * </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160; *     <span class="keywordtype">void</span> local_apply_inverse_mass_matrix(</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data,</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; * </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160; *     <span class="keywordtype">void</span> local_apply_cell(</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data,</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; * </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; *     <span class="keywordtype">void</span> local_apply_face(</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data,</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; * </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; *     <span class="keywordtype">void</span> local_apply_boundary_face(</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   data,</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; *       <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; *       <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160; *   };</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; * </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; * </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; * </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; *   EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; *     : timer(timer)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; *   {}</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; * </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; * </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; * </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; * </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; * For the initialization of the Euler <span class="keyword">operator</span>, we <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> up the <a class="code" href="classMatrixFree.html">MatrixFree</a></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; * variable contained in the <span class="keyword">class</span>. This can be done given a mapping to</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; * describe possible curved boundaries as well as a <a class="code" href="classDoFHandler.html">DoFHandler</a> <span class="keywordtype">object</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; * describing the degrees of freedom. Since we use a discontinuous Galerkin</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; * discretization in <span class="keyword">this</span> tutorial program where no constraints are imposed</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; * strongly on the solution field, we <span class="keywordflow">do</span> not need to pass in an</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160; * <a class="code" href="classAffineConstraints.html">AffineConstraints</a> <span class="keywordtype">object</span> and rather use a dummy <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; * construction. With respect to quadrature, we want to select two different</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; * ways of computing the underlying integrals: The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> is a flexible <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; * based on a <span class="keyword">template</span> parameter `n_points_1d` (that will be assigned the</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; * `n_q_points_1d` <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> specified at the top of <span class="keyword">this</span> file). More accurate</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; * integration is necessary to avoid the aliasing problem due to the</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; * variable coefficients in the Euler <span class="keyword">operator</span>. The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> less accurate</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; * quadrature formula is a tight <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> based on `fe_degree+1` and needed <span class="keywordflow">for</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; * the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. While that formula provides an exact inverse</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; * only on <a class="code" href="group__matrixfree.html#ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0">affine</a> element shapes and not on deformed elements, it enables</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; * the fast inversion of the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> by tensor product techniques,</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; * necessary to ensure optimal computational efficiency overall.</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; * </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; * @code</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; *   template &lt;int dim, int degree, int n_points_1d&gt;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; *   <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   mapping,</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; *   {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; *     <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; *     <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; constraints = {&amp;dummy};</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; *     <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(n_q_points_1d),</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; *                                                     <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(fe_degree + 1)};</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; * </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; *     <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> =</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; *       (<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; *        <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> =</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; *       (<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; *        <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> =</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; *       (<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; *        <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; *     additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> =</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; *       <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; * </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; *     data.<a class="code" href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">reinit</a>(</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; *       mapping, dof_handlers, constraints, quadratures, additional_data);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; *   }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; * </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; * </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; * </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;vector) <span class="keyword">const</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; *   {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160; *     data.initialize_dof_vector(vector);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; *   }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160; * </div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; * </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; * </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; * </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; * The subsequent four member <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> are the ones that must be called from</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; * outside to specify the various <a class="code" href="namespacetypes.html">types</a> of boundaries. For an inflow boundary,</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; * we must specify all components in terms of density @f$\rho@f$, momentum @f$\rho</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; * \mathbf{u}@f$ and energy @f$E@f$. Given <span class="keyword">this</span> information, we then store the</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; * <span class="keyword">function</span> alongside the respective boundary <span class="keywordtype">id</span> in a map member variable of</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; * <span class="keyword">this</span> <span class="keyword">class</span>. Likewise, we proceed <span class="keywordflow">for</span> the subsonic outflow boundaries (where</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; * we request a <span class="keyword">function</span> as well, which we use to retrieve the energy) and <span class="keywordflow">for</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; * wall (no-penetration) boundaries where we impose <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> normal velocity (no</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; * <span class="keyword">function</span> necessary, so we only request the boundary <span class="keywordtype">id</span>). For the present</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; * DG code where boundary conditions are solely applied as part of the weak</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; * form (during time integration), the <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> to <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the boundary conditions</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; * can appear both before or after the `<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>()` <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> to <span class="keyword">this</span> <span class="keyword">class</span>. This</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; * is different from continuous finite element codes where the boundary</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; * conditions determine the content of the <a class="code" href="classAffineConstraints.html">AffineConstraints</a> <span class="keywordtype">object</span> that is</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; * sent into <a class="code" href="classMatrixFree.html">MatrixFree</a> <span class="keywordflow">for</span> initialization, thus requiring to be <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> before</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; * the initialization of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> data structures.</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; *   </div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; * </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; * The checks added in each of the four <span class="keyword">function</span> are used to</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; * ensure that boundary conditions are mutually exclusive on the various</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; * parts of the boundary, i.e., that a user does not accidentally designate a</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; * boundary as both an inflow and say a subsonic outflow boundary.</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; * </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; * @code</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; *     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>,</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; *   {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) ==</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; *                     subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; *                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; *                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)) +</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; *                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; *                            <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == dim + 2,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; * </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; *     inflow_boundaries[<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; *   }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; * </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; * </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; *     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; *   {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) ==</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; *                     inflow_boundaries.end() &amp;&amp;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; *                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; *                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)) +</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; *                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; *                            <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == dim + 2,</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; * </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; *     subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; *   }</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; * </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; * </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; *     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; *   {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; *     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) ==</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; *                     inflow_boundaries.end() &amp;&amp;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; *                   subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) ==</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; *                     subsonic_outflow_boundaries.end(),</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; *                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; *                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)) +</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; *                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; *                            <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; * </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160; *     wall_boundaries.insert(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; *   }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; * </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; * </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; *     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; *   {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; *     <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, dim);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160; * </div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; *     this-&gt;body_force = std::move(body_force);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160; *   }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; * </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; * </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; * </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; * </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; * </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Localevaluators&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; * &lt;h4&gt;Local evaluators&lt;/h4&gt;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; * </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; * </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160; * Now we proceed to the local evaluators <span class="keywordflow">for</span> the Euler problem. The</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; * evaluators are relatively simple and follow what has been presented in</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; * @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span>, @ref step_48 <span class="stringliteral">&quot;step-48&quot;</span>, or @ref step_59 <span class="stringliteral">&quot;step-59&quot;</span>. The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> notable difference is the fact</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; * that we use an <a class="code" href="classFEEvaluation.html">FEEvaluation</a> with a non-standard number of quadrature</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; * points. Whereas we previously <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the number of quadrature points</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; * to <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a> the polynomial degree plus <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> (ensuring exact integration on</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; * <a class="code" href="group__matrixfree.html#ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0">affine</a> element shapes), we now <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the number quadrature points as a</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; * separate variable (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. the polynomial degree plus two or three halves of</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160; * the polynomial degree) to more accurately handle nonlinear terms. Since</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; * the evaluator is fed with the appropriate <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> lengths via the <span class="keyword">template</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; * argument and keeps the number of quadrature points in the whole cell in</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; * the variable <a class="code" href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a>, we now automatically operate on</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; * the more accurate formula without further changes.</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; *   </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; * </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; * The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> difference is due to the fact that we are now evaluating a</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; * multi-component system, as opposed to the scalar systems considered</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160; * previously. The <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> framework provides several ways to handle the</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160; * multi-component <span class="keywordflow">case</span>. The variant shown here utilizes an <a class="code" href="classFEEvaluation.html">FEEvaluation</a></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; * <span class="keywordtype">object</span> with multiple components embedded into it, specified by the fourth</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; * <span class="keyword">template</span> argument `dim + 2` <span class="keywordflow">for</span> the components in the Euler system. As a</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; * consequence, the <span class="keywordflow">return</span> type of <a class="code" href="classFEEvaluationBase.html#aeecc76ffeff6b36816f6af20af1398a8">FEEvaluation::get_value</a>() is not a scalar</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; * any more (that would return a <a class="code" href="classVectorizedArray.html">VectorizedArray</a> type, collecting data from</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; * several elements), but a <a class="code" href="classTensor.html">Tensor</a> of `dim+2` components. The functionality</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; * is otherwise similar to the scalar case; it is handled by a template</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; * specialization of a base class, called <a class="code" href="classFEEvaluationAccess.html">FEEvaluationAccess</a>. An alternative</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; * variant would have been to use several <a class="code" href="classFEEvaluation.html">FEEvaluation</a> objects, a scalar <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; * for the density, a vector-valued <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> with `dim` components for the</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; * momentum, and another scalar evaluator for the energy. To ensure that</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; * those components <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> to the correct part of the solution, the</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; * constructor of <a class="code" href="classFEEvaluation.html">FEEvaluation</a> takes three optional integer arguments after</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160; * the required <a class="code" href="classMatrixFree.html">MatrixFree</a> field, namely the number of the <a class="code" href="classDoFHandler.html">DoFHandler</a> for</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; * multi-<a class="code" href="classDoFHandler.html">DoFHandler</a> systems (taking the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> by default), the number of the</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; * quadrature <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> in case there are multiple <a class="code" href="classQuadrature.html">Quadrature</a> objects (see more</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; * below), and as a third argument the component within a vector system. As</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; * we have a single vector for all components, we would go with the third</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; * argument, and <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> it to `0` for the density, `1` for the vector-valued</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; * momentum, and `dim+1` for the energy slot. <a class="code" href="classFEEvaluation.html">FEEvaluation</a> then picks the</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; * appropriate subrange of the solution vector during</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; * <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::read_dof_values() and</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; * <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::distributed_local_to_global() or the more compact</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; * <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::gather_evaluate() and <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::integrate_scatter()</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; * calls.</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; *   </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; * </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; * When it comes to the evaluation of the body force vector, we distinguish</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; * between two cases for efficiency reasons: In case we have a constant</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; * function (derived from <a class="code" href="namespaceFunctions.html">Functions</a>::ConstantFunction), we can precompute</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; * the value outside the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over quadrature points and simply use the</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; * value everywhere. For a more <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> function, we instead need to <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; * the `evaluate_function()` method we provided above; this path is more</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; * expensive because we need to access the memory associated with the</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; * quadrature <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> data.</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; *   </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160; * </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160; * The rest follows the other tutorial programs. Since we have implemented</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; * all physics for the Euler equations in the separate `euler_flux()`</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; * function, all we have to do here is to <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> this function</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; * given the current solution evaluated at quadrature points, returned by</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; * `phi.get_value(q)`, and tell the <a class="code" href="classFEEvaluation.html">FEEvaluation</a> <span class="keywordtype">object</span> to queue the flux</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; * for testing it by the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">gradients</a> of the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> (which is a <a class="code" href="classTensor.html">Tensor</a></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; * of outer `dim+2` components, each holding a tensor of `dim` components</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; * for the @f$x,y,z@f$ component of the Euler flux). One final thing worth</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; * mentioning is the order in which we queue the data for testing by the</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; * value of the test function, `phi.submit_value()`, in case we are given an</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; * external function: We must do this after calling `phi.get_value(q)`,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; * because `get_value()` (reading the solution) and `submit_value()`</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; * (queuing the value for multiplication by the test function and summation</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; * over quadrature points) access the same underlying data field. Here it</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; * would be easy to achieve also without temporary variable `w_q` since</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; * there is no mixing between <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> and <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">gradients</a>. For more complicated</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; * setups, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> has to <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> out <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. both the value and gradient at a</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; * quadrature <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> and then queue results again by</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; * <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::submit_value() and <a class="code" href="classFEEvaluationBase.html">FEEvaluationBase</a>::submit_gradient().</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160; *   </div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; * </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; * As a final note, we mention that we do not use the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> <a class="code" href="classMatrixFree.html">MatrixFree</a></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; * argument of this function, which is a <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>-back from <a class="code" href="classMatrixFree.html">MatrixFree</a>::<a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>().</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; * The interfaces imposes the present list of arguments, but since we are in</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; * a member function where the <a class="code" href="classMatrixFree.html">MatrixFree</a> <span class="keywordtype">object</span> is already available as the</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; * `data` variable, we stick with that to avoid confusion.</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; * </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; * @code</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell(</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; *     const <a class="code" href="classMatrixFree.html">MatrixFree</a>&lt;dim, Number&gt; &amp;,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      dst,</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;src,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; *     const std::pair&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; &amp;     cell_range) const</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; *   {</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="classFEEvaluationBaseData.html#a5d9ba9049f2df1bc4ef95ae789faf12e">data</a>);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; * </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; *     <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160; *       <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; * </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; *     <span class="keywordflow">if</span> (constant_function)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160; *       constant_body_force = evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; *         *constant_function, <a class="code" href="classPoint.html">Point</a>&lt;dim, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt;());</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; * </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> = cell_range.first; <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> &lt; cell_range.second; ++<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160; *       {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; *         phi.reinit(<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160; *         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; * </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160; *           {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; *             phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; *             <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; *               {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; *                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force =</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; *                   constant_function ? constant_body_force :</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; *                                       evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; *                                         *body_force, phi.quadrature_point(q));</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; * </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; *                 <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; *                   forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160; *                   forcing[dim + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1];</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; * </div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; *                 phi.submit_value(forcing, q);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; *               }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160; *           }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; * </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160; *         phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ?</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; *                                  <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> :</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; *                                  <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a>) |</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; *                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>,</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; *                               dst);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; *       }</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; *   }</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; * </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; * </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; * </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; * </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; * The next <span class="keyword">function</span> concerns the computation of integrals on interior</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; * faces, where we need evaluators from both cells adjacent to the face. We</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; * associate the variable `phi_m` with the solution component @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; * and the variable `phi_p` with the solution component @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$. We</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; * distinguish the two sides in the constructor of <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> by the</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; * <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> argument, with `<span class="keyword">true</span>` <span class="keywordflow">for</span> the interior side and `<span class="keyword">false</span>` <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; * exterior side, with interior and exterior denoting the orientation with</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; * respect to the normal vector.</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; *   </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; * </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; * Note that the calls <a class="code" href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate</a>() and</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; * <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>::integrate_scatter() combine the access to the vectors</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; * and the <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a> factorization parts. This combined operation not only saves a</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; * line of code, but also contains an important optimization: Given that we</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; * use a nodal basis in terms of the Lagrange polynomials in the points of</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; * the Gauss-Lobatto quadrature formula, only @f$(p+1)^{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>-1}@f$ out of the</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; * @f$(p+1)^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$ basis <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> evaluate to non-<a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> on each face. Thus, the</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; * evaluator only accesses the necessary data in the vector and skips the</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160; * parts which are multiplied by <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>. If we had <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> read the vector, we</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; * would have needed to load all data from the vector, as the <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> in</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; * isolation would not know what data is required in subsequent</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; * operations. If the subsequent <a class="code" href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate</a>() <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> requests</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; * <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> and derivatives, indeed all @f$(p+1)^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$ vector entries <span class="keywordflow">for each</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; * component are needed, as the normal derivative is <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> <span class="keywordflow">for</span> all basis</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; * <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>.</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; *   </div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; * </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; * The arguments to the evaluators as well as the procedure is similar to</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; * the cell evaluation. We again use the more accurate (over-)integration</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; * scheme due to the nonlinear terms, specified as the third <span class="keyword">template</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; * argument in the list. At the quadrature points, we then go to our</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160; * <a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a>-standing <span class="keyword">function</span> <span class="keywordflow">for</span> the numerical flux. It receives the solution</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; * evaluated at quadrature points from both sides (i.e., @f$\mathbf{w}^-@f$ and</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160; * @f$\mathbf{w}^+@f$), as well as the normal vector onto the minus side. As</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; * explained above, the numerical flux is already multiplied by the normal</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160; * vector from the minus side. We need to <span class="keywordflow">switch</span> the <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a> because the</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; * boundary term comes with a minus <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a> in the weak form derived in the</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; * introduction. The flux is then queued <span class="keywordflow">for</span> testing both on the minus <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; * and on the plus <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a>, with switched <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a> as the normal vector from the</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; * plus side is exactly opposed to the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> from the minus side.</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; * </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160; * @code</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face(</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; *   {</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(data,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160; *                                                                       <span class="keyword">true</span>);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(data,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160; *                                                                       <span class="keyword">false</span>);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; * </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face)</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; *       {</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; *         phi_p.reinit(face);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; *         phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; * </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; *         phi_m.reinit(face);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; *         phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; * </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; *           {</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; *               euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; *                                         phi_p.get_value(q),</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; *                                         phi_m.get_normal_vector(q));</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; *             phi_m.submit_value(-numerical_flux, q);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; *             phi_p.submit_value(numerical_flux, q);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; *           }</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; * </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; *         phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; *         phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; *       }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; *   }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; * </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; * </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; * </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; * </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160; * For faces located at the boundary, we need to impose the appropriate</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; * boundary conditions. In <span class="keyword">this</span> tutorial program, we implement four cases as</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; * mentioned above. (<a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> fifth <span class="keywordflow">case</span>, <span class="keywordflow">for</span> supersonic outflow conditions is</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; * discussed in the <span class="stringliteral">&quot;Results&quot;</span> section below.) The discontinuous Galerkin</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; * method imposes boundary conditions not as constraints, but only</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; * weakly. Thus, the various conditions are imposed by finding an appropriate</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; * &lt;i&gt;exterior&lt;/i&gt; quantity @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+@f$ that is then handed to the</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; * numerical flux <span class="keyword">function</span> also used <span class="keywordflow">for</span> the interior faces. In essence,</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; * we <span class="stringliteral">&quot;pretend&quot;</span> a state on the outside of the domain in such a way that</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; * <span class="keywordflow">if</span> that were reality, the solution of the PDE would satisfy the boundary</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; * conditions we want.</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; *   </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; * </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; * For wall boundaries, we need to impose a no-normal-flux condition on the</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; * momentum variable, whereas we use a Neumann condition <span class="keywordflow">for</span> the density and</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; * energy with @f$\rho^+ = \rho^-@f$ and @f$E^+ = <a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>^-@f$. To achieve the no-normal</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; * flux condition, we <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the exterior <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> to the interior <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> and</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; * subtract two times the velocity in wall-normal direction, i.e., in the</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; * direction of the normal vector.</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; *   </div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; * </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; * For inflow boundaries, we simply <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the given Dirichlet data</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; * @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}_\mathrm{D}@f$ as a boundary <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>. An alternative would have been</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160; * to use @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+ = -\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^- + 2 \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}_\mathrm{D}@f$, the</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; * so-called mirror principle.</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; *   </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; * </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160; * The imposition of outflow is essentially a Neumann condition, i.e.,</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; * setting @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^+ = \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^-@f$. For the <span class="keywordflow">case</span> of subsonic outflow,</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; * we still need to impose a <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> <span class="keywordflow">for</span> the energy, which we derive from the</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; * respective <span class="keyword">function</span>. <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> special step is needed <span class="keywordflow">for</span> the <span class="keywordflow">case</span> of</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160; * &lt;i&gt;backflow&lt;/i&gt;, i.e., the <span class="keywordflow">case</span> where there is a momentum flux into the</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; * domain on the Neumann portion. According to the literature (a fact that can</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160; * be derived by appropriate energy arguments), we must <span class="keywordflow">switch</span> to another</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; * variant of the flux on inflow parts, see Gravemeier, Comerford,</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160; * Yoshihara, Ismail, Wall, <span class="stringliteral">&quot;A novel formulation for Neumann inflow</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="stringliteral"> * conditions in biomechanics&quot;</span>, Int. J. Numer. Meth. Biomed. Eng., vol. 28</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; * (2012). Here, the momentum term needs to be added once again, which</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; * corresponds to removing the flux contribution on the momentum</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; * variables. We <span class="keywordflow">do</span> <span class="keyword">this</span> in a post-processing step, and only <span class="keywordflow">for</span> the <span class="keywordflow">case</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160; * when we both are at an outflow boundary and the dot product between the</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; * normal vector and the momentum (or, equivalently, velocity) is</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; * negative. As we work on data of several quadrature points at once <span class="keywordflow">for</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; * SIMD vectorizations, we here need to explicitly <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over the array</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; * entries of the SIMD array.</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; *   </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; * </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; * In the implementation below, we check <span class="keywordflow">for</span> the various <a class="code" href="namespacetypes.html">types</a></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; * of boundaries at the <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> of quadrature points. Of course, we could also</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; * have moved the decision out of the quadrature <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a> <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> and treat entire</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; * faces as of the same kind, which avoids some map/<a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> lookups in the inner</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; * <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over quadrature points. However, the loss of efficiency is hardly</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; * noticeable, so we opt <span class="keywordflow">for</span> the simpler code here. Also note that the <span class="keyword">final</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; * `<span class="keywordflow">else</span>` clause will <span class="keywordflow">catch</span> the <span class="keywordflow">case</span> when some part of the boundary was not</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160; * assigned any boundary condition via `EulerOperator::set_..._boundary(...)`.</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; * </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; * @code</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face(</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160; *   {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160; *     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160; * </div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face)</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160; *       {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; *         phi.reinit(face);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; *         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; * </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160; *           {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> normal = phi.get_normal_vector(q);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; * </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; *             <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * normal[0];</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160; *               rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] * normal[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; * </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160; *             <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; * </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; *             <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a> = data.get_boundary_id(face);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; *             <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) != wall_boundaries.end())</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; *               {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; *                 w_p[0] = w_m[0];</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; *                   w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] - 2. * rho_u_dot_n * normal[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; *                 w_p[dim + 1] = w_m[dim + 1];</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; *               }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) !=</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; *                      inflow_boundaries.end())</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; *               w_p =</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; *                 evaluate_function(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)-&gt;second,</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; *                                   phi.quadrature_point(q));</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; *             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>) !=</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160; *                      subsonic_outflow_boundaries.end())</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; *               {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; *                 w_p          = w_m;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; *                 w_p[dim + 1] = evaluate_function(</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; *                   *subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">boundary_id</a>)-&gt;second,</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160; *                   phi.quadrature_point(q),</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160; *                   dim + 1);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; *                 at_outflow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; *               }</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160; *             <span class="keywordflow">else</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; *               <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; *                           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160; *                                      <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; *                                      <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; * </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; *             <span class="keyword">auto</span> flux = euler_numerical_flux&lt;dim&gt;(w_m, w_p, normal);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160; * </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160; *             <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; VectorizedArray&lt;Number&gt;::size(); ++v)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; *                 {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; *                   <span class="keywordflow">if</span> (rho_u_dot_n[v] &lt; -1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12)</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; *                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; *                       flux[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1][v] = 0.;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; *                 }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; * </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; *             phi.submit_value(-flux, q);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; *           }</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; * </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; *         phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>, dst);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; *       }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160; *   }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; * </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; * </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; * </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; * </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; * The next <span class="keyword">function</span> implements the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> operation. The</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; * algorithms and rationale have been discussed extensively in the</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; * introduction, so we here limit ourselves to the technicalities of the</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; * <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> <span class="keyword">class</span>. It does similar</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; * operations as the forward evaluation of the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, except with a</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; * different interpolation <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, representing the inverse @f$S^{-1}@f$</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; * factors. These represent a change of basis from the specified basis (in</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; * <span class="keyword">this</span> <span class="keywordflow">case</span>, the Lagrange basis in the points of the Gauss--Lobatto</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; * quadrature formula) to the Lagrange basis in the points of the Gauss</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; * quadrature formula. In the latter basis, we can <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a> the inverse of the</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; * <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a>-wise `JxW` factor, i.e., the quadrature weight times the</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; * <a class="code" href="classSymmetricTensor.html#a7c03a03a5fe823733e7af9f7e4267f81">determinant</a> of the Jacobian of the mapping from reference to real</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; * coordinates. Once <span class="keyword">this</span> is done, the basis is changed back to the nodal</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160; * Gauss-Lobatto basis again. All of these operations are done by the</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; * `<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>()` <span class="keyword">function</span> below. What we need to provide is the local fields to</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; * operate on (which we <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> from the global vector by an <a class="code" href="classFEEvaluation.html">FEEvaluation</a></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; * <span class="keywordtype">object</span>) and write the results back to the destination vector of the mass</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> operation.</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160; *   </div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; * </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; * One thing to note is that we added two integer arguments (that are</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; * optional) to the constructor of <a class="code" href="classFEEvaluation.html">FEEvaluation</a>, the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> being 0</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; * (selecting among the <a class="code" href="classDoFHandler.html">DoFHandler</a> in multi-<a class="code" href="classDoFHandler.html">DoFHandler</a> systems; here, we</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; * only have <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>) and the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> being 1 to make the quadrature formula</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; * selection. As we use the quadrature formula 0 <span class="keywordflow">for</span> the over-integration of</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; * nonlinear terms, we use the formula 1 with the <span class="keywordflow">default</span> @f$p+1@f$ (or</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; * `fe_degree+1` in terms of the variable name) points <span class="keywordflow">for</span> the mass</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. This leads to square contributions to the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and ensures</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; * exact integration, as explained in the introduction.</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; * </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; * @code</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix(</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      dst,</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; *     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; *   {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(data, 0, 1);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; *     <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160; *       inverse(phi);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; * </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = cell_range.first; cell &lt; cell_range.second; ++cell)</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; *       {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; *         phi.reinit(cell);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; *         phi.read_dof_values(src);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; * </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; *         inverse.apply(phi.begin_dof_values(), phi.begin_dof_values());</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; * </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; *         phi.set_dof_values(dst);</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; *       }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; *   }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; * </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; * </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; * </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; * </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; * </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; * &lt;a name=<span class="stringliteral">&quot;Theapplyandrelatedfunctions&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; * &lt;h4&gt;The <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>() and related <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>&lt;/h4&gt;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160; * </div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; * </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; * We now come to the function which implements the evaluation of the Euler</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160; * operator as a whole, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., @f$\mathcal M^{-1} \mathcal <a class="code" href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">L</a>(t, \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>})@f$,</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; * calling into the local evaluators presented above. The steps should be</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; * clear from the previous code. One thing to note is that we need to adjust</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; * the time in the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> we have associated with the various parts of</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; * the boundary, in order to be consistent with the equation in <span class="keywordflow">case</span> the</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; * boundary data is time-dependent. Then, we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> <a class="code" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop</a>() to</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; * perform the cell and face integrals, including the necessary ghost data</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; * exchange in the `src` vector. The seventh argument to the <span class="keyword">function</span>,</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; * `<span class="keyword">true</span>`, specifies that we want to <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> the `dst` vector as part of the</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; * <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>, before we start accumulating integrals into it. This variant is</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; * preferred over explicitly calling `dst = 0.;` before the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> as the</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; * zeroing operation is done on a subrange of the vector in parts that are</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; * written by the integrals nearby. This enhances data locality and allows</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; * <span class="keywordflow">for</span> caching, saving <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> roundtrip of vector data to main memory and</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; * enhancing performance. The last two arguments to the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> determine which</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; * data is exchanged: Since we only access the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a></div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> faces, typical of <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a>-order hyperbolic problems, and since we have</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; * a nodal basis with nodes at the reference element surface, we only need</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; * to exchange those parts. This again saves precious memory bandwidth.</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160; *   </div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; * </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; * Once the spatial <span class="keyword">operator</span> @f$\mathcal <a class="code" href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">L</a>@f$ is applied, we need to make a</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; * <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> round and <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a> the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. Here, we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; * <a class="code" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop</a>() since only cell integrals appear. The cell <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; * is cheaper than the full <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> as access only goes to the degrees of</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; * freedom associated with the locally owned cells, which is simply the</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; * locally owned degrees of freedom for DG discretizations. Thus, no ghost</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160; * exchange is needed here.</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; *   </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; * </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; * Around all these <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, we put timer scopes to record the</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160; * computational time for statistics about the contributions of the various</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160; * parts.</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; * </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; * @code</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a>(</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; *     const <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;src,</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      dst) const</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; *   {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; *     {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - integrals&quot;</span>);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; * </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : inflow_boundaries)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; *         i.second-&gt;set_time(current_time);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : subsonic_outflow_boundaries)</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; *         i.second-&gt;set_time(current_time);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; * </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; *       data.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; *                 &amp;EulerOperator::local_apply_face,</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; *                 &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160; *                 <span class="keyword">this</span>,</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; *                 dst,</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; *                 src,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160; *                 <span class="keyword">true</span>,</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; *     }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; * </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; *     {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - inverse mass&quot;</span>);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; * </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; *       data.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160; *                      <span class="keyword">this</span>,</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; *                      dst,</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; *                      dst);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; *     }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; *   }</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; * </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; * </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; * </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; * </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; * Let us move to the <span class="keyword">function</span> that does an entire stage of a Runge--Kutta</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; * update. It calls <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">EulerOperator::apply</a>() followed by some updates</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; * to the vectors, namely `next_ri = solution + factor_ai * k_i` and</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160; * `solution += factor_solution * k_i`. Rather than performing these</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160; * steps through the vector interfaces, we here present an alternative</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; * strategy that is faster on cache-based architectures. As the memory</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; * consumed by the vectors is often much larger than what fits into caches,</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; * the data has to effectively come from the slow RAM memory. The situation</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; * can be improved by <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> fusion, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., performing both the updates to</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; * `next_ki` and `solution` within a single sweep. In that case, we would</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; * read the two vectors `rhs` and `solution` and write into `next_ki` and</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; * `solution`, compared to at least 4 reads and two writes in the baseline</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; * case. Here, we go <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> step further and perform the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> immediately when</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; * the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> inversion has finished on a part of the</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160; * vector. <a class="code" href="classMatrixFree.html">MatrixFree</a>::cell_loop() provides a mechanism to attach an</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; * `std::function` both before the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over cells <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> touches a vector</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; * entry (which we do not use here, but is <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. used for zeroing the vector)</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; * and a <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> `std::function` to be called after the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> last touches</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; * an entry. The callback is in form of a range over the given vector (in</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; * terms of the local index numbering in the MPI universe) that can be</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; * addressed by `local_element()` <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>.</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; *   </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; * </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; * For this <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> callback, we create a lambda that works on a range and</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; * write the respective update on this range. Ideally, we would add the</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; * `<a class="code" href="config_8h.html#a202e950262df75b31ea0486f4dd2447f">DEAL_II_OPENMP_SIMD_PRAGMA</a>` before the local <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> to suggest to the</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; * compiler to SIMD parallelize this <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> (which means in practice that we</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; * ensure that there is no overlap, also called aliasing, between the index</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; * ranges of the pointers we use inside the loops). It turns out that at the</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; * time of this writing, GCC 7.2 fails to compile an OpenMP pragma inside a</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; * lambda function, so we comment this pragma out below. If your compiler is</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; * newer, you should be able to uncomment these lines again.</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; *   </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; * </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; * Note that we select a different code path for the last</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; * Runge--Kutta stage when we do not need to update the `next_ri`</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; * vector. This strategy gives a considerable speedup. Whereas the inverse</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; * mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and vector updates take more than 60% of the computational</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; * time with default vector updates on a 40-core machine, the percentage is</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; * around 35% with the more optimized variant. In other words, this is a</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; * speedup of around a third.</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; * </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; * @code</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; *     const Number                                      current_time,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; *     const Number                                      factor_solution,</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; *     const Number                                      factor_ai,</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;current_ri,</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      vec_ki,</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      solution,</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;      next_ri) const</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; *   {</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; *     {</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - integrals L_h&quot;</span>);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; * </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : inflow_boundaries)</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160; *         i.second-&gt;set_time(current_time);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; *       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i : subsonic_outflow_boundaries)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; *         i.second-&gt;set_time(current_time);</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; * </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160; *       data.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; *                 &amp;EulerOperator::local_apply_face,</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; *                 &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160; *                 <span class="keyword">this</span>,</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; *                 vec_ki,</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160; *                 current_ri,</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160; *                 <span class="keyword">true</span>,</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; *                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; *     }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; * </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; * </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; *     {</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - inv mass + vec upd&quot;</span>);</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160; *       data.cell_loop(</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; *         &amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; *         <span class="keyword">this</span>,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; *         next_ri,</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160; *         vec_ki,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; *         std::function&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(),</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; *         [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; *           <span class="keyword">const</span> Number ai = factor_ai;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; *           <span class="keyword">const</span> Number bi = factor_solution;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; *           <span class="keywordflow">if</span> (ai == Number())</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; *             {</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; *               <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = start_range; i &lt; end_range; ++i)</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; *                 {</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; *                   <span class="keyword">const</span> Number k_i          = next_ri.local_element(i);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160; *                   <span class="keyword">const</span> Number sol_i        = solution.local_element(i);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160; *                   solution.local_element(i) = sol_i + bi * k_i;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; *                 }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160; *             }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; *           <span class="keywordflow">else</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; *             {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; *               <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; *               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = start_range; i &lt; end_range; ++i)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; *                 {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; *                   <span class="keyword">const</span> Number k_i          = next_ri.local_element(i);</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; *                   <span class="keyword">const</span> Number sol_i        = solution.local_element(i);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160; *                   solution.local_element(i) = sol_i + bi * k_i;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; *                   next_ri.local_element(i)  = sol_i + ai * k_i;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; *                 }</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; *             }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; *         });</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; *     }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160; *   }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160; * </div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; * </div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; * </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; * </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; * Having discussed the implementation of the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that deal with</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; * advancing the solution by <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> time step, let us now move to <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; * that implement other, ancillary operations. Specifically, these are</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; * <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that compute projections, evaluate errors, and compute the speed</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160; * of information transport on a cell.</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; *   </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160; </div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; * </div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; * The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> of these <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> is essentially equivalent to</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160; * <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>(), just much faster because it is specialized <span class="keywordflow">for</span> DG</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; * elements where there is no need to <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> up and solve a linear system, as</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; * each element has independent basis <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>. The reason why we show the</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; * code here, besides a small speedup of <span class="keyword">this</span> non-critical operation, is that</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; * it shows additional functionality provided by</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160; * <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>.</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; *   </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160; </div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160; * </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160; * The projection operation works as follows: If we denote the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> of</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; * shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> evaluated at quadrature points by @f$S@f$, the projection on</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160; * cell @f$K@f$ is an operation of the form @f$\underbrace{S J^K S^\mathrm</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}_{\mathcal M^K} \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = S J^K</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160; * \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$, where @f$J^K@f$ is the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">diagonal</a></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; * <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> containing the <a class="code" href="classSymmetricTensor.html#a7c03a03a5fe823733e7af9f7e4267f81">determinant</a> of the Jacobian times the quadrature</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160; * weight (JxW), @f$\mathcal M^K@f$ is the cell-wise mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, and</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; * @f$\tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$ is the evaluation of the</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160; * field to be projected onto quadrature points. (In reality the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> @f$S@f$</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; * has additional structure through the tensor product, as explained in the</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; * introduction.) This system can now equivalently be written as</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160; * @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = \left(S J^K S^\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>\right)^{-1} S J^K</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; * \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q} = S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; * \left(J^K\right)^{-1} S^{-1} S J^K</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160; * \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$. Now, the term @f$S^{-1} S@f$ and</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; * then @f$\left(J^K\right)^{-1} J^K@f$ cancel, resulting in the <span class="keyword">final</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; * expression @f$\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}^K = S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; * \tilde{\mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}}(\mathbf{x}_q)_{q=1:n_q}@f$. This operation is</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; * implemented by</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160; * <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis</a>().</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; * The name is derived from the fact that <span class="keyword">this</span> projection is simply</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; * the multiplication by @f$S^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}@f$, a basis change from the</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160; * nodal basis in the points of the Gaussian quadrature to the given finite</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; * element basis. Note that we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> <a class="code" href="classFEEvaluationBase.html#a459813036810fbdc3c5487309b118fd8">FEEvaluation::set_dof_values</a>() to write</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160; * the result into the vector, overwriting previous content, rather than</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160; * accumulating the results as typical in integration tasks -- we can do</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; * this because every vector entry has contributions from only a single</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; * cell for discontinuous Galerkin discretizations.</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; * </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160; * @code</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; *   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::<a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160; *     const <a class="code" href="classFunction.html">Function</a>&lt;dim&gt; &amp;                       function,</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160; *     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;solution) const</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; *   {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="classFEEvaluationBaseData.html#a5d9ba9049f2df1bc4ef95ae789faf12e">data</a>, 0, 1);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160; *     <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160; *       inverse(phi);</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160; *     solution.zero_out_ghost_values();</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> = 0; <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> &lt; <a class="code" href="classFEEvaluationBaseData.html#a5d9ba9049f2df1bc4ef95ae789faf12e">data</a>.n_cell_batches(); ++<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>)</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; *       {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; *         phi.reinit(<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160; *           phi.submit_dof_value(evaluate_function(<span class="keyword">function</span>,</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; *                                                  phi.quadrature_point(q)),</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; *                                q);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; *         inverse.transform_from_q_points_to_basis(dim + 2,</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160; *                                                  phi.begin_dof_values(),</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; *                                                  phi.begin_dof_values());</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; *         phi.set_dof_values(solution);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; *       }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; *   }</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160; * </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160; * </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; * </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160; * </div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; * The next <span class="keyword">function</span> again repeats functionality also provided by the</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160; * deal.II library, namely <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(). We here show</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; * the <span class="keyword">explicit</span> code to highlight how the vectorization across several cells</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160; * works and how to accumulate results via that interface: Recall that each</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; * &lt;i&gt;lane&lt;/i&gt; of the vectorized array holds data from a different cell. By</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160; * the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cell batches that are owned by the current MPI process,</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; * we could then fill a <a class="code" href="classVectorizedArray.html">VectorizedArray</a> of results; to obtain a global <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a>,</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160; * we would need to further go on and <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a> across the entries in the SIMD</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; * array. However, such a procedure is not stable as the SIMD array could in</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160; * fact not hold <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">valid</a> data <span class="keywordflow">for</span> all its lanes. This happens when the number</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; * of locally owned cells is not a multiple of the SIMD width. To avoid</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160; * <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">invalid</a> data, we must explicitly skip those <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">invalid</a> lanes when accessing</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160; * the data. While <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> could imagine that we could make it work by simply</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; * setting the empty lanes to <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> (and thus, not contribute to a <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a>), the</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160; * situation is more complicated than that: What <span class="keywordflow">if</span> we were to compute a</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160; * velocity out of the momentum? Then, we would need to divide by the</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160; * density, which is <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> -- the result would consequently be NaN and</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; * contaminate the result. This trap is avoided by accumulating the results</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160; * from the <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">valid</a> SIMD range as we <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> through the cell batches, <span class="keyword">using</span> the</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; * <span class="keyword">function</span> <a class="code" href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch</a>() to give us the</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; * number of lanes with <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">valid</a> data. It equals <a class="code" href="classVectorizedArray.html">VectorizedArray</a>::size() on</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160; * most cells, but can be less on the last cell batch if the number of cells</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160; * has a remainder compared to the SIMD width.</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160; * </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; * @code</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; *   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_points_1d&gt;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; *   std::array&lt;<span class="keywordtype">double</span>, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160; *     const <a class="code" href="classFunction.html">Function</a>&lt;dim&gt; &amp;                             function,</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; *     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;Number&gt; &amp;solution) const</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; *   {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; *     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; *     <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(data, 0, 0);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160; * </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = 0; cell &lt; data.n_cell_batches(); ++cell)</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160; *       {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; *         phi.reinit(cell);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; *         phi.gather_evaluate(solution, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; *         <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {};</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; *           {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> error =</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; *               evaluate_function(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160; *               phi.get_value(q);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> JxW = phi.JxW(q);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; * </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; *             local_errors_squared[0] += error[0] * error[0] * JxW;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; *               local_errors_squared[1] += (error[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1] * error[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> + 1]) * JxW;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; *             local_errors_squared[2] += (error[dim + 1] * error[dim + 1]) * JxW;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; *           }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; data.n_active_entries_per_cell_batch(cell);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; *              ++v)</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; *             errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>][v];</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160; *       }</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; * </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160; *     <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160; * </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; *     std::array&lt;double, 3&gt; errors;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; *       errors[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = std::sqrt(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]);</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; * </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160; *     <span class="keywordflow">return</span> errors;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; *   }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; * </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160; * </div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160; * </div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160; * </div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; * This <span class="keyword">final</span> <span class="keyword">function</span> of the EulerOperator <span class="keyword">class </span>is used to estimate the</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; * transport speed, scaled by the mesh size, that is relevant <span class="keywordflow">for</span> setting</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160; * the time step size in the <span class="keyword">explicit</span> time integrator. In the Euler</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160; * equations, there are two speeds of transport, namely the convective</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160; * velocity @f$\mathbf{u}@f$ and the propagation of sound waves with sound</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; * speed @f$c = <a class="code" href="classVectorizedArray.html#a935e528bb3b525ac056167a64d7ab71d">\sqrt</a>{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p/\rho}@f$ relative to the medium moving at</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; * velocity @f$\mathbf u@f$.</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160; *   </div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160; </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; * </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; * In the formula <span class="keywordflow">for</span> the time step size, we are interested not by</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160; * these absolute speeds, but by the amount of time it takes <span class="keywordflow">for</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; * information to cross a single cell. For information transported along with</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160; * the medium, @f$\mathbf u@f$ is scaled by the mesh size,</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; * so an estimate of the maximal velocity can be obtained by computing</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; * @f$\|J^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>} \mathbf{u}\|_\infty@f$, where @f$J@f$ is the Jacobian of the</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; * transformation from real to the reference domain. Note that</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; * <a class="code" href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBase::inverse_jacobian</a>() returns the inverse and <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; * Jacobian, representing the metric term from real to reference</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; * coordinates, so we do not need to <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a> it again. We store this limit</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; * in the variable `convective_limit` in the code below.</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; *   </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160; * </div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; * The sound propagation is isotropic, so we need to take mesh sizes in any</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160; * direction into account. The appropriate mesh size scaling is then given</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; * by the minimal singular value of @f$J@f$ or, equivalently, the maximal</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; * singular value of @f$J^{-1}@f$. Note that <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> could <a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a> <span class="keyword">this</span> quantity</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; * by the minimal distance between <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a> of a cell when ignoring curved</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; * cells. To get the maximal singular <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of the Jacobian, the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; * strategy would be some LAPACK <span class="keyword">function</span>. Since all we need here is an</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160; * estimate, we can avoid the hassle of decomposing a tensor of</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160; * <a class="code" href="classVectorizedArray.html">VectorizedArray</a> <a class="code" href="namespacenumbers.html">numbers</a> into several matrices and go into an (expensive)</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160; * eigenvalue <span class="keyword">function</span> without vectorization, and instead use a few</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; * iterations (five in the code below) of the power method applied to</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160; * @f$J^{-1}J^{-\mathrm <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}@f$. The speed of convergence of <span class="keyword">this</span> method depends</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; * on the ratio of the largest to the next largest eigenvalue and the</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160; * <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> guess, which is the vector of all ones. This might suggest that</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; * we get slow convergence on cells close to a cube shape where all</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; * lengths are almost the same. However, <span class="keyword">this</span> slow convergence means that</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; * the result will sit between the two largest singular <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>, which both</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160; * are close to the maximal <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> anyway. In all other cases, convergence</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160; * will be quick. Thus, we can merely hardcode 5 iterations here and be</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160; * confident that the result is good.</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; * </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160; * @code</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160; *   <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160; *     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;solution) <span class="keyword">const</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160; *   {</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160; *     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; *     Number             max_transport = 0;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160; *     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(data, 0, 1);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160; * </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cell = 0; cell &lt; data.n_cell_batches(); ++cell)</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160; *       {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; *         phi.reinit(cell);</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160; *         phi.gather_evaluate(solution, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a>);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160; *         <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160; *           {</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> solution = phi.get_value(q);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> velocity = euler_velocity&lt;dim&gt;(solution);</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> pressure = euler_pressure&lt;dim&gt;(solution);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160; * </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian * velocity;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160; *             <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160; *               convective_limit =</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160; *                 <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]));</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160; * </div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; *               <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure * (1. / solution[0]));</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; * </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; *             <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; eigenvector;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; *               eigenvector[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = 1.;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 5; ++i)</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160; *               {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; *                 eigenvector = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian) *</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160; *                               (inverse_jacobian * eigenvector);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; *                 <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; *                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; *                   eigenvector_norm =</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; *                     <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(eigenvector_norm, std::abs(eigenvector[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>]));</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; *                 eigenvector /= eigenvector_norm;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160; *               }</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * eigenvector;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160; *             <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160; *               (jac_times_ev * jac_times_ev) / (eigenvector * eigenvector));</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; *             local_max =</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; *               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(local_max,</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; *                        max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160; *           }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160; * </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160; * </div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; * Similarly to the previous <span class="keyword">function</span>, we must make sure to accumulate</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160; * speed only on the <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">valid</a> cells of a cell batch.</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160; * </div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160; * @code</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; data.n_active_entries_per_cell_batch(cell);</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; *              ++v)</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160; *             max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::max</a>(max_transport, local_max[v]);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160; *       }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; * </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160; *     max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160; * </div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; *     <span class="keywordflow">return</span> max_transport;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160; *   }</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160; * </div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; * </div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160; * </div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; * </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; * </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160; * &lt;a name=<span class="stringliteral">&quot;TheEulerProblemclass&quot;</span>&gt;&lt;/a&gt; </div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160; * &lt;h3&gt;The EulerProblem <span class="keyword">class</span>&lt;/h3&gt;</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160; * </div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160; * </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160; * This <span class="keyword">class </span>combines the EulerOperator class with the time integrator and</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160; * the usual global data structures such as <a class="code" href="classFiniteElement.html">FiniteElement</a> and <a class="code" href="classDoFHandler.html">DoFHandler</a>, to</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160; * actually <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the simulations of the Euler problem.</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160; *   </div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160; </div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; * </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160; * The member variables are a <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, a finite element, a mapping (to</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160; * create high-order curved surfaces, see <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. @ref step_10 <span class="stringliteral">&quot;step-10&quot;</span>), and a <a class="code" href="classDoFHandler.html">DoFHandler</a> to</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160; * describe the degrees of freedom. In addition, we keep an instance of the</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160; * EulerOperator described above around, which will <span class="keywordflow">do</span> all heavy lifting in</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160; * terms of integrals, and some parameters <span class="keywordflow">for</span> time integration like the</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160; * current time or the time step size.</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; *   </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160; </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160; * </div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160; * Furthermore, we use a PostProcessor instance to write some additional</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; * information to the output file, in similarity to what was done in</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160; * @ref step_33 <span class="stringliteral">&quot;step-33&quot;</span>. The <span class="keyword">interface </span>of the <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a> class is intuitive,</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160; * requiring us to provide information about what needs to be evaluated</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; * (typically only the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the solution, except <span class="keywordflow">for</span> the Schlieren plot</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; * that we only enable in 2D where it makes sense), and the names of what</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160; * gets evaluated. Note that it would also be possible to <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> most</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160; * information by calculator tools within visualization programs such as</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160; * ParaView, but it is so much more convenient to <span class="keywordflow">do</span> it already when writing</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; * the output.</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160; * </div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160; * @code</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; *   template &lt;int dim&gt;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; *   <span class="keyword">class</span> EulerProblem</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; *   {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160; *   <span class="keyword">public</span>:</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; *     EulerProblem();</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; * </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160; *     <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>();</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160; * </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; *   <span class="keyword">private</span>:</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160; *     <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160; * </div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160; *     <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; * </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> solution;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160; * </div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; *     <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160; * </div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; * #ifdef DEAL_II_WITH_P4EST</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160; *     <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160; * #<span class="keywordflow">else</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; *     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; * #endif</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; * </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; *     <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        fe;</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160; *     <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> mapping;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160; *     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; * </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160; *     <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; * </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; *     EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160; * </div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160; *     <span class="keywordtype">double</span> time, time_step;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160; * </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160; *     <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; *     {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; *     <span class="keyword">public</span>:</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160; *       Postprocessor();</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160; * </div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160; *       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classDataPostprocessor.html#a1ba57b598d24d64365d469a854271c68">evaluate_vector_field</a>(</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160; *         <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160; *         std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; * </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; *       <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="classDataPostprocessor.html#a254f38bcdf4bdb5aa94231b695da7d55">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; * </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160; *       <span class="keyword">virtual</span> std::vector&lt;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160; *       <a class="code" href="classDataPostprocessor.html#ae994223acf8a16471ab5e579a4d75053">get_data_component_interpretation</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; * </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; *       <span class="keyword">virtual</span> <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="classDataPostprocessor.html#aadecdd040447b395164397ea1196f721">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160; * </div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160; *     <span class="keyword">private</span>:</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160; *     };</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; *   };</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; * </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; * </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; * </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; *   EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor()</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160; *     : do_schlieren_plot(dim == 2)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; *   {}</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160; * </div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; * </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; * </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; * </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160; * For the main evaluation of the field variables, we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> check that the</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160; * lengths of the arrays <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a> the expected <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> (the lengths `2*dim+4` or</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; * `2*dim+5` are derived from the sizes of the names we specify in the</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; * get_names() <span class="keyword">function</span> below). Then we <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all evaluation points and</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160; * fill the respective information: First we fill the primal solution</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; * variables of density @f$\rho@f$, momentum @f$\rho \mathbf{u}@f$ and energy @f$E@f$,</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; * then we compute the derived velocity @f$\mathbf u@f$, the pressure @f$p@f$, the</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; * speed of sound @f$c=<a class="code" href="classVectorizedArray.html#a935e528bb3b525ac056167a64d7ab71d">\sqrt</a>{<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">\gamma</a> p / \rho}@f$, as well as the Schlieren plot</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160; * showing @f$s = |\nabla \rho|^2@f$ in <span class="keywordflow">case</span> it is enabled. (See @ref step_69 <span class="stringliteral">&quot;step-69&quot;</span> <span class="keywordflow">for</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160; * another example where we create a Schlieren plot.)</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; * </div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160; * @code</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field(</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160; *     <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160; *     std::vector&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities) <span class="keyword">const</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; *   {</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160; *     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.solution_values.size();</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; * </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160; *       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.solution_gradients.size() == n_evaluation_points,</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; *              <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160; * </div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160; *            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.solution_values[0].size() == dim + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160; *     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].size() ==</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160; *              dim + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; *            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160; * </div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160; *       {</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; *         <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> solution;</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; *           solution[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = inputs.solution_values[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160; * </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; *         <span class="keyword">const</span> <span class="keywordtype">double</span>         density  = solution[0];</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160; *         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> velocity = euler_velocity&lt;dim&gt;(solution);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; *         <span class="keyword">const</span> <span class="keywordtype">double</span>         pressure = euler_pressure&lt;dim&gt;(solution);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160; * </div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; *           computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) = velocity[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; *         computed_quantities[q](dim)     = pressure;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160; *         computed_quantities[q](dim + 1) = std::sqrt(<a class="code" href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">gamma</a> * pressure / density);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160; * </div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160; *         <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160; *           computed_quantities[q](dim + 2) =</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; *             inputs.solution_gradients[q][0] * inputs.solution_gradients[q][0];</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160; *       }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160; *   }</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; * </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160; * </div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160; * </div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; *   std::vector&lt;std::string&gt; EulerProblem&lt;dim&gt;::Postprocessor::get_names() const</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; *   {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; *     std::vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160; *       names.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; *     names.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; *     names.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160; * </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; *       names.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160; * </div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; *     <span class="keywordflow">return</span> names;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; *   }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; * </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160; * </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; * </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; * </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160; * For the interpretation of quantities, we have scalar density, energy,</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160; * pressure, speed of sound, and the Schlieren plot, and vectors <span class="keywordflow">for</span> the</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; * momentum and the velocity.</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160; * </div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; * @code</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; *   std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; *   EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation() const</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160; *   {</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; *     std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; *       interpretation;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160; *     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; *       interpretation.push_back(</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160; *     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160; *     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; * </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; *       interpretation.push_back(</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160; *         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160; * </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160; *     <span class="keywordflow">return</span> interpretation;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; *   }</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160; * </div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; * </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160; * </div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160; * </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160; * With respect to the necessary update flags, we only need the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; * all quantities but the Schlieren plot, which is based on the density</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160; * <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>.</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160; * </div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160; * @code</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; *   <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags() const</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160; *   {</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160; *     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160; *       <span class="keywordflow">return</span> <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160; *     <span class="keywordflow">else</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; *       <span class="keywordflow">return</span> <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; *   }</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160; * </div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160; * </div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160; * </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160; * </div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; * The constructor <span class="keywordflow">for</span> <span class="keyword">this</span> <span class="keyword">class </span>is unsurprising: We <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> up a <a class="code" href="namespaceparallel.html">parallel</a></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160; * <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> based on the `MPI_COMM_WORLD` communicator, a vector finite</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160; * element with `dim+2` components for density, momentum, and energy, a</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160; * high-order mapping of the same degree as the underlying finite element,</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; * and initialize the time and time step to <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>.</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; * </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; * @code</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160; *   template &lt;int dim&gt;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; *   EulerProblem&lt;dim&gt;::EulerProblem()</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160; *     : pcout(std::cout, Utilities::MPI::this_mpi_process(MPI_COMM_WORLD) == 0)</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; * #ifdef DEAL_II_WITH_P4EST</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160; *     , <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; * #endif</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160; *     , fe(FE_DGQ&lt;dim&gt;(fe_degree), dim + 2)</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160; *     , mapping(fe_degree)</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160; *     , dof_handler(triangulation)</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160; *     , timer(pcout, TimerOutput::never, TimerOutput::wall_times)</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160; *     , euler_operator(timer)</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; *     , time(0)</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; *     , time_step(0)</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; *   {}</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160; * </div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160; * </div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; * </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160; * </div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; * As a mesh, <span class="keyword">this</span> tutorial program implements two options, depending on the</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; * global variable `testcase`: For the analytical variant (`testcase==0`),</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160; * the domain is @f$(0, 10) \times (-5, 5)@f$, with Dirichlet boundary</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160; * conditions (inflow) all around the domain. For `testcase==1`, we <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160; * domain to a <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> in a rectangular box, derived from the flow past</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160; * <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> testcase <span class="keywordflow">for</span> incompressible viscous flow by Sch&amp;auml;fer and</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; * Turek (1996). Here, we have a larger variety of boundaries. The inflow</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; * part at the left of the channel is given the inflow type, <span class="keywordflow">for</span> which we</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160; * choose a constant inflow profile, whereas we <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> a subsonic outflow at</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160; * the right. For the boundary around the <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> (boundary <span class="keywordtype">id</span> equal to 2)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160; * as well as the channel walls (boundary <span class="keywordtype">id</span> equal to 3) we use the wall</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160; * boundary type, which is no-normal flow. Furthermore, <span class="keywordflow">for</span> the 3D <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160; * we also add a gravity force in vertical direction. Having the base mesh</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160; * in place (including the manifolds <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> by</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160; * <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>()), we can then perform the</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; * specified number of global refinements, create the unknown numbering from</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160; * the <a class="code" href="classDoFHandler.html">DoFHandler</a>, and hand the <a class="code" href="classDoFHandler.html">DoFHandler</a> and <a class="code" href="classMapping.html">Mapping</a> objects to the</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160; * initialization of the EulerOperator.</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; * </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; * @code</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160; *   {</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; *     <span class="keywordflow">switch</span> (testcase)</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160; *       {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160; *         <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; *           {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160; *               lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = -5;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160; * </div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; *             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160; *             upper_right[0] = 10;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160; *             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160; *               upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] = 5;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; * </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; *             <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; *                                            lower_left,</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160; *                                            upper_right);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; *             <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(2);</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; * </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; *             euler_operator.set_inflow_boundary(</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160; *               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160; * </div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; *             <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; *           }</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160; * </div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; *         <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160; *           {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; *             <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160; *               <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; * </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; *             euler_operator.set_inflow_boundary(</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160; *               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160; *             euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; *               1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; * </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; *             euler_operator.set_wall_boundary(2);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; *             euler_operator.set_wall_boundary(3);</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160; * </div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; *             <span class="keywordflow">if</span> (dim == 3)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160; *               euler_operator.set_body_force(</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160; *                 std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160; *                   std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; * </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160; *             <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; *           }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160; * </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160; *         <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160; *           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160; *       }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; * </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; *     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(n_global_refinements);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; * </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160; *     dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(fe);</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; * </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160; *     euler_operator.reinit(mapping, dof_handler);</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160; *     euler_operator.initialize_vector(solution);</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; * </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; * </div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; * In the following, we output some statistics about the problem. Because we</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; * often <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> up with quite large <a class="code" href="namespacenumbers.html">numbers</a> of cells or degrees of freedom, we</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160; * would like to print them with a comma to separate each <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> of three</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160; * digits. This can be done via <span class="stringliteral">&quot;locales&quot;</span>, although the way <span class="keyword">this</span> works is</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160; * not particularly intuitive. @ref step_32 <span class="stringliteral">&quot;step-32&quot;</span> explains <span class="keyword">this</span> in slightly more</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; * detail.</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160; * </div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160; * @code</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160; *     std::locale s = pcout.get_stream().getloc();</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160; *     pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (dim + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; *           &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160; *           &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(fe_degree + 1, dim) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160; *           &lt;&lt; std::endl;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; *     pcout.get_stream().imbue(s);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; *   }</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160; * </div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; * </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160; * </div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; * </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; * For output, we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> let the Euler <span class="keyword">operator</span> compute the errors of the</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; * numerical results. More precisely, we compute the error against the</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; * analytical result <span class="keywordflow">for</span> the analytical solution <span class="keywordflow">case</span>, whereas we compute</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; * the deviation against the background field with constant density and</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; * energy and constant velocity in @f$x@f$ direction <span class="keywordflow">for</span> the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> test <span class="keywordflow">case</span>.</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160; *   </div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; * </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160; * The next step is to create output. This is similar to what is done in</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160; * @ref step_33 <span class="stringliteral">&quot;step-33&quot;</span>: We let the postprocessor defined above control most of the</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160; * output, except <span class="keywordflow">for</span> the primal field that we write directly. For the</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160; * analytical solution test <span class="keywordflow">case</span>, we also perform another projection of the</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; * analytical solution and print the difference between that field and the</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; * numerical solution. Once we have defined all quantities to be written, we</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; * build the patches <span class="keywordflow">for</span> output. Similarly to @ref step_65 <span class="stringliteral">&quot;step-65&quot;</span>, we create a</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160; * high-order VTK output by setting the appropriate flag, which enables us</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160; * to visualize fields of high polynomial degrees. Finally, we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> the</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; * `<a class="code" href="group__Exceptions.html#ga5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a>()` <span class="keyword">function</span> to write the result</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160; * to the given file name. This <span class="keyword">function</span> uses special MPI <a class="code" href="namespaceparallel.html">parallel</a> write</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; * facilities, which are typically more optimized <span class="keywordflow">for</span> <a class="code" href="namespaceparallel.html">parallel</a> file systems</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160; * than the standard library<span class="stringliteral">&#39;s `std::ofstream` variants used in most other</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="stringliteral"> * tutorial programs. A particularly nice feature of the</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="stringliteral"> * `write_vtu_in_parallel()` function is the fact that it can combine output</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="stringliteral"> * from all MPI ranks into a single file, making it unnecessary to have a</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="stringliteral"> * central record of all such files (namely, the &quot;pvtu&quot; file).</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="stringliteral"> *   </span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="stringliteral"> * </span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="stringliteral"> * For parallel programs, it is often instructive to look at the partitioning</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;<span class="stringliteral"> * of cells among processors. To this end, one can pass a vector of numbers</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;<span class="stringliteral"> * to DataOut::add_data_vector() that contains as many entries as the</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="stringliteral"> * current processor has active cells; these numbers should then be the</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;<span class="stringliteral"> * rank of the processor that owns each of these cells. Such a vector</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="stringliteral"> * could, for example, be obtained from</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="stringliteral"> * GridTools::get_subdomain_association(). On the other hand, on each MPI</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="stringliteral"> * process, DataOut will only read those entries that correspond to locally</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="stringliteral"> * owned cells, and these of course all have the same value: namely, the rank</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="stringliteral"> * of the current process. What is in the remaining entries of the vector</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="stringliteral"> * doesn&#39;</span>t actually matter, and so we can just get away with a cheap trick: We</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160; * just fill *all* <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the vector we give to <a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">DataOut::add_data_vector</a>()</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; * with the rank of the current MPI process. The key is that on each process,</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160; * only the entries corresponding to the locally owned cells will be read,</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160; * ignoring the (wrong) <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> in other entries. The fact that every process</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; * submits a vector in which the correct subset of entries is correct is all</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160; * that is necessary.</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160; * </div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; * @code</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160; *   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160; *   {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160; *     <span class="keyword">const</span> std::array&lt;double, 3&gt; errors =</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160; *       euler_operator.compute_errors(ExactSolution&lt;dim&gt;(time), solution);</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160; *     <span class="keyword">const</span> std::string quantity_name = testcase == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; * </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; time</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; *           &lt;&lt; std::setw(10) &lt;&lt; errors[2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; * </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160; *     {</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160; *       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160; * </div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; *       Postprocessor postprocessor;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; *       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160; * </div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160; *       <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> flags;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160; *       flags.<a class="code" href="group__Exceptions.html#gaa9dd1830c0ff35a2431704c4d45453eb">write_higher_order_cells</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160; *       data_out.<a class="code" href="group__Exceptions.html#gac7280a24690b117454acfb0fa058299c">set_flags</a>(flags);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160; * </div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a>(dof_handler);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; *       {</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; *         std::vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160; *         names.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160; *         names.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160; * </div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160; *         std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160; *           interpretation;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; *         interpretation.push_back(</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160; *           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160; *         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160; *           interpretation.push_back(</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; *         interpretation.push_back(</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160; *           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; * </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160; *         data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(dof_handler, solution, names, interpretation);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160; *       }</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(solution, postprocessor);</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160; * </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160; *       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> reference;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; *       <span class="keywordflow">if</span> (testcase == 0 &amp;&amp; dim == 2)</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160; *         {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160; *           reference.<a class="code" href="group__Vectors.html#gace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution);</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160; *           euler_operator.project(ExactSolution&lt;dim&gt;(time), reference);</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160; *           reference.<a class="code" href="group__Vectors.html#gaa6376a098589519491fc452d1529f57b">sadd</a>(-1., 1, solution);</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160; *           std::vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160; *             names.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160; *           names.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160; * </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160; *           std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; *             interpretation;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160; *           interpretation.push_back(</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160; *           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160; *             interpretation.push_back(</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160; *               <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; *           interpretation.push_back(</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160; *             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160; * </div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160; *           data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(dof_handler,</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; *                                    reference,</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160; *                                    names,</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160; *                                    interpretation);</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160; *         }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160; * </div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160; *       <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160; *       mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160; *       data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160; * </div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; *       data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a>(mapping,</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160; *                              fe.degree,</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; *                              <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160; * </div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; *       <span class="keyword">const</span> std::string filename =</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160; *         <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; *       data_out.<a class="code" href="group__Exceptions.html#ga5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; *     }</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160; *   }</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; * </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160; * </div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160; * </div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160; * </div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160; * The <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">EulerProblem::run</a>() function puts all pieces together. It starts off</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160; * by calling the function that creates the mesh and sets up data structures,</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160; * and then initializing the time integrator and the two temporary vectors of</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160; * the low-storage integrator. We <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> these vectors `rk_register_1` and</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160; * `rk_register_2`, and use the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> vector to represent the quantity</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160; * @f$\mathbf{r}_i@f$ and the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">for</span> @f$\mathbf{k}_i@f$ in the formulas <span class="keywordflow">for</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160; * the Runge--Kutta scheme outlined in the introduction. Before we start the</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160; * time <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>, we compute the time step size by the</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; * `EulerOperator::compute_cell_transport_speed()` <span class="keyword">function</span>. For reasons of</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160; * comparison, we compare the result obtained there with the minimal mesh</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160; * size and print them to screen. For velocities and speeds of sound close</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160; * to unity as in <span class="keyword">this</span> tutorial program, the predicted effective mesh size</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160; * will be close, but they could vary <span class="keywordflow">if</span> scaling were different.</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; * </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160; * @code</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160; *   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; *   <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; *   {</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160; *     {</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>();</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; *       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(Number) * n_vect_number;</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160; * </div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160; *       pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; *             &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160; *             &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160; *       pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160; *             &lt;&lt; (std::is_same&lt;Number, double&gt;::value ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160; *             &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160; *             &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160; *             &lt;&lt; std::endl;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160; *     }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160; * </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160; *     make_grid_and_dofs();</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160; * </div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160; *     <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(lsrk_scheme);</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160; * </div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160; *     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160; *     rk_register_1.<a class="code" href="group__Vectors.html#gace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; *     rk_register_2.<a class="code" href="group__Vectors.html#gace027311492ed2f6e07fbd74d723e3a9">reinit</a>(solution);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160; * </div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160; *     euler_operator.project(ExactSolution&lt;dim&gt;(time), solution);</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160; * </div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160; *     <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160; *     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; *       <span class="keywordflow">if</span> (cell-&gt;is_locally_owned())</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160; *         min_vertex_distance =</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160; *           <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">std::min</a>(min_vertex_distance, cell-&gt;minimum_vertex_distance());</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160; *     min_vertex_distance =</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160; *       <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160; * </div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160; *     time_step = courant_number * integrator.n_stages() /</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160; *                 euler_operator.compute_cell_transport_speed(solution);</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160; *     pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160; *           &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; *           &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(solution)</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; *           &lt;&lt; std::endl</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160; *           &lt;&lt; std::endl;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160; * </div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160; *     output_results(0);</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160; * </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160; * </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160; * Now we are ready to start the time <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>, which we <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> until the time</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; * has reached the desired <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> time. Every 5 time steps, we compute a <span class="keyword">new</span></div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160; * estimate <span class="keywordflow">for</span> the time step -- since the solution is nonlinear, it is</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; * most effective to adapt the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> during the course of the</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; * simulation. In <span class="keywordflow">case</span> the Courant number was chosen too aggressively, the</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160; * simulation will typically blow up with time step NaN, so that is easy</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160; * to detect here. One thing to note is that roundoff errors might</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; * propagate to the leading digits due to an interaction of slightly</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160; * different time step selections that in turn lead to slightly different</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; * solutions. To decrease <span class="keyword">this</span> sensitivity, it is common practice to round</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160; * or truncate the time step size to a few digits, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. 3 in <span class="keyword">this</span> <span class="keywordflow">case</span>. In</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160; * <span class="keywordflow">case</span> the current time is near the prescribed <span class="stringliteral">&#39;tick&#39;</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> <span class="keywordflow">for</span> output</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160; * (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. 0.02), we also write the output. After the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of the time <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>,</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160; * we summarize the computation by printing some statistics, which is</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; * mostly done by the <a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics</a>() <span class="keyword">function</span>.</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; * </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160; * @code</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; *     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160; * </div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; *     <span class="keywordflow">while</span> (time &lt; final_time - 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12)</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160; *       {</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160; *         ++timestep_number;</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160; *         <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160; *           time_step =</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160; *             courant_number * integrator.n_stages() /</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160; *             <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160; *               euler_operator.compute_cell_transport_speed(solution), 3);</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160; * </div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160; *         {</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; *           <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160; *           integrator.perform_time_step(euler_operator,</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; *                                        time,</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160; *                                        time_step,</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; *                                        solution,</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160; *                                        rk_register_1,</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160; *                                        rk_register_2);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160; *         }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160; * </div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; *         time += time_step;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160; * </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160; *         <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(time / output_tick) !=</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160; *               <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((time - time_step) / output_tick) ||</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160; *             time &gt;= final_time - 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12)</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160; *           output_results(</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; *             <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(std::round(time / output_tick)));</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160; *       }</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160; * </div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; *     timer.print_wall_time_statistics(MPI_COMM_WORLD);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160; *     pcout &lt;&lt; std::endl;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160; *   }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160; * </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160; * } <span class="comment">// namespace Euler_DG</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160; * </div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160; * </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160; * </div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160; * </div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160; * The main() function is not surprising and follows what was done in all</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160; * previous MPI programs: As we <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> an MPI program, we need to <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> `MPI_Init()`</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; * and `MPI_Finalize()`, which we do through the</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; * <a class="code" href="namespaceUtilities.html">Utilities</a>::MPI::MPI_InitFinalize data structure. Note that we <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the program</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160; * only with MPI, and <a class="code" href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">set</a> the thread count to 1.</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; * </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; * @code</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160; * <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160; * {</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160; *   <span class="keyword">using namespace </span>Euler_DG;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; *   <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160; * </div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; *   <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160; * </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160; *   <span class="keywordflow">try</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160; *     {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160; *       <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160; * </div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; *       EulerProblem&lt;dimension&gt; euler_problem;</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160; *       euler_problem.run();</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160; *     }</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; *   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160; *     {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160; *       std::cerr &lt;&lt; std::endl</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160; *                 &lt;&lt; std::endl</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160; *                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; *       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160; *                 &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160; *                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160; * </div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160; *       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160; *     }</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; *   <span class="keywordflow">catch</span> (...)</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160; *     {</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160; *       std::cerr &lt;&lt; std::endl</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160; *                 &lt;&lt; std::endl</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160; *                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160; *       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160; *                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160; *                 &lt;&lt; std::endl;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160; *       <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160; *     }</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160; * </div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160; *   <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160; * }</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160; * <span class="keyword">@end</span>code</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;&lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160; </div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;&lt;a name=<span class="stringliteral">&quot;Programoutput&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Program output&lt;/h3&gt;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160; </div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160; </div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;Running the program with the <span class="keywordflow">default</span> settings on a machine with 40 processes</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;produces the following output:</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;@code</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;Running with 40 MPI processes</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;Number of degrees of freedom: 147,456 ( = 4 [vars] x 1,024 [cells] x 36 [dofs/cell/var] )</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;Time step size: 0.00689325, minimal h: 0.3125, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.102759</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160; </div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;Time:       0, dt:   0.0069, error rho:   2.76e-07, rho * u:  1.259e-06, energy: 2.987e-06</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;Time:    1.01, dt:   0.0069, error rho:   1.37e-06, rho * u:  2.252e-06, energy: 4.153e-06</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;Time:    2.01, dt:   0.0069, error rho:  1.561e-06, rho * u:   2.43e-06, energy: 4.493e-06</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;Time:    3.01, dt:   0.0069, error rho:  1.714e-06, rho * u:  2.591e-06, energy: 4.762e-06</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;Time:    4.01, dt:   0.0069, error rho:  1.843e-06, rho * u:  2.625e-06, energy: 4.985e-06</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;Time:    5.01, dt:   0.0069, error rho:  1.496e-06, rho * u:  1.961e-06, energy: 4.142e-06</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;Time:       6, dt:   0.0083, error rho:  1.007e-06, rho * u:  7.119e-07, energy: 2.972e-06</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;Time:       7, dt:   0.0095, error rho:  9.096e-07, rho * u:  3.786e-07, energy: 2.626e-06</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;Time:       8, dt:   0.0096, error rho:  8.439e-07, rho * u:  3.338e-07, energy:  2.43e-06</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;Time:       9, dt:   0.0096, error rho:  7.822e-07, rho * u:  2.984e-07, energy: 2.248e-06</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;Time:      10, dt:   0.0096, error rho:  7.231e-07, rho * u:  2.666e-07, energy: 2.074e-06</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160; </div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;| Total wallclock time elapsed              |     2.249s    30 |     2.249s |     2.249s     8 |</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;|                                           |                  |                               |</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;| compute errors                |        11 |  0.008066s    13 |   0.00952s |   0.01041s    20 |</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;| compute transport speed       |       258 |   0.01012s    13 |   0.05392s |   0.08574s    25 |</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;| output                        |        11 |    0.9597s    13 |    0.9613s |    0.9623s     6 |</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;| rk time stepping total        |      1283 |    0.9827s    25 |     1.015s |      1.06s    13 |</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;| rk_stage - integrals L_h      |      6415 |    0.8803s    26 |    0.9198s |    0.9619s    14 |</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;| rk_stage - inv mass + vec upd |      6415 |   0.05677s    15 |   0.06487s |   0.07597s    13 |</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;@endcode</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160; </div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;The program output shows that all errors are small. This is due to the fact</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;that we use a relatively fine mesh of @f$32^2@f$ cells with polynomials of degree</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;5 <span class="keywordflow">for</span> a solution that is smooth. An interesting pattern shows <span class="keywordflow">for</span> the time</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;step size: whereas it is 0.0069 up to time 5, it increases to 0.0096 <span class="keywordflow">for</span> later</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;times. The step size increases once the vortex with some motion on top of the</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;speed of sound (and thus faster propagation) leaves the computational domain</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;between times 5 and 6.5. After that <a class="code" href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">point</a>, the flow is simply uniform</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;in the same direction, and the maximum velocity of the gas is reduced</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;compared to the previous state where the uniform velocity was overlaid</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;by the vortex. Our time step formula recognizes <span class="keyword">this</span> effect.</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160; </div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;The <span class="keyword">final</span> block of output shows detailed information about the timing</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;of individual parts of the programs; it breaks <span class="keyword">this</span> down by showing</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;the time taken by the fastest and the slowest processor, and the</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;average time -- <span class="keyword">this</span> is often useful in very large computations to</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;find whether there are processors that are consistently overheated</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;(and consequently are throttling their clock speed) or consistently</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;slow <span class="keywordflow">for</span> other reasons.</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;The summary shows that 1283 time steps have been performed</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;in 1.02 seconds (looking at the average time among all MPI processes), <span class="keywordflow">while</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;the output of 11 files has taken additional 0.96 seconds. Broken down per time</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;step and into the five Runge--Kutta stages, the compute time per evaluation is</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;0.16 milliseconds. This high performance is typical of <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> evaluators</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;and a reason why <span class="keyword">explicit</span> time integration is very competitive against</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;implicit solvers, especially <span class="keywordflow">for</span> large-<a class="code" href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">scale</a> simulations. The breakdown of</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;computational times at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of the program <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> shows that the evaluation of</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;integrals in @f$\mathcal L_h@f$ contributes with around 0.92 seconds and the</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;application of the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> with 0.06 seconds. Furthermore, the</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;estimation of the transport speed <span class="keywordflow">for</span> the time step size computation</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;contributes with another 0.05 seconds of compute time.</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160; </div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;If we use three more levels of global refinement and 9.4 million DoFs in total,</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;the <span class="keyword">final</span> statistics are as follows (<span class="keywordflow">for</span> the modified Lax--Friedrichs flux,</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;@f$p=5@f$, and the same system of 40 cores of dual-socket Intel Xeon Gold 6230):</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;@code</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;| Total wallclock time elapsed              |     244.9s    12 |     244.9s |     244.9s    34 |</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;|                                           |                  |                               |</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;| Section                       | no. calls |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">max</a> time  rank |</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;| compute errors                |        11 |    0.4239s    12 |    0.4318s |    0.4408s     9 |</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;| compute transport speed       |      2053 |     3.962s    12 |     6.727s |     10.12s     7 |</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;| output                        |        11 |     30.35s    12 |     30.36s |     30.37s     9 |</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;| rk time stepping total        |     10258 |     201.7s     7 |     205.1s |     207.8s    12 |</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;| rk_stage - integrals L_h      |     51290 |     121.3s     6 |     126.6s |     136.3s    16 |</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;| rk_stage - inv mass + vec upd |     51290 |     66.19s    16 |     77.52s |     81.84s    10 |</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;@endcode</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; </div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;Per time step, the solver now takes 0.02 seconds, about 25 times as long as</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;for the small problem with 147k unknowns. Given that the problem involves 64</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;times as many unknowns, the increase in computing time is not</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;surprising. Since we also do 8 times as many time steps, the compute time</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;should in theory increase by a factor of 512. The actual increase is 205 s /</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;1.02 s = 202. This is because the small problem size cannot fully utilize the</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;40 cores due to communication overhead. This becomes clear if we look into the</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;details of the operations done per time step. The evaluation of the</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;differential operator @f$\mathcal L_h@f$ with nearest neighbor communication goes</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;from 0.92 seconds to 127 seconds, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., it increases with a factor of 138. On</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;the other hand, the cost for application of the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and the</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;vector updates, which do not need to communicate between the MPI processes at</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;all, has increased by a factor of 1195. The increase is more than the</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;theoretical factor of 512 because the operation is limited by the bandwidth</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;from RAM memory for the larger size while for the smaller size, all vectors</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;fit into the caches of the CPU. The <a class="code" href="namespacenumbers.html">numbers</a> show that the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;evaluation and vector update part consume almost 40% of the time spent by the</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;Runge--Kutta stages -- despite using a low-storage Runge--Kutta integrator and</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;merging of vector operations! And despite using over-integration for the</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;@f$\mathcal L_h@f$ operator. For simpler differential operators and more expensive</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;time integrators, the proportion spent in the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and vector update</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;part can also reach 70%. If we compute a throughput number in terms of DoFs</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;processed per <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> and Runge--Kutta stage, we obtain @f[ \text{throughput} =</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;\frac{n_\mathrm{time steps} n_\mathrm{stages}</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{10258 \cdot 5 \cdot</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;9.4\,\text{MDoFs}}{205s} = 2360\, \text{MDoFs/s} @f] This throughput number is</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;very high, given that simply copying <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> vector to another <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> runs at</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;only around 10,000 MDoFs/s.</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160; </div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;If we go to the next-larger size with 37.7 million DoFs, the overall</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;simulation time is 2196 seconds, with 1978 seconds spent in the time</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;stepping. The increase in <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> time is a factor of 9.3 <span class="keywordflow">for</span> the L_h <span class="keyword">operator</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;(1179 versus 127 seconds) and a factor of 10.3 <span class="keywordflow">for</span> the inverse mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;vector updates (797 vs 77.5 seconds). The reason <span class="keywordflow">for</span> <span class="keyword">this</span> non-optimal increase</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;in <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> time can be traced back to cache effects on the given hardware (with 40</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;MB of <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a> cache and 55 MB of L3 cache): While not all of the relevant data fits</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;into caches for 9.4 million DoFs (<a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> vector takes 75 MB and we have three</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;vectors plus some additional data in <a class="code" href="classMatrixFree.html">MatrixFree</a>), there is capacity for <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> and</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;a half vector nonetheless. Given that modern caches are more sophisticated than</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;the naive least-recently-used strategy (where we would have little re-use as</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;the data is used in a streaming-like fashion), we can assume that a sizeable</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;fraction of data can indeed be delivered from caches for the 9.4 million DoFs</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;case. For the larger case, even with optimal caching less than 10 percent of</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;data would fit into caches, with an associated loss in performance.</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160; </div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;&lt;a name=<span class="stringliteral">&quot;Convergenceratesfortheanalyticaltestcase&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Convergence rates for the analytical test case&lt;/h3&gt;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160; </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160; </div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;For the modified Lax--Friedrichs flux and measuring the error in the momentum</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;variable, we obtain the following convergence table (the rates are very</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;similar for the density and energy variables):</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160; </div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;&lt;table align=<span class="stringliteral">&quot;center&quot;</span> class=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    &lt;th&gt;&amp;nbsp;&lt;/th&gt;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=2&lt;/th&gt;</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=3&lt;/th&gt;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=5&lt;/th&gt;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    &lt;th&gt;<a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">n_cells</a>&lt;/th&gt;</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16&lt;/td&gt;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,304&lt;/td&gt;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.373e-01&lt;/td&gt;</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;64&lt;/td&gt;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,096&lt;/td&gt;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.130e-02&lt;/td&gt;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.899e-03&lt;/td&gt;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;256&lt;/td&gt;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.577e-02&lt;/td&gt;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.381e-03&lt;/td&gt;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    &lt;td&gt;3.64&lt;/td&gt;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.082e-04&lt;/td&gt;</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;    &lt;td&gt;5.42&lt;/td&gt;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1024&lt;/td&gt;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.724e-03&lt;/td&gt;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;    &lt;td&gt;3.56&lt;/td&gt;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.072e-04&lt;/td&gt;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;    &lt;td&gt;4.59&lt;/td&gt;</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.625e-06&lt;/td&gt;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;    &lt;td&gt;6.31&lt;/td&gt;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4096&lt;/td&gt;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;6.205e-04&lt;/td&gt;</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    &lt;td&gt;2.92&lt;/td&gt;</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.880e-05&lt;/td&gt;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    &lt;td&gt;4.03&lt;/td&gt;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.268e-08&lt;/td&gt;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    &lt;td&gt;6.33&lt;/td&gt;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.279e-05&lt;/td&gt;</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;    &lt;td&gt;2.91&lt;/td&gt;</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1,048,576&lt;/td&gt;</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.224e-06&lt;/td&gt;</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.252e-10&lt;/td&gt;</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    &lt;td&gt;5.14&lt;/td&gt;</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.105e-05&lt;/td&gt;</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    &lt;td&gt;2.91&lt;/td&gt;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,194,304&lt;/td&gt;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.871e-08&lt;/td&gt;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    &lt;td&gt;3.96&lt;/td&gt;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.369e-10&lt;/td&gt;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    &lt;td&gt;2.77&lt;/td&gt;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.615e-06&lt;/td&gt;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;    &lt;td&gt;2.77&lt;/td&gt;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,777,216&lt;/td&gt;</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.961e-09&lt;/td&gt;</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;    &lt;td&gt;3.99&lt;/td&gt;</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;37,748,736&lt;/td&gt;</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.091e-11&lt;/td&gt;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    &lt;td&gt;0.95&lt;/td&gt;</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;&lt;/table&gt;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160; </div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;If we <span class="keywordflow">switch</span> to the Harten-Lax-van Leer flux, the results are as follows:</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;&lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    &lt;th&gt;&amp;nbsp;&lt;/th&gt;</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=2&lt;/th&gt;</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=3&lt;/th&gt;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    &lt;th colspan=<span class="stringliteral">&quot;3&quot;</span>&gt;&lt;i&gt;p&lt;/i&gt;=5&lt;/th&gt;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    &lt;th&gt;<a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">n_cells</a>&lt;/th&gt;</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;    &lt;th&gt;n_dofs&lt;/th&gt;</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    &lt;th&gt;error mom&lt;/th&gt;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    &lt;th&gt;rate&lt;/th&gt;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16&lt;/td&gt;</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,304&lt;/td&gt;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.339e-01&lt;/td&gt;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;64&lt;/td&gt;</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,096&lt;/td&gt;</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.037e-02&lt;/td&gt;</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;8.849e-03&lt;/td&gt;</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    &lt;td&gt;3.92&lt;/td&gt;</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;256&lt;/td&gt;</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,216&lt;/td&gt;</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.204e-02&lt;/td&gt;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    &lt;td&gt;&amp;nbsp;&lt;/td&gt;</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.143e-03&lt;/td&gt;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;    &lt;td&gt;3.31&lt;/td&gt;</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.501e-04&lt;/td&gt;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    &lt;td&gt;5.14&lt;/td&gt;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1024&lt;/td&gt;</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;36,864&lt;/td&gt;</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.913e-03&lt;/td&gt;</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    &lt;td&gt;3.09&lt;/td&gt;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.257e-04&lt;/td&gt;</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    &lt;td&gt;4.81&lt;/td&gt;</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.260e-06&lt;/td&gt;</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    &lt;td&gt;6.26&lt;/td&gt;</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4096&lt;/td&gt;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;147,456&lt;/td&gt;</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;7.862e-04&lt;/td&gt;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    &lt;td&gt;2.64&lt;/td&gt;</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.588e-05&lt;/td&gt;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    &lt;td&gt;4.36&lt;/td&gt;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.953e-08&lt;/td&gt;</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    &lt;td&gt;6.79&lt;/td&gt;</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,384&lt;/td&gt;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;589,824&lt;/td&gt;</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.137e-04&lt;/td&gt;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;    &lt;td&gt;2.79&lt;/td&gt;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;1,048,576&lt;/td&gt;</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;9.400e-07&lt;/td&gt;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    &lt;td&gt;4.08&lt;/td&gt;</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;4.286e-10&lt;/td&gt;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    &lt;td&gt;6.11&lt;/td&gt;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;65,536&lt;/td&gt;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;2,359,296&lt;/td&gt;</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;1.476e-05&lt;/td&gt;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    &lt;td&gt;2.95&lt;/td&gt;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;4,194,304&lt;/td&gt;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.799e-08&lt;/td&gt;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    &lt;td&gt;4.02&lt;/td&gt;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.789e-11&lt;/td&gt;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;    &lt;td&gt;3.94&lt;/td&gt;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;262,144&lt;/td&gt;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;9,437,184&lt;/td&gt;</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;2.038e-06&lt;/td&gt;</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    &lt;td&gt;2.86&lt;/td&gt;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;16,777,216&lt;/td&gt;</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;3.609e-09&lt;/td&gt;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;    &lt;td&gt;4.01&lt;/td&gt;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    &lt;td align=<span class="stringliteral">&quot;right&quot;</span>&gt;37,748,736&lt;/td&gt;</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;5.730e-11&lt;/td&gt;</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;    &lt;td&gt;-1.04&lt;/td&gt;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;&lt;/table&gt;</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160; </div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;The tables show that we get optimal @f$\mathcal O\left(h^{p+1}\right)@f$</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;convergence rates <span class="keywordflow">for</span> both numerical fluxes. The errors are slightly smaller</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;<span class="keywordflow">for</span> the Lax--Friedrichs flux <span class="keywordflow">for</span> @f$p=2@f$, but the picture is reversed <span class="keywordflow">for</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;@f$p=3@f$; in any <span class="keywordflow">case</span>, the differences on <span class="keyword">this</span> testcase are relatively</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;small.</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160; </div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;For @f$p=5@f$, we reach the roundoff accuracy of @f$10^{-11}@f$ with both</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;fluxes on the finest grids. Also note that the errors are absolute with a</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;domain length of @f$10^2@f$, so relative errors are below @f$10^{-12}@f$. The HLL flux</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;is somewhat better <span class="keywordflow">for</span> the highest degree, which is due to a slight inaccuracy</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;of the Lax--Friedrichs flux: The Lax--Friedrichs flux sets a Dirichlet</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;condition on the solution that leaves the domain, which results in a small</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;artificial reflection, which is accentuated <span class="keywordflow">for</span> the Lax--Friedrichs</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;flux. Apart from that, we see that the influence of the numerical flux is</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;minor, as the polynomial part inside elements is the main driver of the</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;accucary. The limited influence of the flux also has consequences when trying</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;to approach more challenging setups with the higher-order DG setup: Taking <span class="keywordflow">for</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;example the parameters and grid of @ref step_33 <span class="stringliteral">&quot;step-33&quot;</span>, we get oscillations (which in turn</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;make density negative and make the solution explode) with both fluxes once the</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;high-mass part comes near the boundary, as opposed to the low-order finite</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<a class="code" href="namespaceGridTools.html#a9e8169dc4981e90ba5d2386a87efa042">volume</a> <span class="keywordflow">case</span> (@f$p=0@f$). Thus, any <span class="keywordflow">case</span> that leads to shocks in the solution</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;necessitates some form of limiting or artificial dissipation. For another</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;alternative, see the @ref step_69 <span class="stringliteral">&quot;step-69&quot;</span> tutorial program.</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160; </div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160; </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;&lt;a name=<span class="stringliteral">&quot;Resultsforflowinchannelaroundcylinderin2D&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Results <span class="keywordflow">for</span> flow in channel around <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> in 2D&lt;/h3&gt;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160; </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;For the test <span class="keywordflow">case</span> of the flow around a <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> in a channel, we need to</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;change the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> code line to</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;@code</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> testcase = 1;</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="keyword">@end</span>code</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;This test <span class="keywordflow">case</span> starts with a background field of a constant velocity</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;of Mach number 0.31 and a constant <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> density; the flow will have</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;to go around an obstacle in the form of a <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a>. Since we impose a</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;no-penetration condition on the <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> walls, the flow that</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;initially impinges head-on onto to <a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> has to rearrange,</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;which creates a big sound wave. The following pictures show the pressure at</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;times 0.1, 0.25, 0.5, and 1.0 (top left to bottom right) <span class="keywordflow">for</span> the 2D <span class="keywordflow">case</span> with</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;5 levels of global refinement, <span class="keyword">using</span> 102,400 cells with polynomial degree of</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;5 and 14.7 million degrees of freedom over all 4 solution variables.</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;We clearly see the discontinuity that</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;propagates slowly in the upstream direction and more quickly in <a class="code" href="namespaceDoFRenumbering.html#a59c1a183ef6288e6bb061eb738b84380">downstream</a></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;direction in the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> snapshot at time 0.1. At time 0.25, the sound wave has</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;reached the top and bottom walls and reflected back to the interior. From the</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;different distances of the reflected waves from lower and upper walls we can</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;see the slight asymmetry of the Sch&amp;auml;fer-Turek test <span class="keywordflow">case</span> represented by</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>() with somewhat more space above the</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<a class="code" href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">cylinder</a> compared to below. At later times, the picture is more chaotic with</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;many sound waves all over the place.</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160; </div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;&lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span> style=<span class="stringliteral">&quot;width:85%&quot;</span>&gt;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    &lt;td&gt;</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.pressure_010.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;100%&quot;</span>&gt;</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;    &lt;/td&gt;</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    &lt;td&gt;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;        &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.pressure_025.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;100%&quot;</span>&gt;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    &lt;/td&gt;</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  &lt;tr&gt;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    &lt;td&gt;</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;        &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.pressure_050.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;100%&quot;</span>&gt;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;    &lt;/td&gt;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;    &lt;td&gt;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.pressure_100.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;100%&quot;</span>&gt;</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;    &lt;/td&gt;</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  &lt;/tr&gt;</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;&lt;/table&gt;</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160; </div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;The next picture shows an elevation plot of the pressure at time 1.0 looking</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;from the channel inlet towards the outlet at the same resolution -- here,</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;we can see the large number</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;of reflections. In the figure, two <a class="code" href="namespacetypes.html">types</a> of waves are visible. The</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;larger-amplitude waves correspond to various reflections that happened as the</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;<a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> discontinuity hit the walls, whereas the small-amplitude waves of</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;size similar to the elements correspond to numerical artifacts. They have their</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;origin in the finite resolution of the scheme and appear as the discontinuity</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;travels through elements with high-order polynomials. This effect can be cured</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;by increasing resolution. Apart from <span class="keyword">this</span> effect, the rich wave structure is</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;the result of the transport accuracy of the high-order DG method.</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160; </div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.pressure_elevated.jpg&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;40%&quot;</span>&gt;</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160; </div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;With 2 levels of global refinement with 1,600 cells, the mesh and its</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;partitioning on 40 MPI processes looks as follows:</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160; </div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-67.grid-owner.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span> width=<span class="stringliteral">&quot;70%&quot;</span>&gt;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160; </div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;When we <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the code with 4 levels of global refinements on 40 cores, we get</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;the following output:</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;@code</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;Running with 40 MPI processes</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;Number of degrees of freedom: 3,686,400 ( = 4 [vars] x 25,600 [cells] x 36 [dofs/cell/var] )</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;Time step size: 7.39876e-05, minimal h: 0.001875, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00110294</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160; </div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;Time:       0, dt:  7.4e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:   4.17e-16, rho * u:  1.629e-16, energy: 1.381e-15</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;Time:    0.05, dt:  6.3e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02075, rho * u:    0.03801, energy:   0.08772</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;Time:     0.1, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02211, rho * u:    0.04515, energy:   0.08953</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;Time:    0.15, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02261, rho * u:    0.04592, energy:   0.08967</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;Time:     0.2, dt:  5.8e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.02058, rho * u:    0.04361, energy:   0.08222</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;Time:    0.25, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01695, rho * u:    0.04203, energy:   0.06873</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;Time:     0.3, dt:  5.9e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01653, rho * u:     0.0401, energy:   0.06604</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;Time:    0.35, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01774, rho * u:    0.04264, energy:    0.0706</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160; </div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;...</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160; </div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;Time:    1.95, dt:  5.8e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01488, rho * u:    0.03923, energy:   0.05185</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;Time:       2, dt:  5.7e-05, <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> rho:    0.01432, rho * u:    0.03969, energy:   0.04889</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160; </div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;| Total wallclock time elapsed              |     273.6s    13 |     273.6s |     273.6s     0 |</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;|                                           |                  |                               |</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;| Section                       | no. calls |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> time  rank |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">avg</a> time |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> time  rank |</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;| compute errors                |        41 |   0.01112s    35 |    0.0672s |    0.1337s     0 |</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;| compute transport speed       |      6914 |     5.422s    35 |     15.96s |     29.99s     1 |</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;| output                        |        41 |     37.24s    35 |      37.3s |     37.37s     0 |</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;| rk time stepping total        |     34564 |     205.4s     1 |     219.5s |     230.1s    35 |</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;| rk_stage - integrals L_h      |    172820 |     153.6s     1 |     164.9s |     175.6s    27 |</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;| rk_stage - inv mass + vec upd |    172820 |     47.13s    13 |     53.09s |     64.05s    33 |</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;@endcode</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160; </div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;The norms shown here <span class="keywordflow">for</span> the various quantities are the deviations</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;@f$\rho<span class="stringliteral">&#39;@f$, @f$(\rho u)&#39;</span>@f$, and @f$E<span class="stringliteral">&#39;@f$ against the background field (namely, the</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="stringliteral">initial condition). The distribution of run time is overall similar as in the</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="stringliteral">previous test case. The only slight difference is the larger proportion of</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="stringliteral">time spent in @f$\mathcal L_h@f$ as compared to the inverse mass matrix and vector</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="stringliteral">updates. This is because the geometry is deformed and the matrix-free</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="stringliteral">framework needs to load additional arrays for the geometry from memory that</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="stringliteral">are compressed in the affine mesh case.</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="stringliteral">Increasing the number of global refinements to 5, the output becomes:</span></div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="stringliteral">@code</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;<span class="stringliteral">Running with 40 MPI processes</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;<span class="stringliteral">Vectorization over 8 doubles = 512 bits (AVX512)</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;<span class="stringliteral">Number of degrees of freedom: 14,745,600 ( = 4 [vars] x 102,400 [cells] x 36 [dofs/cell/var] )</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;<span class="stringliteral">...</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="stringliteral">| Total wallclock time elapsed              |      2693s    32 |      2693s |      2693s    23 |</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="stringliteral">|                                           |                  |                               |</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;<span class="stringliteral">| Section                       | no. calls |   min time  rank |   avg time |   max time  rank |</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;<span class="stringliteral">| compute errors                |        41 |   0.04537s    32 |     0.173s |    0.3489s     0 |</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;<span class="stringliteral">| compute transport speed       |     13858 |     40.75s    32 |     85.99s |     149.8s     0 |</span></div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="stringliteral">| output                        |        41 |     153.8s    32 |     153.9s |     154.1s     0 |</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;<span class="stringliteral">| rk time stepping total        |     69284 |      2386s     0 |      2450s |      2496s    32 |</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="stringliteral">| rk_stage - integrals L_h      |    346420 |      1365s    32 |      1574s |      1718s    19 |</span></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="stringliteral">| rk_stage - inv mass + vec upd |    346420 |     722.5s    10 |     870.7s |      1125s    32 |</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;<span class="stringliteral">@endcode</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;<span class="stringliteral">The effect on performance is similar to the analytical test case -- in</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;<span class="stringliteral">theory, computation times should increase by a factor of 8, but we actually</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;<span class="stringliteral">see an increase by a factor of 11 for the time steps (219.5 seconds versus</span></div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;<span class="stringliteral">2450 seconds). This can be traced back to caches, with the small case mostly</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="stringliteral">fitting in caches. An interesting effect, typical of programs with a mix of</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="stringliteral">local communication (integrals @f$\mathcal L_h@f$) and global communication (computation of</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="stringliteral">transport speed) with some load imbalance, can be observed by looking at the</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="stringliteral">MPI ranks that encounter the minimal and maximal time of different phases,</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="stringliteral">respectively. Rank 0 reports the fastest throughput for the &quot;rk time stepping</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;<span class="stringliteral">total&quot; part. At the same time, it appears to be slowest for the &quot;compute</span></div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;<span class="stringliteral">transport speed&quot; part, almost a factor of 2 slower than the</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<span class="stringliteral">average and almost a factor of 4 compared to the faster rank.</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="stringliteral">Since the latter involves global communication, we can attribute the</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="stringliteral">slowness in this part to the fact that the local Runge--Kutta stages have</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="stringliteral">advanced more quickly on this rank and need to wait until the other processors</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="stringliteral">catch up. At this point, one can wonder about the reason for this imbalance:</span></div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="stringliteral">The number of cells is almost the same on all MPI processes.</span></div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="stringliteral">However, the matrix-free framework is faster on affine and Cartesian</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="stringliteral">cells located towards the outlet of the channel, to which the lower MPI ranks</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="stringliteral">are assigned. On the other hand, rank 32, which reports the highest run time</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;<span class="stringliteral">for the Runga--Kutta stages, owns the curved cells near the cylinder, for</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="stringliteral">which no data compression is possible. To improve throughput, we could assign</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="stringliteral">different weights to different cell types when partitioning the</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="stringliteral">parallel::distributed::Triangulation object, or even measure the run time for a</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;<span class="stringliteral">few time steps and try to rebalance then.</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;<span class="stringliteral">The throughput per Runge--Kutta stage can be computed to 2085 MDoFs/s for the</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="stringliteral">14.7 million DoFs test case over the 346,000 Runge--Kutta stages, slightly slower</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;<span class="stringliteral">than the Cartesian mesh throughput of 2360 MDoFs/s reported above.</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="stringliteral">Finally, if we add one additional refinement, we record the following output:</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="stringliteral">@code</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="stringliteral">Running with 40 MPI processes</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;<span class="stringliteral">Vectorization over 8 doubles = 512 bits (AVX512)</span></div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="stringliteral">Number of degrees of freedom: 58,982,400 ( = 4 [vars] x 409,600 [cells] x 36 [dofs/cell/var] )</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="stringliteral">...</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="stringliteral">Time:    1.95, dt:  1.4e-05, norm rho:    0.01488, rho * u:    0.03923, energy:   0.05183</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="stringliteral">Time:       2, dt:  1.4e-05, norm rho:    0.01431, rho * u:    0.03969, energy:   0.04887</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="stringliteral">| Total wallclock time elapsed              | 2.166e+04s    26 | 2.166e+04s | 2.166e+04s    24 |</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="stringliteral">|                                           |                  |                               |</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="stringliteral">| Section                       | no. calls |   min time  rank |   avg time |   max time  rank |</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="stringliteral">| compute errors                |        41 |    0.1758s    30 |     0.672s |     1.376s     1 |</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="stringliteral">| compute transport speed       |     27748 |     321.3s    34 |     678.8s |      1202s     1 |</span></div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="stringliteral">| output                        |        41 |     616.3s    32 |     616.4s |     616.4s    34 |</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="stringliteral">| rk time stepping total        |    138733 | 1.983e+04s     1 | 2.036e+04s | 2.072e+04s    34 |</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="stringliteral">| rk_stage - integrals L_h      |    693665 | 1.052e+04s    32 | 1.248e+04s | 1.387e+04s    19 |</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="stringliteral">| rk_stage - inv mass + vec upd |    693665 |      6404s    10 |      7868s | 1.018e+04s    32 |</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="stringliteral">@endcode</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="stringliteral">The &quot;rk time stepping total&quot; part corresponds to a throughput of 2010 MDoFs/s. The</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="stringliteral">overall run time to perform 139k time steps is 20k seconds (5.7 hours) or 7</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="stringliteral">time steps per second -- not so bad for having nearly 60 million</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="stringliteral">unknowns. More throughput can be achieved by adding more cores to</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="stringliteral">the computation.</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="stringliteral">&lt;a name=&quot;Resultsforflowinchannelaroundcylinderin3D&quot;&gt;&lt;/a&gt;&lt;h3&gt;Results for flow in channel around cylinder in 3D&lt;/h3&gt;</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="stringliteral">Switching the channel test case to 3D with 3 global refinements, the output is</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="stringliteral">@code</span></div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="stringliteral">Running with 40 MPI processes</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="stringliteral">Vectorization over 8 doubles = 512 bits (AVX512)</span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="stringliteral">Number of degrees of freedom: 221,184,000 ( = 5 [vars] x 204,800 [cells] x 216 [dofs/cell/var] )</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="stringliteral">...</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="stringliteral">Time:    1.95, dt:  0.00011, norm rho:    0.01131, rho * u:    0.03056, energy:   0.04091</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="stringliteral">Time:       2, dt:  0.00011, norm rho:     0.0119, rho * u:    0.03142, energy:   0.04425</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="stringliteral">| Total wallclock time elapsed              | 1.734e+04s     4 | 1.734e+04s | 1.734e+04s    38 |</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="stringliteral">|                                           |                  |                               |</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="stringliteral">| Section                       | no. calls |   min time  rank |   avg time |   max time  rank |</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;<span class="stringliteral">| compute errors                |        41 |    0.6551s    34 |     3.216s |     7.281s     0 |</span></div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;<span class="stringliteral">| compute transport speed       |      3546 |       160s    34 |     393.2s |     776.9s     0 |</span></div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="stringliteral">| output                        |        41 |      1350s    34 |      1353s |      1357s     0 |</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="stringliteral">| rk time stepping total        |     17723 | 1.519e+04s     0 | 1.558e+04s | 1.582e+04s    34 |</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="stringliteral">| rk_stage - integrals L_h      |     88615 | 1.005e+04s    32 | 1.126e+04s |  1.23e+04s    11 |</span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="stringliteral">| rk_stage - inv mass + vec upd |     88615 |      3056s    11 |      4322s |      5759s    32 |</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;<span class="stringliteral">@endcode</span></div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="stringliteral">The physics are similar to the 2D case, with a slight motion in the z</span></div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;<span class="stringliteral">direction due to the gravitational force. The throughput per Runge--Kutta</span></div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;<span class="stringliteral">stage in this case is</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;<span class="stringliteral">@f[</span></div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;<span class="stringliteral">\text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages}</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;<span class="stringliteral">n_\mathrm{dofs}}{t_\mathrm{compute}} =</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;<span class="stringliteral">\frac{17723 \cdot 5 \cdot 221.2\,\text{M}}{15580s} = 1258\, \text{MDoFs/s}.</span></div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;<span class="stringliteral">@f]</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;<span class="stringliteral">The throughput is lower than in 2D because the computation of the @f$\mathcal L_h@f$ term</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="stringliteral">is more expensive. This is due to over-integration with `degree+2` points and</span></div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="stringliteral">the larger fraction of face integrals (worse volume-to-surface ratio) with</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="stringliteral">more expensive flux computations. If we only consider the inverse mass matrix</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="stringliteral">and vector update part, we record a throughput of 4857 MDoFs/s for the 2D case</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="stringliteral">of the isentropic vortex with 37.7 million unknowns, whereas the 3D case</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="stringliteral">runs with 4535 MDoFs/s. The performance is similar because both cases are in</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;<span class="stringliteral">fact limited by the memory bandwidth.</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="stringliteral">If we go to four levels of global refinement, we need to increase the number</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="stringliteral">of processes to fit everything in memory -- the computation needs around 350</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="stringliteral">GB of RAM memory in this case. Also, the time it takes to complete 35k time</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="stringliteral">steps becomes more tolerable by adding additional resources. We therefore use</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="stringliteral">6 nodes with 40 cores each, resulting in a computation with 240 MPI processes:</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="stringliteral">@code</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="stringliteral">Running with 240 MPI processes</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="stringliteral">Vectorization over 8 doubles = 512 bits (AVX512)</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;<span class="stringliteral">Number of degrees of freedom: 1,769,472,000 ( = 5 [vars] x 1,638,400 [cells] x 216 [dofs/cell/var] )</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;<span class="stringliteral">...</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="stringliteral">Time:    1.95, dt:  5.6e-05, norm rho:    0.01129, rho * u:     0.0306, energy:   0.04086</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;<span class="stringliteral">Time:       2, dt:  5.6e-05, norm rho:    0.01189, rho * u:    0.03145, energy:   0.04417</span></div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;<span class="stringliteral">| Total wallclock time elapsed              | 5.396e+04s   151 | 5.396e+04s | 5.396e+04s     0 |</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;<span class="stringliteral">|                                           |                  |                               |</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;<span class="stringliteral">| Section                       | no. calls |   min time  rank |   avg time |   max time  rank |</span></div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="stringliteral">| compute errors                |        41 |     2.632s   178 |     7.221s |     16.56s     0 |</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="stringliteral">| compute transport speed       |      7072 |       714s   193 |      1553s |      3351s     0 |</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="stringliteral">| output                        |        41 |      8065s   176 |      8070s |      8079s     0 |</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="stringliteral">| rk time stepping total        |     35350 |  4.25e+04s     0 |  4.43e+04s | 4.515e+04s   193 |</span></div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="stringliteral">| rk_stage - integrals L_h      |    176750 | 2.936e+04s   134 | 3.222e+04s |  3.67e+04s    99 |</span></div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="stringliteral">| rk_stage - inv mass + vec upd |    176750 |      7004s    99 | 1.207e+04s |  1.55e+04s   132 |</span></div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;<span class="stringliteral">+-------------------------------------------+------------------+------------+------------------+</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;<span class="stringliteral">@endcode</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;<span class="stringliteral">This simulation had nearly 2 billion unknowns -- quite a large</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;<span class="stringliteral">computation indeed, and still only needed around 1.5 seconds per time</span></div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;<span class="stringliteral">step.</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;<span class="stringliteral">&lt;a name=&quot;Possibilitiesforextensions&quot;&gt;&lt;/a&gt;&lt;h3&gt;Possibilities for extensions&lt;/h3&gt;</span></div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;<span class="stringliteral">The code presented here straight-forwardly extends to adaptive meshes, given</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;<span class="stringliteral">appropriate indicators for setting the refinement flags. Large-scale</span></div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="stringliteral">adaptivity of a similar solver in the context of the acoustic wave equation</span></div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="stringliteral">has been achieved by the &lt;a href=&quot;https://github.com/kronbichler/exwave&quot;&gt;exwave</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="stringliteral">project&lt;/a&gt;. However, in the present context, the benefits of adaptivity are often</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="stringliteral">limited to early times and effects close to the origin of sound waves, as the</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="stringliteral">waves eventually reflect and diffract. This leads to steep gradients all over</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="stringliteral">the place, similar to turbulent flow, and a more or less globally</span></div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="stringliteral">refined mesh.</span></div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="stringliteral">Another topic that we did not discuss in the results section is a comparison</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="stringliteral">of different time integration schemes. The program provides four variants of</span></div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="stringliteral">low-storage Runga--Kutta integrators that each have slightly different</span></div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="stringliteral">accuracy and stability behavior. Among the schemes implemented here, the</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="stringliteral">higher-order ones provide additional accuracy but come with slightly lower</span></div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="stringliteral">efficiency in terms of step size per stage before they violate the CFL</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="stringliteral">condition. An interesting extension would be to compare the low-storage</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="stringliteral">variants proposed here with standard Runge--Kutta integrators or to use vector</span></div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="stringliteral">operations that are run separate from the mass matrix operation and compare</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="stringliteral">performance.</span></div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;<span class="stringliteral">&lt;a name=&quot;Moreadvancednumericalfluxfunctionsandskewsymmetricformulations&quot;&gt;&lt;/a&gt;&lt;h4&gt;More advanced numerical flux functions and skew-symmetric formulations&lt;/h4&gt;</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="stringliteral">As mentioned in the introduction, the modified Lax--Friedrichs flux and the</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;<span class="stringliteral">HLL flux employed in this program are only two variants of a large body of</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="stringliteral">numerical fluxes available in the literature on the Euler equations. One</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="stringliteral">example is the HLLC flux (Harten-Lax-van Leer-Contact) flux which adds the</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="stringliteral">effect of rarefaction waves missing in the HLL flux, or the Roe flux. As</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="stringliteral">mentioned in the introduction, the effect of numerical fluxes on high-order DG</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="stringliteral">schemes is debatable (unlike for the case of low-order discretizations).</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="stringliteral">A related improvement to increase the stability of the solver is to also</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="stringliteral">consider the spatial integral terms. A shortcoming in the rather naive</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="stringliteral">implementation used above is the fact that the energy conservation of the</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="stringliteral">original Euler equations (in the absence of shocks) only holds up to a</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;<span class="stringliteral">discretization error. If the solution is under-resolved, the discretization</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;<span class="stringliteral">error can give rise to an increase in the numerical energy and eventually</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="stringliteral">render the discretization unstable. This is because of the inexact numerical</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;<span class="stringliteral">integration of the terms in the Euler equations, which both contain rational</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="stringliteral">nonlinearities and higher-degree content from curved cells. A way out of this</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="stringliteral">dilemma are so-called skew-symmetric formulations, see @cite Gassner2013 for a</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;<span class="stringliteral">simple variant. Skew symmetry means that switching the role of the solution</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="stringliteral">@f$\mathbf{w}@f$ and test functions @f$\mathbf{v}@f$ in the weak form produces the</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="stringliteral">exact negative of the original quantity, apart from some boundary terms. In</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="stringliteral">the discrete setting, the challenge is to keep this skew symmetry also when</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="stringliteral">the integrals are only computed approximately (in the continuous case,</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="stringliteral">skew-symmetry is a consequence of integration by parts). Skew-symmetric</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="stringliteral">numerical schemes balance spatial derivatives in the conservative form</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="stringliteral">@f$(\nabla \mathbf v, \mathbf{F}(\mathbf w))_{K}@f$ with contributions in the</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="stringliteral">convective form @f$(\mathbf v, \tilde{\mathbf{F}}(\mathbf w)\nabla</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="stringliteral">\mathbf{w})_{K}@f$ for some @f$\tilde{\mathbf{F}}@f$. The precise terms depend on</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="stringliteral">the equation and the integration formula, and can in some cases by understood</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="stringliteral">by special skew-symmetric finite difference schemes.</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;<span class="stringliteral">To get started, interested readers could take a look at</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="stringliteral">https://github.com/kronbichler/advection_miniapp, where a</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;<span class="stringliteral">skew-symmetric DG formulation is implemented with deal.II for a simple advection</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;<span class="stringliteral">equation.</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;<span class="stringliteral">&lt;a name=&quot;Equippingthecodeforsupersoniccalculations&quot;&gt;&lt;/a&gt;&lt;h4&gt;Equipping the code for supersonic calculations&lt;/h4&gt;</span></div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="stringliteral">As mentioned in the introduction, the solution to the Euler equations develops</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="stringliteral">shocks as the Mach number increases, which require additional mechanisms to</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="stringliteral">stabilize the scheme, e.g. in the form of limiters. The main challenge besides</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;<span class="stringliteral">actually implementing the limiter or artificial viscosity approach would be to</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="stringliteral">load-balance the computations, as the additional computations involved for</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;<span class="stringliteral">limiting the oscillations in troubled cells would make them more expensive than the</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;<span class="stringliteral">plain DG cells without limiting. Furthermore, additional numerical fluxes that</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;<span class="stringliteral">better cope with the discontinuities would also be an option.</span></div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;<span class="stringliteral">One ingredient also necessary for supersonic flows are appropriate boundary</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;<span class="stringliteral">conditions. As opposed to the subsonic outflow boundaries discussed in the</span></div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;<span class="stringliteral">introduction and implemented in the program, all characteristics are outgoing</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;<span class="stringliteral">for supersonic outflow boundaries, so we do not want to prescribe any external</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;<span class="stringliteral">data,</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="stringliteral">@f[</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="stringliteral">\mathbf{w}^+ = \mathbf{w}^- = \begin{pmatrix} \rho^-\\</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="stringliteral">(\rho \mathbf u)^- \\ E^-\end{pmatrix} \quad</span></div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="stringliteral"> \text{(Neumann)}.</span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="stringliteral">@f]</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<span class="stringliteral">In the code, we would simply add the additional statement</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;<span class="stringliteral">@code</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="stringliteral">            else if (supersonic_outflow_boundaries.find(boundary_id) !=</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="stringliteral">                     supersonic_outflow_boundaries.end())</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;<span class="stringliteral">              {</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="stringliteral">                w_p        = w_m;</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;<span class="stringliteral">                at_outflow = true;</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;<span class="stringliteral">              }</span></div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="stringliteral">@endcode</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="stringliteral">in the `local_apply_boundary_face()` function.</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="stringliteral">&lt;a name=&quot;ExtensiontothelinearizedEulerequations&quot;&gt;&lt;/a&gt;&lt;h4&gt;Extension to the linearized Euler equations&lt;/h4&gt;</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="stringliteral">When the interest with an Euler solution is mostly in the propagation of sound</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="stringliteral">waves, it often makes sense to linearize the Euler equations around a</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="stringliteral">background state, i.e., a given density, velocity and energy (or pressure)</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="stringliteral">field, and only compute the change against these fields. This is the setting</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="stringliteral">of the wide field of aeroacoustics. Even though the resolution requirements</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="stringliteral">are sometimes considerably reduced, implementation gets somewhat more</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="stringliteral">complicated as the linearization gives rise to additional terms. From a code</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="stringliteral">perspective, in the operator evaluation we also need to equip the code with</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;<span class="stringliteral">the state to linearize against. This information can be provided either by</span></div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;<span class="stringliteral">analytical functions (that are evaluated in terms of the position of the</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;<span class="stringliteral">quadrature points) or by a vector similar to the solution. Based on that</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;<span class="stringliteral">vector, we would create an additional FEEvaluation object to read from it and</span></div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;<span class="stringliteral">provide the values of the field at quadrature points. If the background</span></div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;<span class="stringliteral">velocity is zero and the density is constant, the linearized Euler equations</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;<span class="stringliteral">further simplify and can equivalently be written in the form of the</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;<span class="stringliteral">acoustic wave equation.</span></div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;<span class="stringliteral">A challenge in the context of sound propagation is often the definition of</span></div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;<span class="stringliteral">boundary conditions, as the computational domain needs to be of finite size,</span></div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;<span class="stringliteral">whereas the actual simulation often spans an infinite (or at least much</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;<span class="stringliteral">larger) physical domain. Conventional Dirichlet or Neumann boundary conditions</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;<span class="stringliteral">give rise to reflections of the sound waves that eventually propagate back to</span></div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;<span class="stringliteral">the region of interest and spoil the solution. Therefore, various variants of</span></div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;<span class="stringliteral">non-reflecting boundary conditions or sponge layers, often in the form of</span></div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;<span class="stringliteral">&lt;a</span></div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;<span class="stringliteral">href=&quot;https://en.wikipedia.org/wiki/Perfectly_matched_layer&quot;&gt;perfectly</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;<span class="stringliteral">matched layers&lt;/a&gt; -- where the solution is damped without reflection</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;<span class="stringliteral">-- are common.</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="stringliteral">&lt;a name=&quot;ExtensiontothecompressibleNavierStokesequations&quot;&gt;&lt;/a&gt;&lt;h4&gt;Extension to the compressible Navier-Stokes equations&lt;/h4&gt;</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="stringliteral">The solver presented in this tutorial program can also be extended to the</span></div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<span class="stringliteral">compressible Navier--Stokes equations by adding viscous terms, as described in</span></div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;<span class="stringliteral">@cite FehnWallKronbichler2019. To keep as much of the performance obtained</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;<span class="stringliteral">here despite the additional cost of elliptic terms, e.g. via an interior</span></div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;<span class="stringliteral">penalty method, one can switch the basis from FE_DGQ to FE_DGQHermite like in</span></div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;<span class="stringliteral">the @ref step_59 &quot;step-59&quot; tutorial program.</span></div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;<span class="stringliteral"> *</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;<span class="stringliteral"> *</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;<span class="stringliteral">&lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;</span></div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;<span class="stringliteral">&lt;h1&gt; The plain program&lt;/h1&gt;</span></div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;<span class="stringliteral">@include &quot;step-67.cc&quot;</span></div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;<span class="stringliteral">*/</span></div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="affine__constraints_8h_source.html#l00506">affine_constraints.h:507</a></div></div>
<div class="ttc" id="aclassConditionalOStream_html"><div class="ttname"><a href="classConditionalOStream.html">ConditionalOStream</a></div><div class="ttdef"><b>Definition:</b> <a href="conditional__ostream_8h_source.html#l00080">conditional_ostream.h:81</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_ac1eb26168177faa30ffbcf9cbb9c3cd5"><div class="ttname"><a href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandlerType &amp;)</div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_ace4b76e565ba0701c4d32c26075ed3b9"><div class="ttname"><a href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">DataOut_DoFData&lt; DoFHandler&lt; dim &gt;, DoFHandlerType::dimension, DoFHandlerType::space_dimension &gt;::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00739">data_out_dof_data.h:1087</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00147">data_out.h:150</a></div></div>
<div class="ttc" id="aclassDataOut_html_a5eb51872b8736849bb7e8d2007fae086"><div class="ttname"><a href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01085">data_out.cc:1085</a></div></div>
<div class="ttc" id="aclassDataPostprocessor_html"><div class="ttname"><a href="classDataPostprocessor.html">DataPostprocessor</a></div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8h_source.html#l00520">data_postprocessor.h:521</a></div></div>
<div class="ttc" id="aclassDataPostprocessor_html_a1ba57b598d24d64365d469a854271c68"><div class="ttname"><a href="classDataPostprocessor.html#a1ba57b598d24d64365d469a854271c68">DataPostprocessor::evaluate_vector_field</a></div><div class="ttdeci">virtual void evaluate_vector_field(const DataPostprocessorInputs::Vector&lt; dim &gt; &amp;input_data, std::vector&lt; Vector&lt; double &gt;&gt; &amp;computed_quantities) const</div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8cc_source.html#l00037">data_postprocessor.cc:37</a></div></div>
<div class="ttc" id="aclassDataPostprocessor_html_a254f38bcdf4bdb5aa94231b695da7d55"><div class="ttname"><a href="classDataPostprocessor.html#a254f38bcdf4bdb5aa94231b695da7d55">DataPostprocessor::get_names</a></div><div class="ttdeci">virtual std::vector&lt; std::string &gt; get_names() const =0</div></div>
<div class="ttc" id="aclassDataPostprocessor_html_aadecdd040447b395164397ea1196f721"><div class="ttname"><a href="classDataPostprocessor.html#aadecdd040447b395164397ea1196f721">DataPostprocessor::get_needed_update_flags</a></div><div class="ttdeci">virtual UpdateFlags get_needed_update_flags() const =0</div></div>
<div class="ttc" id="aclassDataPostprocessor_html_ae994223acf8a16471ab5e579a4d75053"><div class="ttname"><a href="classDataPostprocessor.html#ae994223acf8a16471ab5e579a4d75053">DataPostprocessor::get_data_component_interpretation</a></div><div class="ttdeci">virtual std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; get_data_component_interpretation() const</div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8cc_source.html#l00048">data_postprocessor.cc:48</a></div></div>
<div class="ttc" id="aclassDerivativeForm_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">DerivativeForm::transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__form_8h_source.html#l00522">derivative_form.h:522</a></div></div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00314">dof_handler.h:315</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a553ca864aaf70330d9be86bc78f36d1e"><div class="ttname"><a href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">DoFHandler::distribute_dofs</a></div><div class="ttdeci">void distribute_dofs(const FiniteElement&lt; dim, spacedim &gt; &amp;fe)</div></div>
<div class="ttc" id="aclassDoFHandler_html_aa5b8d3c4b9deb0774dde5c2851e07e1e"><div class="ttname"><a href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">DoFHandler::n_dofs</a></div><div class="ttdeci">types::global_dof_index n_dofs() const</div></div>
<div class="ttc" id="aclassFEEvaluationAccess_html"><div class="ttname"><a href="classFEEvaluationAccess.html">FEEvaluationAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l01396">fe_evaluation.h:1401</a></div></div>
<div class="ttc" id="aclassFEEvaluationBaseData_html_a5d9ba9049f2df1bc4ef95ae789faf12e"><div class="ttname"><a href="classFEEvaluationBaseData.html#a5d9ba9049f2df1bc4ef95ae789faf12e">FEEvaluationBaseData&lt; dim, Number, false, VectorizedArray&lt; Number &gt; &gt;::data</a></div><div class="ttdeci">const internal::MatrixFreeFunctions::ShapeInfo&lt; VectorizedArray&lt; Number &gt; &gt; * data</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00408">fe_evaluation.h:408</a></div></div>
<div class="ttc" id="aclassFEEvaluationBaseData_html_aba2db8170a4e834313fa1775d50c26a2"><div class="ttname"><a href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">FEEvaluationBaseData&lt; dim, Number, false, VectorizedArray&lt; Number &gt; &gt;::cell</a></div><div class="ttdeci">unsigned int cell</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00443">fe_evaluation.h:443</a></div></div>
<div class="ttc" id="aclassFEEvaluationBaseData_html_adad456112f01b19291e7781fb5efee55"><div class="ttname"><a href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBaseData&lt; dim, Number, false, VectorizedArray&lt; Number &gt; &gt;::inverse_jacobian</a></div><div class="ttdeci">Tensor&lt; 2, dim, VectorizedArray&lt; Number &gt; &gt; inverse_jacobian(const unsigned int q_point) const</div></div>
<div class="ttc" id="aclassFEEvaluationBase_html"><div class="ttname"><a href="classFEEvaluationBase.html">FEEvaluationBase</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00544">fe_evaluation.h:546</a></div></div>
<div class="ttc" id="aclassFEEvaluationBase_html_a459813036810fbdc3c5487309b118fd8"><div class="ttname"><a href="classFEEvaluationBase.html#a459813036810fbdc3c5487309b118fd8">FEEvaluationBase::set_dof_values</a></div><div class="ttdeci">void set_dof_values(VectorType &amp;dst, const unsigned int first_index=0, const std::bitset&lt; VectorizedArrayType::size()&gt; &amp;mask=std::bitset&lt; VectorizedArrayType::size()&gt;().flip()) const</div></div>
<div class="ttc" id="aclassFEEvaluationBase_html_aeecc76ffeff6b36816f6af20af1398a8"><div class="ttname"><a href="classFEEvaluationBase.html#aeecc76ffeff6b36816f6af20af1398a8">FEEvaluationBase::get_value</a></div><div class="ttdeci">value_type get_value(const unsigned int q_point) const</div></div>
<div class="ttc" id="aclassFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02511">fe_evaluation.h:2516</a></div></div>
<div class="ttc" id="aclassFEEvaluation_html_a1b8934d6ae273d7b3f91994eddcad239"><div class="ttname"><a href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a></div><div class="ttdeci">const unsigned int n_q_points</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02941">fe_evaluation.h:2941</a></div></div>
<div class="ttc" id="aclassFEFaceEvaluation_html"><div class="ttname"><a href="classFEFaceEvaluation.html">FEFaceEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02996">fe_evaluation.h:3001</a></div></div>
<div class="ttc" id="aclassFEFaceEvaluation_html_a4ac53fde2eab227ef45c7d29a5ed33fe"><div class="ttname"><a href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate</a></div><div class="ttdeci">void gather_evaluate(const VectorType &amp;input_vector, const EvaluationFlags::EvaluationFlags evaluation_flag)</div></div>
<div class="ttc" id="aclassFEFaceEvaluation_html_a92f84b8ad276ca9866f30c6f789cf3a4"><div class="ttname"><a href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate</a></div><div class="ttdeci">void evaluate(const EvaluationFlags::EvaluationFlags evaluation_flag)</div></div>
<div class="ttc" id="aclassFESystem_html"><div class="ttname"><a href="classFESystem.html">FESystem</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__system_8h_source.html#l00215">fe_system.h:216</a></div></div>
<div class="ttc" id="aclassFiniteElement_html"><div class="ttname"><a href="classFiniteElement.html">FiniteElement</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00645">fe.h:646</a></div></div>
<div class="ttc" id="aclassFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00150">function.h:153</a></div></div>
<div class="ttc" id="aclassFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="aclassFunctions_1_1ConstantFunction_html"><div class="ttname"><a href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00410">function.h:411</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="la__parallel__vector_8h_source.html#l00248">la_parallel_vector.h:250</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="aclassMappingQGeneric_html"><div class="ttname"><a href="classMappingQGeneric.html">MappingQGeneric</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__generic_8h_source.html#l00135">mapping_q_generic.h:136</a></div></div>
<div class="ttc" id="aclassMapping_html"><div class="ttname"><a href="classMapping.html">Mapping</a></div><div class="ttdoc">Abstract base class for mapping classes.</div><div class="ttdef"><b>Definition:</b> <a href="mapping_8h_source.html#l00303">mapping.h:304</a></div></div>
<div class="ttc" id="aclassMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="operators_8h_source.html#l00618">operators.h:619</a></div></div>
<div class="ttc" id="aclassMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html_a5e95a87a9c63b321c77c72b8d762b760"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis</a></div><div class="ttdeci">void transform_from_q_points_to_basis(const unsigned int n_actual_components, const VectorizedArrayType *in_array, VectorizedArrayType *out_array) const</div><div class="ttdef"><b>Definition:</b> <a href="operators_8h_source.html#l01062">operators.h:1063</a></div></div>
<div class="ttc" id="aclassMatrixFree_html"><div class="ttname"><a href="classMatrixFree.html">MatrixFree</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00116">matrix_free.h:117</a></div></div>
<div class="ttc" id="aclassMatrixFree_html_a0e9669e4a5cfaceac78f5e26c285c2ea"><div class="ttname"><a href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop</a></div><div class="ttdeci">void loop(const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;cell_operation, const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;face_operation, const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;boundary_operation, OutVector &amp;dst, const InVector &amp;src, const bool zero_dst_vector=false, const DataAccessOnFaces dst_vector_face_access=DataAccessOnFaces::unspecified, const DataAccessOnFaces src_vector_face_access=DataAccessOnFaces::unspecified) const</div></div>
<div class="ttc" id="aclassMatrixFree_html_a1d516071d20e633dc9efcadb7852ce15"><div class="ttname"><a href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch</a></div><div class="ttdeci">unsigned int n_active_entries_per_cell_batch(const unsigned int cell_batch_index) const</div></div>
<div class="ttc" id="aclassMatrixFree_html_abc204ec41ead1b5060f47ef3a5a066d7"><div class="ttname"><a href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop</a></div><div class="ttdeci">void cell_loop(const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;cell_operation, OutVector &amp;dst, const InVector &amp;src, const bool zero_dst_vector=false) const</div></div>
<div class="ttc" id="aclassMatrixFree_html_adb324d469b296f2a6921b41208732ddf"><div class="ttname"><a href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">MatrixFree::reinit</a></div><div class="ttdeci">void reinit(const MappingType &amp;mapping, const DoFHandler&lt; dim &gt; &amp;dof_handler, const AffineConstraints&lt; number2 &gt; &amp;constraint, const QuadratureType &amp;quad, const AdditionalData &amp;additional_data=AdditionalData())</div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2point_8h_source.html#l00110">point.h:111</a></div></div>
<div class="ttc" id="aclassPoint_html_a25d858964d15e04ff371d8738a17ea33"><div class="ttname"><a href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">Point::operator*</a></div><div class="ttdeci">Point&lt; dim, typename ProductType&lt; Number, typename EnableIfScalar&lt; OtherNumber &gt;::type &gt;::type &gt; operator*(const OtherNumber) const</div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00038">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="aclassQuadrature_html"><div class="ttname"><a href="classQuadrature.html">Quadrature</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2quadrature_8h_source.html#l00083">quadrature.h:84</a></div></div>
<div class="ttc" id="aclassSymmetricTensor_html_a45c9cd0a3fecbd58ae133dfdd104f9f9"><div class="ttname"><a href="classSymmetricTensor.html#a45c9cd0a3fecbd58ae133dfdd104f9f9">SymmetricTensor::eigenvalues</a></div><div class="ttdeci">std::array&lt; Number, 1 &gt; eigenvalues(const SymmetricTensor&lt; 2, 1, Number &gt; &amp;T)</div></div>
<div class="ttc" id="aclassSymmetricTensor_html_a6c9d8cfe285d568676bb6e308146c147"><div class="ttname"><a href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">SymmetricTensor::sum</a></div><div class="ttdeci">SymmetricTensor&lt; rank, dim, Number &gt; sum(const SymmetricTensor&lt; rank, dim, Number &gt; &amp;local, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="aclassSymmetricTensor_html_a7c03a03a5fe823733e7af9f7e4267f81"><div class="ttname"><a href="classSymmetricTensor.html#a7c03a03a5fe823733e7af9f7e4267f81">SymmetricTensor::determinant</a></div><div class="ttdeci">constexpr Number determinant(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l02622">symmetric_tensor.h:2622</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="tensor_8h_source.html#l00449">tensor.h:450</a></div></div>
<div class="ttc" id="aclassTimeStepping_1_1LowStorageRungeKutta_html"><div class="ttname"><a href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00409">time_stepping.h:410</a></div></div>
<div class="ttc" id="aclassTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00552">timer.h:553</a></div></div>
<div class="ttc" id="aclassTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00544">timer.h:545</a></div></div>
<div class="ttc" id="aclassTimerOutput_html_ae7673798226de7731e3ecdf7c0fb7568"><div class="ttname"><a href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics</a></div><div class="ttdeci">void print_wall_time_statistics(const MPI_Comm &amp;mpi_comm, const double print_quantile=0.) const</div><div class="ttdef"><b>Definition:</b> <a href="timer_8cc_source.html#l00844">timer.cc:844</a></div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l01127">tria.h:1128</a></div></div>
<div class="ttc" id="aclassUtilities_1_1MPI_1_1MPI__InitFinalize_html"><div class="ttname"><a href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a></div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00902">mpi.h:903</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="vector_8h_source.html#l00109">vector.h:110</a></div></div>
<div class="ttc" id="aclassVectorizedArrayBase_html_acb35404acc1693aee6e990228924cc09"><div class="ttname"><a href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayBase&lt; VectorizedArray&lt; Number, width &gt;, 1 &gt;::size</a></div><div class="ttdeci">static constexpr std::size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00257">vectorization.h:257</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray</a></div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00389">vectorization.h:391</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a2ffe4cdaef4472045fff75d609590f8a"><div class="ttname"><a href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">VectorizedArray::max</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; max(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05460">vectorization.h:5460</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a8402043a938d7bb8af59713a5c0cc73e"><div class="ttname"><a href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">VectorizedArray::min</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; min(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05477">vectorization.h:5477</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a935e528bb3b525ac056167a64d7ab71d"><div class="ttname"><a href="classVectorizedArray.html#a935e528bb3b525ac056167a64d7ab71d">VectorizedArray::sqrt</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05406">vectorization.h:5406</a></div></div>
<div class="ttc" id="aclassparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_2tria_8h_source.html#l00252">tria.h:254</a></div></div>
<div class="ttc" id="aconfig_8h_html_a1d1d58e8be15e5c4285f6892e5f33136"><div class="ttname"><a href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="ttdeci">#define DEAL_II_ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00096">config.h:96</a></div></div>
<div class="ttc" id="aconfig_8h_html_a202e950262df75b31ea0486f4dd2447f"><div class="ttname"><a href="config_8h.html#a202e950262df75b31ea0486f4dd2447f">DEAL_II_OPENMP_SIMD_PRAGMA</a></div><div class="ttdeci">#define DEAL_II_OPENMP_SIMD_PRAGMA</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00136">config.h:136</a></div></div>
<div class="ttc" id="adata__out__base_8cc_html_accc45da40beb7ae1b485306984e904a2"><div class="ttname"><a href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a></div><div class="ttdeci">Point&lt; 3 &gt; vertices[4]</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00175">data_out_base.cc:175</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00066">fe_update_flags.h:67</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00078">fe_update_flags.h:78</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdeci">@ update_normal_vectors</div><div class="ttdoc">Normal vectors.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00136">fe_update_flags.h:136</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00129">fe_update_flags.h:129</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdeci">@ update_gradients</div><div class="ttdoc">Shape function gradients.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00084">fe_update_flags.h:84</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00122">fe_update_flags.h:122</a></div></div>
<div class="ttc" id="agrid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="agrid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="agrid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
<div class="ttc" id="agroup__CUDAWrappers_html_gabb7130e2cea54654455ca41ef304f939"><div class="ttname"><a href="group__CUDAWrappers.html#gabb7130e2cea54654455ca41ef304f939">LinearAlgebra::CUDAWrappers::kernel::set</a></div><div class="ttdeci">__global__ void set(Number *val, const Number s, const size_type N)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga5df488dad82b811ceb08cb1adf9eafcd"><div class="ttname"><a href="group__Exceptions.html#ga5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a></div><div class="ttdeci">void write_vtu_in_parallel(const std::string &amp;filename, const MPI_Comm &amp;comm) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07210">data_out_base.cc:7210</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01473">exceptions.h:1473</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="patterns_8h_source.html#l02329">patterns.h:2329</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01630">exceptions.h:1630</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gaa9dd1830c0ff35a2431704c4d45453eb"><div class="ttname"><a href="group__Exceptions.html#gaa9dd1830c0ff35a2431704c4d45453eb">DataOutBase::VtkFlags::write_higher_order_cells</a></div><div class="ttdeci">bool write_higher_order_cells</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01170">data_out_base.h:1170</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="group__Exceptions.html#gac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08166">data_out_base.cc:8166</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01583">exceptions.h:1583</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c"><div class="ttname"><a href="group__Exceptions.html#gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">Differentiation::SD::OptimizerType::lambda</a></div><div class="ttdeci">@ lambda</div></div>
<div class="ttc" id="agroup__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00439">loop.h:439</a></div></div>
<div class="ttc" id="agroup__Vectors_html_gaa6376a098589519491fc452d1529f57b"><div class="ttname"><a href="group__Vectors.html#gaa6376a098589519491fc452d1529f57b">LinearAlgebra::distributed::Vector::sadd</a></div><div class="ttdeci">virtual void sadd(const Number s, const Number a, const VectorSpaceVector&lt; Number &gt; &amp;V) override</div></div>
<div class="ttc" id="agroup__Vectors_html_gace027311492ed2f6e07fbd74d723e3a9"><div class="ttname"><a href="group__Vectors.html#gace027311492ed2f6e07fbd74d723e3a9">LinearAlgebra::distributed::Vector::reinit</a></div><div class="ttdeci">void reinit(const size_type size, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="agroup__matrixfree_html_ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0"><div class="ttname"><a href="group__matrixfree.html#ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0">internal::MatrixFreeFunctions::affine</a></div><div class="ttdeci">@ affine</div><div class="ttdef"><b>Definition:</b> <a href="mapping__info_8h_source.html#l00065">mapping_info.h:65</a></div></div>
<div class="ttc" id="alogstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="anamespaceAdaptationStrategies_1_1Refinement_html_a0fda1b577bf969eb15b3992120d682a3"><div class="ttname"><a href="namespaceAdaptationStrategies_1_1Refinement.html#a0fda1b577bf969eb15b3992120d682a3">AdaptationStrategies::Refinement::split</a></div><div class="ttdeci">std::vector&lt; value_type &gt; split(const typename ::Triangulation&lt; dim, spacedim &gt;::cell_iterator &amp;parent, const value_type parent_value)</div></div>
<div class="ttc" id="anamespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a></div><div class="ttdeci">DataComponentInterpretation</div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00047">data_component_interpretation.h:48</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a1f3cd50135818a6458f1d3ff7ea4bb51">DataComponentInterpretation::component_is_scalar</a></div><div class="ttdeci">@ component_is_scalar</div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00053">data_component_interpretation.h:53</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdeci">@ component_is_part_of_vector</div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00059">data_component_interpretation.h:59</a></div></div>
<div class="ttc" id="anamespaceDerivativeApproximation_1_1internal_html_a4bea05d5ab84ca1e802db9a0217d1d6c"><div class="ttname"><a href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">DerivativeApproximation::internal::approximate</a></div><div class="ttdeci">void approximate(SynchronousIterators&lt; std::tuple&lt; typename DoFHandler&lt; dim, spacedim &gt;::active_cell_iterator, Vector&lt; float &gt;::iterator &gt;&gt; const &amp;cell, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const InputVector &amp;solution, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l00913">derivative_approximation.cc:913</a></div></div>
<div class="ttc" id="anamespaceDifferentiation_1_1SD_html_aa55d50a1ffa79c27f9bd9ea104f15158"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">Differentiation::SD::sign</a></div><div class="ttdeci">Expression sign(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00280">symengine_math.cc:280</a></div></div>
<div class="ttc" id="anamespaceDoFRenumbering_html_a59c1a183ef6288e6bb061eb738b84380"><div class="ttname"><a href="namespaceDoFRenumbering.html#a59c1a183ef6288e6bb061eb738b84380">DoFRenumbering::downstream</a></div><div class="ttdeci">void downstream(DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const Tensor&lt; 1, spacedim &gt; &amp;direction, const bool dof_wise_renumbering=false)</div><div class="ttdef"><b>Definition:</b> <a href="dof__renumbering_8cc_source.html#l01741">dof_renumbering.cc:1741</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdeci">@ nonzero</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00244">dof_tools.h:243</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdeci">@ always</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00235">dof_tools.h:235</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a></div><div class="ttdeci">@ nothing</div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00047">evaluation_flags.h:47</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a></div><div class="ttdeci">@ gradients</div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00055">evaluation_flags.h:55</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdeci">@ values</div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00051">evaluation_flags.h:51</a></div></div>
<div class="ttc" id="anamespaceFunctions_html"><div class="ttname"><a href="namespaceFunctions.html">Functions</a></div><div class="ttdef"><b>Definition:</b> <a href="flow__function_8h_source.html#l00028">flow_function.h:29</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a56019d263ae45708302d5d7599f0d458"><div class="ttname"><a href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a></div><div class="ttdeci">void hyper_rectangle(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Point&lt; dim &gt; &amp;p1, const Point&lt; dim &gt; &amp;p2, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a5cdda7b4a76d509af7d1a8dc1320ddb0"><div class="ttname"><a href="namespaceGridGenerator.html#a5cdda7b4a76d509af7d1a8dc1320ddb0">GridGenerator::cylinder</a></div><div class="ttdeci">void cylinder(Triangulation&lt; dim &gt; &amp;tria, const double radius=1., const double half_length=1.)</div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a9d0b8a34fe5ca58425aa1fcf0d6132f1"><div class="ttname"><a href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a></div><div class="ttdeci">void channel_with_cylinder(Triangulation&lt; dim &gt; &amp;tria, const double shell_region_width=0.03, const unsigned int n_shells=2, const double skewness=2.0, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceGridTools_html_a0967563badadd81f77f62622dd8bc2cd"><div class="ttname"><a href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">GridTools::scale</a></div><div class="ttdeci">void scale(const double scaling_factor, Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l02043">grid_tools.cc:2043</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_a9e8169dc4981e90ba5d2386a87efa042"><div class="ttname"><a href="namespaceGridTools.html#a9e8169dc4981e90ba5d2386a87efa042">GridTools::volume</a></div><div class="ttdeci">double volume(const Triangulation&lt; dim, spacedim &gt; &amp;tria, const Mapping&lt; dim, spacedim &gt; &amp;mapping=(ReferenceCells::get_hypercube&lt; dim &gt;() .template get_default_linear_mapping&lt; dim, spacedim &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00137">grid_tools.cc:137</a></div></div>
<div class="ttc" id="anamespaceIteratorState_html_a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92"><div class="ttname"><a href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">IteratorState::valid</a></div><div class="ttdeci">@ valid</div><div class="ttdoc">Iterator points to a valid object.</div><div class="ttdef"><b>Definition:</b> <a href="tria__iterator__base_8h_source.html#l00038">tria_iterator_base.h:38</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a0a1f0b9f7bb0b746b8f27d7f297ed7fe"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0a1f0b9f7bb0b746b8f27d7f297ed7fe">LAPACKSupport::L</a></div><div class="ttdeci">static const char L</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00173">lapack_support.h:173</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00181">lapack_support.h:181</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdeci">@ matrix</div><div class="ttdoc">Contents is actually a matrix.</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00058">lapack_support.h:58</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00153">lapack_support.h:153</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdeci">@ symmetric</div><div class="ttdoc">Matrix is symmetric.</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00113">lapack_support.h:113</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">LAPACKSupport::diagonal</a></div><div class="ttdeci">@ diagonal</div><div class="ttdoc">Matrix is diagonal.</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00119">lapack_support.h:119</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdeci">@ general</div><div class="ttdoc">No special properties.</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00111">lapack_support.h:111</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a8cac1e477eff052db622c8a9a9426ea3"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">LAPACKSupport::T</a></div><div class="ttdeci">static const char T</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00165">lapack_support.h:165</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00185">lapack_support.h:185</a></div></div>
<div class="ttc" id="anamespaceLinearAlgebra_html"><div class="ttname"><a href="namespaceLinearAlgebra.html">LinearAlgebra</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2communication__pattern__base_8h_source.html#l00026">communication_pattern_base.h:27</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Divergence_html_a8bcfc37d2a2be8faa18628a601ecf112"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt;&gt;&gt; &amp;Du)</div><div class="ttdef"><b>Definition:</b> <a href="divergence_8h_source.html#l00472">divergence.h:472</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1L2_html_a0a7d7409a5f53485a841a33fda68d916"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">LocalIntegrators::L2::L2</a></div><div class="ttdeci">void L2(Vector&lt; number &gt; &amp;result, const FEValuesBase&lt; dim &gt; &amp;fe, const std::vector&lt; double &gt; &amp;input, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00160">l2.h:160</a></div></div>
<div class="ttc" id="anamespaceOpenCASCADE_html_a7b0b2393711bae58d859be1bb9761781"><div class="ttname"><a href="namespaceOpenCASCADE.html#a7b0b2393711bae58d859be1bb9761781">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a6b25dd8f005063d8d2b0a4bdb0d277f3"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">Physics::Elasticity::Kinematics::w</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; w(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_aa87528a28ad8a95fa89a3876e6f986c8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#aa87528a28ad8a95fa89a3876e6f986c8">Physics::Elasticity::Kinematics::F</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; F(const Tensor&lt; 2, dim, Number &gt; &amp;Grad_u)</div></div>
<div class="ttc" id="anamespaceTensorAccessors_html_a5798da96660fa8e6798917501d65dbd8"><div class="ttname"><a href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">TensorAccessors::extract</a></div><div class="ttdeci">constexpr ReturnType&lt; rank, T &gt;::value_type &amp; extract(T &amp;t, const ArrayType &amp;indices)</div><div class="ttdef"><b>Definition:</b> <a href="tensor__accessors_8h_source.html#l00220">tensor_accessors.h:220</a></div></div>
<div class="ttc" id="anamespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00386">thread_management.h:386</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a></div><div class="ttdeci">runge_kutta_method</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00060">time_stepping.h:61</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a6a1cbeb6dd2a5ed5ac2e3efe3293e941">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE9_ORDER5</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00101">time_stepping.h:101</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4aba5c997ffa7c63d0c0f6b046a53d63bf">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE3_ORDER3</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00086">time_stepping.h:86</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">TimeStepping::invalid</a></div><div class="ttdeci">@ invalid</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00144">time_stepping.h:143</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af34241e1b27c2f0f2f90715ee9f97bdb">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE7_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00096">time_stepping.h:96</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4a68ccb74e043ac956cddf23fa57e48">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE5_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00091">time_stepping.h:91</a></div></div>
<div class="ttc" id="anamespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1CUDA_html_afc505a095cc4c7600f65ecb99851312e"><div class="ttname"><a href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">Utilities::CUDA::free</a></div><div class="ttdeci">void free(T *&amp;pointer)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2cuda_8h_source.html#l00097">cuda.h:97</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a895dcd8223a0ee6f0e6a80b80e2d5982"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a></div><div class="ttdeci">unsigned int this_mpi_process(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00128">mpi.cc:128</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a9ac5275c3c74902f8a9d6e7bdb514179"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a></div><div class="ttdeci">T min(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ac26de0c059200523177bb1d92cc25d00"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a></div><div class="ttdeci">unsigned int n_mpi_processes(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00117">mpi.cc:117</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ad2f716b789abe53715d6659f38aa7815"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a></div><div class="ttdeci">T max(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_a76bc1cc7649cc416723f450d24fdd91d"><div class="ttname"><a href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">Utilities::System::get_time</a></div><div class="ttdeci">std::string get_time()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l01019">utilities.cc:1019</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_ade631a789101336840371e3b2e2851e0"><div class="ttname"><a href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a></div><div class="ttdeci">const std::string get_current_vectorization_level()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00944">utilities.cc:944</a></div></div>
<div class="ttc" id="anamespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00030">communication_pattern_base.h:31</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a0900f35b37ee122e73fb2c80bba9beb9"><div class="ttname"><a href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a></div><div class="ttdeci">constexpr T pow(const T base, const int iexp)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2utilities_8h_source.html#l00461">utilities.h:461</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a17955af7a4bc8771d430e622f9e732b3"><div class="ttname"><a href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a></div><div class="ttdeci">Number truncate_to_n_digits(const Number number, const unsigned int n_digits)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00581">utilities.cc:581</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffda8e7f5b8545162dccd5ed717792bdf420">VectorTools::EvaluationFlags::max</a></div><div class="ttdeci">@ max</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00053">vector_tools_evaluate.h:53</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdacc8b05748569f308550a239dc5b14396">VectorTools::EvaluationFlags::avg</a></div><div class="ttdeci">@ avg</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00047">vector_tools_evaluate.h:47</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeb244a97c0c9e9e7ca4765e096f0badc">VectorTools::EvaluationFlags::min</a></div><div class="ttdeci">@ min</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__evaluate_8h_source.html#l00059">vector_tools_evaluate.h:59</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a676190d2c897ac5da68a9c460fa95832"><div class="ttname"><a href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a></div><div class="ttdeci">void integrate_difference(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InVector &amp;fe_function, const Function&lt; spacedim, typename InVector::value_type &gt; &amp;exact_solution, OutVector &amp;difference, const Quadrature&lt; dim &gt; &amp;q, const NormType &amp;norm, const Function&lt; spacedim, double &gt; *weight=nullptr, const double exponent=2.)</div></div>
<div class="ttc" id="anamespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="anamespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00691">work_stream.h:691</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="namespace__dealii_8h_source.html#l00025">namespace_dealii.h:26</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1QGaussLobatto_html_ac1aec52fdbb26c78e2d32fc0bed659c7"><div class="ttname"><a href="namespaceinternal_1_1QGaussLobatto.html#ac1aec52fdbb26c78e2d32fc0bed659c7">internal::QGaussLobatto::gamma</a></div><div class="ttdeci">long double gamma(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8cc_source.html#l00096">quadrature_lib.cc:96</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1SymmetricTensorAccessors_html_a3080af8704b3a9882a6fab3eecc63568"><div class="ttname"><a href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">internal::SymmetricTensorAccessors::merge</a></div><div class="ttdeci">constexpr TableIndices&lt; 2 &gt; merge(const TableIndices&lt; 2 &gt; &amp;previous_indices, const unsigned int new_index, const unsigned int position)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l00145">symmetric_tensor.h:145</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1TriangulationImplementation_html_a9f815604be9b560fea00beef8d720480"><div class="ttname"><a href="namespaceinternal_1_1TriangulationImplementation.html#a9f815604be9b560fea00beef8d720480">internal::TriangulationImplementation::n_cells</a></div><div class="ttdeci">unsigned int n_cells(const internal::TriangulationImplementation::NumberCache&lt; 1 &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12651">tria.cc:12651</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1VectorOperations_html_a40c8daa0881cff0123fbaeb08929f5cb"><div class="ttname"><a href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">internal::VectorOperations::copy</a></div><div class="ttdeci">void copy(const T *begin, const T *end, U *dest)</div><div class="ttdef"><b>Definition:</b> <a href="vector__operations__internal_8h_source.html#l00068">vector_operations_internal.h:68</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="anamespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__block_8h_source.html#l00618">matrix_block.h:618</a></div></div>
<div class="ttc" id="anamespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div><div class="ttdeci">@ value</div></div>
<div class="ttc" id="anamespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div><div class="ttdeci">@ gradient</div></div>
<div class="ttc" id="anamespacenumbers_html"><div class="ttname"><a href="namespacenumbers.html">numbers</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00201">numbers.h:202</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3c7239f00d5e87dfcf6dd19cbc3ddc74"><div class="ttname"><a href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">numbers::E</a></div><div class="ttdeci">static constexpr double E</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00206">numbers.h:206</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00231">numbers.h:231</a></div></div>
<div class="ttc" id="anamespaceparallel_html"><div class="ttname"><a href="namespaceparallel.html">parallel</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_8h_source.html#l00416">distributed.h:417</a></div></div>
<div class="ttc" id="anamespacestd__cxx17_html_aa2fc1031c06af4aea4de90c5a1905473"><div class="ttname"><a href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">std_cxx17::apply</a></div><div class="ttdeci">auto apply(F &amp;&amp;fn, Tuple &amp;&amp;t) -&gt; decltype(apply_impl(std::forward&lt; F &gt;(fn), std::forward&lt; Tuple &gt;(t), std::make_index_sequence&lt; std::tuple_size&lt; typename std::remove_reference&lt; Tuple &gt;::type &gt;::value &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="tuple_8h_source.html#l00036">tuple.h:36</a></div></div>
<div class="ttc" id="anamespacetypes_html"><div class="ttname"><a href="namespacetypes.html">types</a></div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00031">types.h:32</a></div></div>
<div class="ttc" id="anamespacetypes_html_aed8813fee8c8a2edcc6005e6a48c321a"><div class="ttname"><a href="namespacetypes.html#aed8813fee8c8a2edcc6005e6a48c321a">types::boundary_id</a></div><div class="ttdeci">unsigned int boundary_id</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00129">types.h:129</a></div></div>
<div class="ttc" id="anumbers_8h_html_ac4a2ed1890a931d0b6a55933310eadca"><div class="ttname"><a href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05406">vectorization.h:5406</a></div></div>
<div class="ttc" id="anumbers_8h_html_af44aee1db5cdcd0bab54e3c011d2be66"><div class="ttname"><a href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;, const Number p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05422">vectorization.h:5422</a></div></div>
<div class="ttc" id="ap4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="astructDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01087">data_out_base.h:1088</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor_8h_source.html#l00337">data_postprocessor.h:338</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html">MatrixFree::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00181">matrix_free.h:182</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_a0bcce2facca91b925d3e1a5a00c7704b"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">MatrixFree::AdditionalData::tasks_parallel_scheme</a></div><div class="ttdeci">TasksParallelScheme tasks_parallel_scheme</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00344">matrix_free.h:344</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_a5c25759917955940e0b2b74a6704012c"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">MatrixFree::AdditionalData::mapping_update_flags_inner_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_inner_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00410">matrix_free.h:410</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_aa326b1a098e1c037334cc05bdc2decc6"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">MatrixFree::AdditionalData::mapping_update_flags_boundary_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_boundary_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00389">matrix_free.h:389</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_aa5d597e6c4441d273f4100b6139a2552"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">MatrixFree::AdditionalData::mapping_update_flags</a></div><div class="ttdeci">UpdateFlags mapping_update_flags</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00368">matrix_free.h:368</a></div></div>
<div class="ttc" id="avectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a></div><div class="ttdeci">@ equal</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
