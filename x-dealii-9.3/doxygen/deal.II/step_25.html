<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_25.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-25 tutorial program 。</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.3.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.3.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-25 tutorial program 。 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>本教程取决于 <a class="el" href="step_24.html">step-24</a> 。</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#Statementoftheproblem">Statement of the problem</a><a href="#Statementoftheproblem">Statement of the problem</a>
        <li><a href="#Discretizationoftheequationsintime">Discretization of the equations in time</a><a href="#Discretizationoftheequationsintime">Discretization of the equations in time</a>
        <li><a href="#Weakformulationofthetimediscretizedequations">Weak formulation of the time-discretized equations</a><a href="#Weakformulationofthetimediscretizedequations">Weak formulation of the time-discretized equations</a>
        <li><a href="#Discretizationoftheweakformulationinspace">Discretization of the weak formulation in space</a><a href="#Discretizationoftheweakformulationinspace">Discretization of the weak formulation in space</a>
        <li><a href="#Thetestcase">The test case</a><a href="#Thetestcase">The test case</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Includefilesandglobalvariables">Include files and global variables</a><a href="#Includefilesandglobalvariables">Include files and global variables</a>
        <li><a href="#ThecodeSineGordonProblemcodeclasstemplate">The <code>SineGordonProblem</code> class template</a><a href="#ThecodeSineGordonProblemcodeclasstemplate">The <code>SineGordonProblem</code> class template</a>
        <li><a href="#Initialconditions">Initial conditions</a><a href="#Initialconditions">Initial conditions</a>
        <li><a href="#ImplementationofthecodeSineGordonProblemcodeclass">Implementation of the <code>SineGordonProblem</code> class</a><a href="#ImplementationofthecodeSineGordonProblemcodeclass">Implementation of the <code>SineGordonProblem</code> class</a>
      <ul>
        <li><a href="#SineGordonProblemSineGordonProblem">SineGordonProblem::SineGordonProblem</a><a href="#SineGordonProblemSineGordonProblem">SineGordonProblem::SineGordonProblem</a>
        <li><a href="#SineGordonProblemmake_grid_and_dofs">SineGordonProblem::make_grid_and_dofs</a> ]<a href="#SineGordonProblemmake_grid_and_dofs">SineGordonProblem::make_grid_and_dofs</a>
        <li><a href="#SineGordonProblemassemble_system">SineGordonProblem::assemble_system</a><a href="#SineGordonProblemassemble_system">SineGordonProblem::assemble_system</a>
        <li><a href="#SineGordonProblemcompute_nl_term">SineGordonProblem::compute_nl_term</a><a href="#SineGordonProblemcompute_nl_term">SineGordonProblem::compute_nl_term</a>
        <li><a href="#SineGordonProblemcompute_nl_matrix">SineGordonProblem::compute_nl_matrix</a><a href="#SineGordonProblemcompute_nl_matrix">SineGordonProblem::compute_nl_matrix</a>
        <li><a href="#SineGordonProblemsolve">SineGordonProblem::solve</a><a href="#SineGordonProblemsolve">SineGordonProblem::solve</a>
        <li><a href="#SineGordonProblemoutput_results">SineGordonProblem::output_results</a><a href="#SineGordonProblemoutput_results">SineGordonProblem::output_results</a>
        <li><a href="#SineGordonProblemrun">SineGordonProblem::run</a><a href="#SineGordonProblemrun">SineGordonProblem::run</a>
      </ul>
        <li><a href="#Thecodemaincodefunction">The <code>main</code> function</a><a href="#Thecodemaincodefunction">The <code>main</code> function</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#An11dSolution">An (1+1)-d Solution</a><a href="#An11dSolution">An (1+1)-d Solution</a>
        <li><a href="#Afew21DSolutions">A few (2+1)D Solutions</a><a href="#Afew21DSolutions">A few (2+1)D Solutions</a>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
</p>
<p><a class="anchor" id="Introduction"></a><a class="anchor" id="Intro"></a></p><h1>Introduction</h1>
<p>这个程序是由德克萨斯A&amp;M大学的Ivan Christov的一个学生项目发展而来的。这个程序的大部分工作都是由他完成的。</p>
<p>这个程序的目标是解决1、2或3空间维度的正弦戈登孤子方程。解决这个方程的动机是对二维和三维解的性质知之甚少，尽管一维情况已经被广泛研究。</p>
<p>正弦戈登方程的名称是对所谓的克莱因-戈登方程的双关语，克莱因-戈登方程是质量不为零的粒子的薛定谔方程的相对论版本。这种相似性不仅仅是表面的，正弦-戈登方程已经被证明可以模拟一些统一场现象，如亚原子粒子的相互作用（见，例如，Perring &amp; Skyrme in Nuclear Physics <b>31</b>）和超导体结中的约瑟夫森（量子）效应（见，例如<a href="http://en.wikipedia.org/wiki/Long_Josephson_junction">http://en.wikipedia.org/wiki/Long_Josephson_junction</a>）。此外，从数学的角度来看，由于正弦戈登方程是 "完全可积分的"，它是使用反散射变换等通常方法研究的候选者。因此，多年来，人们发现了许多有趣的孤波，甚至是静止的正弦戈登方程解。在这些解中，粒子对应于局部特征。关于正弦戈登方程、反散射变换和其他寻找分析性孤子方程的方法的更多信息，读者应参考以下关于该主题的 "经典 "参考资料。G. L. Lamb的<em>Elements of Soliton Theory</em>（第5章，第2节）和G. B. Whitham的<em>Linear and Nonlinear Waves</em>（第17章，第10-13节）。</p>
<dl class="section note"><dt>Note</dt><dd>我们将在 <a class="el" href="step_58.html">step-58</a> 中介绍量子力学的一个单独的非线性方程，即非线性Schr&ouml;dinger方程。</dd></dl>
<p><a class="anchor" id="Statementoftheproblem"></a></p><h3>Statement of the problem</h3>
<p>我们希望解决的正弦-戈登初始边界值问题（IBVP）由以下方程组成。 </p><p class="formulaDsp">
\begin{eqnarray*} u_{tt}-\Delta u &amp;=&amp; -\sin(u) \quad\mbox{for}\quad (x,t) \in \Omega \times (t_0,t_f],\\ {\mathbf n} \cdot \nabla u &amp;=&amp; 0 \quad\mbox{for}\quad (x,t) \in \partial\Omega \times (t_0,t_f],\\ u(x,t_0) &amp;=&amp; u_0(x). \end{eqnarray*}
</p>
<p> 这是一个类似于我们在 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 中讨论的波浪方程的非线性方程。我们选择强制执行零诺伊曼边界条件，以使波从我们领域的边界上反射出去。然而，应该注意的是，迪里希特边界条件并不适合这个问题。尽管正弦-戈登方程的解是局部的，但只有在 \(x=\pm\infty\) 处指定（迪里希特）边界条件才有意义，否则要么不存在解，要么只存在微不足道的解 \(u=0\) 。</p>
<p>然而，上述方程的形式对于数值离散化来说并不理想。如果我们要直接准确地离散二阶时间导数，那么我们将需要一个大的模板（即需要在内存中保留几个时间步长），这可能变得很昂贵。因此，与我们在 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 中的做法完全类似，我们将二阶（时间上）正弦-戈登方程分割成两个一阶（时间上）方程系统，我们称之为分割或速度公式。为此，通过设置 \(v = u_t\) ，很容易看到正弦-戈登方程等同于 </p><p class="formulaDsp">
\begin{eqnarray*} u_t - v &amp;=&amp; 0,\\ v_t - \Delta u &amp;=&amp; -\sin(u). \end{eqnarray*}
</p>
<p><a class="anchor" id="Discretizationoftheequationsintime"></a></p><h3>Discretization of the equations in time</h3>
<p>现在，我们可以用 \(\theta\) 方法对分裂公式进行时间离散，该方法的模板只有两个时间步长。通过选择 \(\theta\in [0,1]\) ，后者的离散化允许我们从一系列的方案中进行选择。特别是，如果我们选择 \(\theta=0\) 或 \(\theta=1\) ，我们可以分别得到一阶精确的显式或隐式欧拉方法。另一个重要的选择是 \(\theta=\frac{1}{2}\) ，它给出了二阶精确的Crank-Nicolson方案。因此，上标 \(n\) 表示在 \(n^{\mathrm{th}}\) 时间步长的变量值，即在 \(t=t_n \dealcoloneq n k\) ，其中 \(k\) 是（固定）时间步长。因此，时间分解的正弦戈登方程的拆分表述成为 </p><p class="formulaDsp">
\begin{eqnarray*} \frac{u^n - u^{n-1}}{k} - \left[\theta v^n + (1-\theta) v^{n-1}\right] &amp;=&amp; 0,\\ \frac{v^n - v^{n-1}}{k} - \Delta\left[\theta u^n + (1-\theta) u^{n-1}\right] &amp;=&amp; -\sin\left[\theta u^n + (1-\theta) u^{n-1}\right]. \end{eqnarray*}
</p>
<p> 。</p>
<p>我们可以通过一点代数来简化后者。从第一个方程中排除 \(v^n\) 并重新排列，我们得到 </p><p class="formulaDsp">
\begin{eqnarray*} \left[ 1-k^2\theta^2\Delta \right] u^n &amp;=&amp; \left[ 1+k^2\theta(1-\theta)\Delta\right] u^{n-1} + k v^{n-1} - k^2\theta\sin\left[\theta u^n + (1-\theta) u^{n-1}\right],\\ v^n &amp;=&amp; v^{n-1} + k\Delta\left[ \theta u^n + (1-\theta) u^{n-1}\right] - k\sin\left[ \theta u^n + (1-\theta) u^{n-1} \right]. \end{eqnarray*}
</p>
<p> 。</p>
<p>在这一点上，我们似乎可以直接对方程进行空间离散。虽然这对第二个方程（在 \(v^n\) 中是线性的）来说是正确的，但这对所有的 \(\theta\) 来说是不可行的，因为上面的第一个方程是非线性的。因此，必须实现一个非线性求解器，然后可以将方程在空间中离散化并求解。</p>
<p>为此，我们可以使用牛顿方法。给定非线性方程 \(F(u^n) = 0\) ，我们对 \(u^n\) 产生连续的近似值，如下。 </p><p class="formulaDsp">
\begin{eqnarray*} \mbox{ Find } \delta u^n_l \mbox{ s.t. } F&#39;(u^n_l)\delta u^n_l = -F(u^n_l) \mbox{, set } u^n_{l+1} = u^n_l + \delta u^n_l. \end{eqnarray*}
</p>
<p> 迭代可以用旧的时间步长进行初始化，即 \(u^n_0 = u^{n-1}\) ，最终会产生分裂公式的第一个方程的解（见上文）。对于这里所考虑的正弦戈登方程的时间离散化，我们有 </p><p class="formulaDsp">
\begin{eqnarray*} F(u^n_l) &amp;=&amp; \left[ 1-k^2\theta^2\Delta \right] u^n_l - \left[ 1+k^2\theta(1-\theta)\Delta\right] u^{n-1} - k v^{n-1} + k^2\theta\sin\left[\theta u^n_l + (1-\theta) u^{n-1}\right],\\ F&#39;(u^n_l) &amp;=&amp; 1-k^2\theta^2\Delta + k^2\theta^2\cos\left[\theta u^n_l + (1-\theta) u^{n-1}\right]. \end{eqnarray*}
</p>
<p> 注意，虽然 \(F(u^n_l)\) 是一个函数，但 \(F&#39;(u^n_l)\) 是一个算子。</p>
<p><a class="anchor" id="Weakformulationofthetimediscretizedequations"></a></p><h3>Weak formulation of the time-discretized equations</h3>
<p>事后看来，我们选择的解决方案和测试空间都是 \(H^1(\Omega)\) 。因此，乘以测试函数 \(\varphi\) 并进行积分，我们得到每个时间步长的分裂公式（包括第一个方程的非线性求解器）的以下变分（或弱）公式。 </p><p class="formulaDsp">
\begin{eqnarray*} &amp;\mbox{ Find}&amp; \delta u^n_l \in H^1(\Omega) \mbox{ s.t. } \left( F&#39;(u^n_l)\delta u^n_l, \varphi \right)_{\Omega} = -\left(F(u^n_l), \varphi \right)_{\Omega} \;\forall\varphi\in H^1(\Omega), \mbox{ set } u^n_{l+1} = u^n_l + \delta u^n_l,\; u^n_0 = u^{n-1}.\\ &amp;\mbox{ Find}&amp; v^n \in H^1(\Omega) \mbox{ s.t. } \left( v^n, \varphi \right)_{\Omega} = \left( v^{n-1}, \varphi \right)_{\Omega} - k\theta\left( \nabla u^n, \nabla\varphi \right)_{\Omega} - k (1-\theta)\left( \nabla u^{n-1}, \nabla\varphi \right)_{\Omega} - k\left(\sin\left[ \theta u^n + (1-\theta) u^{n-1} \right], \varphi \right)_{\Omega} \;\forall\varphi\in H^1(\Omega). \end{eqnarray*}
</p>
<p>注意，我们在涉及拉普拉斯算子的所有项上使用了分项积分和零诺依曼边界条件。此外， \(F(\cdot)\) 和 \(F&#39;(\cdot)\) 如上定义， \((\cdot,\cdot)_{\Omega}\) 表示域 \(\Omega\) 上通常的 \(L^2\) 内积，即 \((f,g)_{\Omega} = \int_\Omega fg \,\mathrm{d}x\) 。最后，注意到第一个方程实际上是一个迭代程序的定义，所以它在每个时间步骤中被多次求解，直到满足一个停止标准。</p>
<p><a class="anchor" id="Discretizationoftheweakformulationinspace"></a></p><h3>Discretization of the weak formulation in space</h3>
<p>使用有限元法，我们将变量公式在空间中离散化。为此，让 \(V_h\) 是一个具有节点基 \(\{\varphi_1,\ldots,\varphi_N\}\) 的有限维 \(H^1(\Omega)\) -符合的有限元空间（ \(\mathrm{dim}\, V_h = N &lt; \infty\) ）。现在，我们可以用节点基来展开弱公式（见上文）中的所有函数。此后，我们将用大写字母表示一个函数的系数向量（在节点基中），用小写字母表示；例如， \(u^n = \sum_{i=1}^N U^n_i \varphi_i\) 其中 \(U^n \in {R}^N\) 和 \(u^n \in H^1(\Omega)\) 。因此，变量公式的有限维版本要求我们在每个时间步长上解决以下矩阵方程。 </p><p class="formulaDsp">
\begin{eqnarray*} F_h&#39;(U^{n,l})\delta U^{n,l} &amp;=&amp; -F_h(U^{n,l}), \qquad U^{n,l+1} = U^{n,l} + \delta U^{n,l}, \qquad U^{n,0} = U^{n-1}; \\ MV^n &amp;=&amp; MV^{n-1} - k \theta AU^n -k (1-\theta) AU^{n-1} - k S(u^n,u^{n-1}). \end{eqnarray*}
</p>
<p>以上，矩阵 \(F_h&#39;(\cdot)\) 和向量 \(F_h(\cdot)\) 表示上面讨论的小工具的离散版本，即 </p><p class="formulaDsp">
\begin{eqnarray*} F_h(U^{n,l}) &amp;=&amp; \left[ M+k^2\theta^2A \right] U^{n,l} - \left[ M-k^2\theta(1-\theta)A \right] U^{n-1} - k MV^{n-1} + k^2\theta S(u^n_l, u^{n-1}),\\ F_h&#39;(U^{n,l}) &amp;=&amp; M+k^2\theta^2A + k^2\theta^2N(u^n_l,u^{n-1}) \end{eqnarray*}
</p>
<p> 再次注意，上面的第一个矩阵方程实际上是迭代程序的定义，所以它被多次解决，直到满足停止标准。此外， \(M\) 是质量矩阵，即 \(M_{ij} = \left( \varphi_i,\varphi_j \right)_{\Omega}\) ， \(A\) 是拉普拉斯矩阵，即 \(A_{ij} = \left( \nabla \varphi_i, \nabla \varphi_j \right)_{\Omega}\) ， \(S\) 是定义我们的辅助速度变量的方程中的非线性项，即 \(S_j(f,g) = \left( \sin\left[ \theta f + (1-\theta) g\right], \varphi_j \right)_{\Omega}\) ， \(N\) 是 \(F(\cdot)\) 的雅各布矩阵中的非线性项，即 \(N_{ij}(f,g) = \left( \cos\left[ \theta f + (1-\theta) g\right]\varphi_i, \varphi_j \right)_{\Omega}\) 。</p>
<p>对于第一个方程，我们可以用什么解法？让我们来看看我们必须反转的矩阵。 </p><p class="formulaDsp">
\[ (M+k^2\theta^2(A + N))_{ij} = \int_\Omega (1+k^2\theta^2 \cos \alpha) \varphi_i\varphi_j \; dx + k^2 \theta^2 \int_\Omega \nabla\varphi_i\nabla\varphi_j \; dx, \]
</p>
<p>为一些 \(\alpha\) ，这取决于现在和以前的解法。首先，请注意，该矩阵是对称的。此外，如果时间步长 \(k\) 足够小，即如果 \(k\theta&lt;1\) ，那么该矩阵也将是正定的。在下面的程序中，情况总是这样的，所以我们将使用共轭梯度法和SSOR法作为预处理。然而，我们应该记住，如果我们碰巧使用更大的时间步长，这将失败。幸运的是，在这种情况下，求解器将只是抛出一个异常，表明收敛失败，而不是默默地产生一个错误的结果。如果发生这种情况，那么我们可以简单地用能够处理不确定对称系统的方法取代CG方法。GMRES求解器通常是处理所有 "坏 "线性系统的标准方法，但它也是一个缓慢的方法。可能更好的是利用对称性的求解器，例如，SymmLQ，它也在deal.II中实现。</p>
<p>这个程序对 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">@ref step_24 </a>step-24" "进行了巧妙的优化：如果你仔细阅读上述公式，就会发现，速度 \(V\) 只出现在与质量矩阵的乘积中。因此，在 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 中，我们有点浪费：在每个时间步骤中，我们将用质量矩阵求解一个线性系统，只是在下一个时间步骤中再次将该系统的解乘以 \(M\) 。当然，这是可以避免的，我们在这个程序中就是这样做的。</p>
<p><a class="anchor" id="Thetestcase"></a></p><h3>The test case</h3>
<p>正弦戈登方程有几个分析解，包括一维和二维的。特别是，本程序是计算一个具有单一激波状孤波初始条件的问题的解。 这个解是由Leibbrandt在Phys.Rev.Lett.中给出的。<b>41</b>(7)中给出，并在 <code>ExactSolution</code> 类中实现。</p>
<p>需要注意的是，严格来说，这个闭式解法只对无限空间的初值问题成立（而不是这里考虑的诺伊曼初值问题）。然而，鉴于我们施加了零诺依曼边界条件，我们期望我们的初始边界值问题的解将接近无限空间初始值问题的解，如果波在我们领域的边界上的反射没有发生。在实践中，情况当然不是这样的，但我们至少可以假设是这样的。</p>
<p>二维解决方案中的常数 \(\vartheta\) 和 \(\lambda\) 以及三维解决方案中的 \(\vartheta\) 、 \(\phi\) 和 \(\tau\) 被称为B&auml;cklund变换参数。它们控制诸如扭结的方向和陡度。为了测试代码与精确解的对比，我们应该选择这些参数，使扭结与网格保持一致。</p>
<p>我们在 <code>ExactSolution</code> 类中实现的解决方案是这些。 </p><ul>
<li>
<p class="startli">在一维中： </p><p class="formulaDsp">
\[ u(x,t) = -4 \arctan\left[ \frac{m}{\sqrt{1-m^2}} \frac{\sin\left(\sqrt{1-m^2}t+c_2\right)} {\cosh\left(mx+c_1\right)} \right], \]
</p>
<p> 其中我们选择 \(m=\frac 12, c_1=c_2=0\) 。</p>
<p class="interli">在一维中，更多有趣的分析解是已知的。他们中的许多人被列在http://mathworld.wolfram.com/Sine-GordonEquation.html 。</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">在二维： </p><p class="formulaDsp">
\[ u(x,y,t) = 4 \arctan \left[a_0 e^{s\xi}\right], \]
</p>
<p> 其中 \(\xi\) 定义为 </p><p class="formulaDsp">
\[ \xi = x \cos\vartheta + \sin(\vartheta) (y\cosh\lambda + t\sinh \lambda), \]
</p>
<p>，我们选择 \(\vartheta=\frac \pi 4, \lambda=a_0=s=1\) 。</p>
<p class="endli"></p>
</li>
<li>
在三维中： <p class="formulaDsp">
\[ u(x,y,z,t) = 4 \arctan \left[c_0 e^{s\xi}\right], \]
</p>
 其中 \(\xi\) 被定义为 <p class="formulaDsp">
\[ \xi = x \cos\vartheta + y \sin \vartheta \cos\phi + \sin \vartheta \sin\phi (z\cosh\tau + t\sinh \tau), \]
</p>
，我们选择 \(\vartheta=\phi=\frac{\pi}{4}, \tau=c_1=s=1\) . </li>
</ul>
<p>因为这样更容易发挥，用于设置&mdash;惊喜！&mdash;我们模拟的初始值的 <code>InitialValues</code> 类只是查询描述初始时值的精确解的类，而不是重复实现一个解函数。<a class="anchor" id="CommProg"></a></p><h1>The commented program</h1>
<p><a class="anchor" id="Includefilesandglobalvariables"></a></p><h3>Include files and global variables</h3>
<p>关于include文件的解释，读者应该参考示例程序 <a class="el" href="step_1.html">step-1</a> 到 <a class="el" href="step_4.html">step-4</a> 。它们的标准顺序是 <code>base</code> &ndash; <code>lac</code> &ndash; <code>grid</code> &ndash; <code>dofs</code> &ndash; <code>fe</code> &ndash; <code>numerics</code> （因为每一类大致都是建立在前面的基础上），然后是一些用于文件输入/输出和字符串流的C++头文件。</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dynamic__sparsity__pattern_8h.html">deal.II/lac/dynamic_sparsity_pattern.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="ttc" id="aaffine__constraints_8h_html"><div class="ttname"><a href="affine__constraints_8h.html">affine_constraints.h</a></div></div>
<div class="ttc" id="adof__tools_8h_html"><div class="ttname"><a href="dof__tools_8h.html">dof_tools.h</a></div></div>
<div class="ttc" id="adofs_2dof__handler_8h_html"><div class="ttname"><a href="dofs_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="adynamic__sparsity__pattern_8h_html"><div class="ttname"><a href="dynamic__sparsity__pattern_8h.html">dynamic_sparsity_pattern.h</a></div></div>
<div class="ttc" id="afe_2fe__values_8h_html"><div class="ttname"><a href="fe_2fe__values_8h.html">fe_values.h</a></div></div>
<div class="ttc" id="afe__q_8h_html"><div class="ttname"><a href="fe__q_8h.html">fe_q.h</a></div></div>
<div class="ttc" id="afull__matrix_8h_html"><div class="ttname"><a href="full__matrix_8h.html">full_matrix.h</a></div></div>
<div class="ttc" id="afunction_8h_html"><div class="ttname"><a href="function_8h.html">function.h</a></div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="agrid__generator_8h_html"><div class="ttname"><a href="grid__generator_8h.html">grid_generator.h</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="amatrix__tools_8h_html"><div class="ttname"><a href="matrix__tools_8h.html">matrix_tools.h</a></div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="aprecondition_8h_html"><div class="ttname"><a href="precondition_8h.html">precondition.h</a></div></div>
<div class="ttc" id="aquadrature__lib_8h_html"><div class="ttname"><a href="quadrature__lib_8h.html">quadrature_lib.h</a></div></div>
<div class="ttc" id="asolver__cg_8h_html"><div class="ttname"><a href="solver__cg_8h.html">solver_cg.h</a></div></div>
<div class="ttc" id="asparse__matrix_8h_html"><div class="ttname"><a href="sparse__matrix_8h.html">sparse_matrix.h</a></div></div>
<div class="ttc" id="avector_8h_html"><div class="ttname"><a href="vector_8h.html">vector.h</a></div></div>
<div class="ttc" id="avector__tools_8h_html"><div class="ttname"><a href="vector__tools_8h.html">vector_tools.h</a></div></div>
</div><!-- fragment --><p>最后一步和以前的所有程序一样。</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>Step25</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="namespace__dealii_8h_source.html#l00025">namespace_dealii.h:26</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="ThecodeSineGordonProblemcodeclasstemplate"></a></p><h3>The <code>SineGordonProblem</code> class template</h3>
<p>整个解决问题的算法被封装在这个类中。和以前的例子程序一样，这个类在声明时有一个模板参数，就是空间维度，这样我们就可以在一个、两个或三个空间维度上求解正弦-戈登方程。关于问题的独立于维度的类封装的更多信息，读者应该参考 <a class="el" href="step_3.html">step-3</a> 和 <a class="el" href="step_4.html">step-4</a> 。 <br  />
</p>
<p>与 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 相比，在程序的一般结构中没有任何有价值的东西（当然，在各种函数的内部运作中也有！）。最明显的区别是出现了两个新的函数 <code>compute_nl_term</code> 和 <code>compute_nl_matrix</code> ，计算系统矩阵的非线性贡献和第一个方程的右手边，正如在介绍中讨论的那样。此外，我们必须有一个向量 <code>solution_update</code> ，它包含在每个牛顿步骤中对解向量的非线性更新。 <br  />
</p>
<p>正如介绍中也提到的，我们在这个程序中不存储速度变量，而是质量矩阵乘以速度。这是在 <code>M_x_velocity</code> 变量中完成的（"x "是代表 "次数"）。 <br  />
</p>
<p>最后， <code>output_timestep_skip</code> 变量存储了在生成图形输出之前每次所需的时间步数。这一点在使用细网格（因此也是小的时间步数）时非常重要，在这种情况下，我们会运行大量的时间步数，并创建大量的输出文件，这些文件中的解看起来几乎是一样的。这只会堵塞我们的可视化程序，我们应该避免创建比我们真正感兴趣的更多的输出。因此，如果这个变量被设置为大于1的值 \(n\) ，那么只有在每一个 \(n\) 的时间步长才会产生输出。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>SineGordonProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  SineGordonProblem();</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span>         make_grid_and_dofs();</div>
<div class="line">  <span class="keywordtype">void</span>         assemble_system();</div>
<div class="line">  <span class="keywordtype">void</span>         compute_nl_term(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                               <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                               <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;      nl_term) <span class="keyword">const</span>;</div>
<div class="line">  <span class="keywordtype">void</span>         compute_nl_matrix(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                                 <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                                 <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> &amp;nl_matrix) <span class="keyword">const</span>;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> solve();</div>
<div class="line">  <span class="keywordtype">void</span>         output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line">  <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>          fe;</div>
<div class="line">  <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>    dof_handler;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classSparsityPattern.html">SparsityPattern</a>      sparsity_pattern;</div>
<div class="line">  <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line">  <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>;</div>
<div class="line">  <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> laplace_matrix;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_global_refinements;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span>       time;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> final_time, time_step;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> theta;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> solution, solution_update, old_solution;</div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> M_x_velocity;</div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> system_rhs;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> output_timestep_skip;</div>
<div class="line">};</div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00314">dof_handler.h:315</a></div></div>
<div class="ttc" id="aclassFE__Q_html"><div class="ttname"><a href="classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__q_8h_source.html#l00548">fe_q.h:549</a></div></div>
<div class="ttc" id="aclassSparseMatrix_html"><div class="ttname"><a href="classSparseMatrix.html">SparseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="sparsity__pattern_8h_source.html#l00868">sparsity_pattern.h:869</a></div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l01127">tria.h:1128</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1L2_html_a1c15243765304a803037988b5561627d"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">LocalIntegrators::L2::mass_matrix</a></div><div class="ttdeci">void mass_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00058">l2.h:58</a></div></div>
<div class="ttc" id="anamespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00691">work_stream.h:691</a></div></div>
<div class="ttc" id="ap4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Initialconditions"></a> </p><h3>Initial conditions</h3>
<p>在下面两类中，我们首先实现本程序介绍中提到的一维、二维和三维的精确解。如果想通过比较数值解和分析解来测试程序的准确性，这个时空解可能会有独立的意义（但是请注意，程序使用的是有限域，而这些是无界域的分析解）。例如，这可以用 <a class="el" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a> 函数来完成。再次注意（正如在 <a class="el" href="step_23.html">step-23</a> 中已经讨论过的），我们如何将时空函数描述为依赖于时间变量的空间函数，该变量可以使用FunctionTime基类中的 <a class="el" href="classFunctionTime.html#a3a583fd8f30db3549dbaa43b2592e2bc">FunctionTime::set_time()</a> 和 <a class="el" href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">FunctionTime::get_time()</a> 成员函数来设置和查询。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  ExactSolution(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components = 1, <span class="keyword">const</span> <span class="keywordtype">double</span> time = 0.)</div>
<div class="line">    : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;(n_components, time)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div>
<div class="line">                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="comment">/*component*/</span> = 0)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">get_time</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (dim)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> m  = 0.5;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = 0.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> c2 = 0.;</div>
<div class="line">            <span class="keywordflow">return</span> -4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(m / std::sqrt(1. - m * m) *</div>
<div class="line">                                   std::sin(std::sqrt(1. - m * m) * t + c2) /</div>
<div class="line">                                   <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(m * p[0] + c1));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> theta  = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__Exceptions.html#gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> a0     = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> s      = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> arg    = p[0] * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta) +</div>
<div class="line">                               <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * (p[1] * <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(lambda) +</div>
<div class="line">                                                  t * <a class="code" href="namespaceDifferentiation_1_1SD.html#a766e4d9bbfe24e99245081947db6a0c7">std::sinh</a>(lambda));</div>
<div class="line">            <span class="keywordflow">return</span> 4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(a0 * std::exp(s * arg));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> theta = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> phi   = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> tau   = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> c0    = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> s     = 1.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> arg   = p[0] * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta) +</div>
<div class="line">                               p[1] * <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(phi) +</div>
<div class="line">                               <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(phi) *</div>
<div class="line">                                 (p[2] * <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(tau) + t * <a class="code" href="namespaceDifferentiation_1_1SD.html#a766e4d9bbfe24e99245081947db6a0c7">std::sinh</a>(tau));</div>
<div class="line">            <span class="keywordflow">return</span> 4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(c0 * std::exp(s * arg));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> -1e8;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="aclassFunctionTime_html_ae7d37ddb04314b38cf67c6cba22923f6"><div class="ttname"><a href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">FunctionTime&lt; numbers::NumberTraits&lt; double &gt;::real_type &gt;::get_time</a></div><div class="ttdeci">numbers::NumberTraits&lt; double &gt;::real_type get_time() const</div></div>
<div class="ttc" id="aclassFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00150">function.h:153</a></div></div>
<div class="ttc" id="aclassFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2point_8h_source.html#l00110">point.h:111</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01473">exceptions.h:1473</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="agroup__Exceptions_html_gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c"><div class="ttname"><a href="group__Exceptions.html#gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">Differentiation::SD::OptimizerType::lambda</a></div><div class="ttdeci">@ lambda</div></div>
<div class="ttc" id="anamespaceDifferentiation_1_1SD_html_a26c1f7a69dc8ac2e16144493d3b3b896"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">Differentiation::SD::cosh</a></div><div class="ttdeci">Expression cosh(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00189">symengine_math.cc:189</a></div></div>
<div class="ttc" id="anamespaceDifferentiation_1_1SD_html_a766e4d9bbfe24e99245081947db6a0c7"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a766e4d9bbfe24e99245081947db6a0c7">Differentiation::SD::sinh</a></div><div class="ttdeci">Expression sinh(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00182">symengine_math.cc:182</a></div></div>
<div class="ttc" id="anamespaceDifferentiation_1_1SD_html_a803fcea270d7a523a91e3b7c173059f9"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">Differentiation::SD::atan</a></div><div class="ttdeci">Expression atan(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00147">symengine_math.cc:147</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00231">numbers.h:231</a></div></div>
<div class="ttc" id="anumbers_8h_html_a02761f62f66f685e954daed42bcb3a1b"><div class="ttname"><a href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; cos(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05318">vectorization.h:5318</a></div></div>
<div class="ttc" id="anumbers_8h_html_a27989bdc7b4b828564982787d126bd91"><div class="ttname"><a href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05291">vectorization.h:5291</a></div></div>
</div><!-- fragment --><p>在本节的第二部分，我们提供初始条件。我们很懒惰（也很谨慎），不想第二次实现与上面相同的函数。相反，如果我们被询问初始条件，我们创建一个对象 <code>ExactSolution</code> ，将其设置为正确的时间，并让它计算当时精确解的任何值。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>InitialValues : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  InitialValues(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components = 1, <span class="keyword">const</span> <span class="keywordtype">double</span> time = 0.)</div>
<div class="line">    : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;(n_components, time)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div>
<div class="line">                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">return</span> ExactSolution&lt;dim&gt;(1, this-&gt;<a class="code" href="classFunctionTime.html#ae7d37ddb04314b38cf67c6cba22923f6">get_time</a>()).value(p, component);</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="ImplementationofthecodeSineGordonProblemcodeclass"></a> </p><h3>Implementation of the <code>SineGordonProblem</code> class</h3>
<p>让我们继续讨论主类的实现，因为它实现了介绍中概述的算法。</p>
<p><a class="anchor" id="SineGordonProblemSineGordonProblem"></a></p><h4>SineGordonProblem::SineGordonProblem</h4>
<p>这是 <code>SineGordonProblem</code> 类的构造函数。它指定了所需的有限元的多项式程度，关联了一个 <code><a class="el" href="classDoFHandler.html">DoFHandler</a></code> to the <code>triangulation</code> 对象（就像在示例程序 <a class="el" href="step_3.html">step-3</a> 和 <a class="el" href="step_4.html">step-4</a> 中一样），初始化了当前或初始时间，最终时间，时间步长，以及用于时间步长方案的 \(\theta\) 值。由于我们在这里计算的解是时间周期性的，所以开始时间的实际值并不重要，我们选择它是为了让我们在一个有趣的时间开始。 <br  />
</p>
<p>请注意，如果我们选择显式欧拉时间步进方案（ \(\theta = 0\) ），那么我们必须选择一个时间步长 \(k \le h\) ，否则该方案不稳定，解中可能出现振荡。Crank-Nicolson方案（ \(\theta = \frac{1}{2}\) ）和隐式Euler方案（ \(\theta=1\) ）不存在这个缺陷，因为它们是无条件稳定的。然而，即使如此，时间步长也应选择在 \(h\) 的数量级上，以获得一个好的解决方案。由于我们知道我们的网格是由矩形的均匀细分而来，我们可以很容易地计算出这个时间步长；如果我们有一个不同的域， <a class="el" href="step_24.html">step-24</a> 中的技术使用 <a class="el" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a> 也是可以的。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">SineGordonProblem&lt;dim&gt;::SineGordonProblem()</div>
<div class="line">  : fe(1)</div>
<div class="line">  , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div>
<div class="line">  , n_global_refinements(6)</div>
<div class="line">  , time(-5.4414)</div>
<div class="line">  , final_time(2.7207)</div>
<div class="line">  , time_step(10 * 1. / std::<a class="code" href="classVectorizedArray.html#a88a75c587436aef435bd528ab65ac3fe">pow</a>(2., 1. * n_global_refinements))</div>
<div class="line">  , theta(0.5)</div>
<div class="line">  , output_timestep_skip(1)</div>
<div class="line">{}</div>
<div class="ttc" id="aclassVectorizedArray_html_a88a75c587436aef435bd528ab65ac3fe"><div class="ttname"><a href="classVectorizedArray.html#a88a75c587436aef435bd528ab65ac3fe">VectorizedArray::pow</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const Number p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05422">vectorization.h:5422</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemmake_grid_and_dofs"></a> </p><h4>SineGordonProblem::make_grid_and_dofs</h4>
<p>这个函数在 <code>dim</code> 维度上创建一个矩形网格，并对其进行多次细化。同时，一旦自由度被组装起来， <code>SineGordonProblem</code> 类的所有矩阵和向量成员都被初始化为它们适当的大小。像 <a class="el" href="step_24.html">step-24</a> 一样，我们使用 <code><a class="el" href="namespaceMatrixCreator.html">MatrixCreator</a></code> 函数来生成质量矩阵 \(M\) 和拉普拉斯矩阵 \(A\) ，并在程序的剩余时间里将它们存储在适当的变量中。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, -10, 10);</div>
<div class="line">  <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(n_global_refinements);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div>
<div class="line">            &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;   Total number of cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_cells()</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  dof_handler.distribute_dofs(fe);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(), dof_handler.n_dofs());</div>
<div class="line">  <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp);</div>
<div class="line">  sparsity_pattern.copy_from(dsp);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  system_matrix.reinit(sparsity_pattern);</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.reinit(sparsity_pattern);</div>
<div class="line">  laplace_matrix.reinit(sparsity_pattern);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a>(dof_handler,</div>
<div class="line">                                    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                                    <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div>
<div class="line">  <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a>(dof_handler,</div>
<div class="line">                                       <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                                       laplace_matrix);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  solution.reinit(dof_handler.n_dofs());</div>
<div class="line">  solution_update.reinit(dof_handler.n_dofs());</div>
<div class="line">  old_solution.reinit(dof_handler.n_dofs());</div>
<div class="line">  M_x_velocity.reinit(dof_handler.n_dofs());</div>
<div class="line">  system_rhs.reinit(dof_handler.n_dofs());</div>
<div class="line">}</div>
<div class="ttc" id="aclassDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00318">dynamic_sparsity_pattern.h:319</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00038">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="agroup__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceMatrixCreator_html_a7b8157122064151d414dc34a22a3ca9c"><div class="ttname"><a href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a></div><div class="ttdeci">void create_laplace_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; double &gt; &amp;matrix, const Function&lt; spacedim &gt; *const a=nullptr, const AffineConstraints&lt; double &gt; &amp;constraints=AffineConstraints&lt; double &gt;())</div></div>
<div class="ttc" id="anamespaceMatrixCreator_html_aab6397f114af66efd781f7f4daba22be"><div class="ttname"><a href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a></div><div class="ttdeci">void create_mass_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; number &gt; &amp;matrix, const Function&lt; spacedim, number &gt; *const a=nullptr, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;())</div></div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemassemble_system"></a> </p><h4>SineGordonProblem::assemble_system</h4>
<p>这个函数为牛顿方法的每次迭代组装系统矩阵和右手向量。关于系统矩阵和右手边的明确公式，读者应参考导论。 <br  />
</p>
<p>请注意，在每个时间步骤中，我们必须把对矩阵和右手边的各种贡献加起来。与 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 相比，这需要集合更多的条款，因为它们取决于前一个时间步骤或前一个非线性步骤的解决方案。我们使用函数 <code>compute_nl_matrix</code> 和 <code>compute_nl_term</code> 来做到这一点，而本函数提供了顶层逻辑。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::assemble_system()</div>
<div class="line">{</div>
</div><!-- fragment --><p>首先，我们组装雅各布矩阵 \(F&#39;_h(U^{n,l})\) ，其中 \(U^{n,l}\) 为方便起见被存储在向量 <code>solution</code> 中。</p>
<div class="fragment"><div class="line">system_matrix.copy_from(<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div>
<div class="line">system_matrix.add(std::pow(time_step * theta, 2), laplace_matrix);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> tmp_matrix(sparsity_pattern);</div>
<div class="line">compute_nl_matrix(old_solution, solution, tmp_matrix);</div>
<div class="line">system_matrix.add(std::pow(time_step * theta, 2), tmp_matrix);</div>
</div><!-- fragment --><p>接下来我们计算右手边的向量。这只是介绍中对 \(-F_h(U^{n,l})\) 的描述所暗示的矩阵-向量乘积的组合。</p>
<div class="fragment"><div class="line">  system_rhs = 0.;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> tmp_vector(solution.size());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(system_rhs, solution);</div>
<div class="line">  laplace_matrix.vmult(tmp_vector, solution);</div>
<div class="line">  system_rhs.add(std::pow(time_step * theta, 2), tmp_vector);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(tmp_vector, old_solution);</div>
<div class="line">  system_rhs.add(-1.0, tmp_vector);</div>
<div class="line">  laplace_matrix.vmult(tmp_vector, old_solution);</div>
<div class="line">  system_rhs.add(std::pow(time_step, 2) * theta * (1 - theta), tmp_vector);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  system_rhs.add(-time_step, M_x_velocity);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  compute_nl_term(old_solution, solution, tmp_vector);</div>
<div class="line">  system_rhs.add(std::pow(time_step, 2) * theta, tmp_vector);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  system_rhs *= -1.;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemcompute_nl_term"></a> </p><h4>SineGordonProblem::compute_nl_term</h4>
<p>这个函数计算向量 \(S(\cdot,\cdot)\) ，它出现在分裂公式的两个方程的非线性项中。这个函数不仅简化了这个项的重复计算，而且也是我们在时间步长为隐式时使用的非线性迭代求解器的一个基本部分（即 \(\theta\ne 0\) ）。此外，我们必须允许该函数接收一个 "旧 "和一个 "新 "的解决方案作为输入。这些可能不是存储在 <code>old_solution</code> and <code>solution</code> 中的问题的实际解决方案，而只是我们线性化的两个函数。为了这个函数的目的，让我们在下面这个类的文档中分别调用前两个参数 \(w_{\mathrm{old}}\) 和 \(w_{\mathrm{new}}\) 。 <br  />
</p>
<p>作为题外话，也许值得研究一下什么阶数的正交公式最适合于这种类型的积分。由于 \(\sin(\cdot)\) 不是一个多项式，可能没有正交公式可以准确地积分这些项。通常只需确保右手边的积分达到离散化方案的相同精度即可，但也可能通过选择更精确的正交公式来改善收敛性渐近声明中的常数。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::compute_nl_term(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                                             <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                                             <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;nl_term)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  nl_term = 0;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 1);</div>
<div class="line">  <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>     fe_values(fe,</div>
<div class="line">                          quadrature_formula,</div>
<div class="line">                          <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> |</div>
<div class="line">                            <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a>                       local_nl_term(dofs_per_cell);</div>
<div class="line">  std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div>
<div class="line">  std::vector&lt;double&gt;                  old_data_values(n_q_points);</div>
<div class="line">  std::vector&lt;double&gt;                  new_data_values(n_q_points);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      local_nl_term = 0;</div>
<div class="ttc" id="aclassFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l03905">fe_values.h:3906</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00078">fe_update_flags.h:78</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00129">fe_update_flags.h:129</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00122">fe_update_flags.h:122</a></div></div>
</div><!-- fragment --><p>一旦我们将 <code><a class="el" href="classFEValues.html">FEValues</a></code> 实例化重新初始化到当前单元，我们就利用 <code>get_function_values</code> 例程来获取所选正交公式节点上的 "旧 "数据（大概在 \(t=t_{n-1}\) ）和 "新 "数据（大概在 \(t=t_n\) ）的值。</p>
<div class="fragment"><div class="line">fe_values.reinit(cell);</div>
<div class="line">fe_values.get_function_values(old_data, old_data_values);</div>
<div class="line">fe_values.get_function_values(new_data, new_data_values);</div>
</div><!-- fragment --><p>现在，我们可以使用所需的正交公式评估 \(\int_K \sin\left[\theta w_{\mathrm{new}} + (1-\theta) w_{\mathrm{old}}\right] \,\varphi_j\,\mathrm{d}x\) 。</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">    local_nl_term(i) +=</div>
<div class="line">      (<a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta * new_data_values[q_point] +</div>
<div class="line">                (1 - theta) * old_data_values[q_point]) *</div>
<div class="line">       fe_values.shape_value(i, q_point) * fe_values.JxW(q_point));</div>
</div><!-- fragment --><p>最后，我们将各单元上的积分对全局积分的贡献相加。</p>
<div class="fragment"><div class="line">      cell-&gt;get_dof_indices(local_dof_indices);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">        nl_term(local_dof_indices[i]) += local_nl_term(i);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemcompute_nl_matrix"></a></p><h4>SineGordonProblem::compute_nl_matrix</h4>
<p>这是处理非线性方案的第二个函数。它计算矩阵 \(N(\cdot,\cdot)\) ，它出现在 \(F(\cdot)\) 的雅各布项的非线性项中。正如 <code>compute_nl_term</code> 一样，我们必须让这个函数接收一个 "旧 "和一个 "新 "的解决方案作为输入，下面我们再次分别称之为 \(w_{\mathrm{old}}\) 和 \(w_{\mathrm{new}}\) 。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::compute_nl_matrix(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">  <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> &amp;nl_matrix)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>   quadrature_formula(fe.degree + 1);</div>
<div class="line">  <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div>
<div class="line">                          quadrature_formula,</div>
<div class="line">                          <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> |</div>
<div class="line">                            <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> local_nl_matrix(dofs_per_cell, dofs_per_cell);</div>
<div class="line">  std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div>
<div class="line">  std::vector&lt;double&gt;                  old_data_values(n_q_points);</div>
<div class="line">  std::vector&lt;double&gt;                  new_data_values(n_q_points);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      local_nl_matrix = 0;</div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
</div><!-- fragment --><p>同样，首先我们将我们的 <code><a class="el" href="classFEValues.html">FEValues</a></code> 实例化重新初始化为当前单元格。</p>
<div class="fragment"><div class="line">fe_values.reinit(cell);</div>
<div class="line">fe_values.get_function_values(old_data, old_data_values);</div>
<div class="line">fe_values.get_function_values(new_data, new_data_values);</div>
</div><!-- fragment --><p>然后，我们使用所需的正交公式评估 \(\int_K \cos\left[\theta w_{\mathrm{new}} + (1-\theta) w_{\mathrm{old}}\right]\, \varphi_i\, \varphi_j\,\mathrm{d}x\) 。</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div>
<div class="line">      local_nl_matrix(i, j) +=</div>
<div class="line">        (<a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta * new_data_values[q_point] +</div>
<div class="line">                  (1 - theta) * old_data_values[q_point]) *</div>
<div class="line">         fe_values.shape_value(i, q_point) *</div>
<div class="line">         fe_values.shape_value(j, q_point) * fe_values.JxW(q_point));</div>
</div><!-- fragment --><p>最后，我们将各单元的积分贡献加到全局积分上。</p>
<div class="fragment"><div class="line">      cell-&gt;get_dof_indices(local_dof_indices);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div>
<div class="line">          nl_matrix.<a class="code" href="classSparseMatrix.html#acabf7629046afdd9077f77f7746a7a3f">add</a>(local_dof_indices[i],</div>
<div class="line">                        local_dof_indices[j],</div>
<div class="line">                        local_nl_matrix(i, j));</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclassSparseMatrix_html_acabf7629046afdd9077f77f7746a7a3f"><div class="ttname"><a href="classSparseMatrix.html#acabf7629046afdd9077f77f7746a7a3f">SparseMatrix::add</a></div><div class="ttdeci">void add(const size_type i, const size_type j, const number value)</div></div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemsolve"></a></p><h4>SineGordonProblem::solve</h4>
<p>正如在介绍中所讨论的，该函数使用CG迭代求解器对线性方程组进行求解，该方程组是由牛顿方法的每个迭代的有限元空间离散化产生的，用于求解分裂式的（非线性）第一个方程。该系统的解实际上是 \(\delta U^{n,l}\) ，所以它被存储在 <code>solution_update</code> and used to update <code>solution</code> 的 <code>run</code> 函数中。 <br  />
</p>
<p>请注意，我们在求解前将解的更新值重新设置为零。这是没有必要的：迭代求解器可以从任何一点开始并收敛到正确的解决方案。如果对线性系统的解有一个很好的估计，那么从这个向量开始可能是值得的，但是作为一个一般的观察，事实是起点并不重要：它必须是一个非常非常好的猜测，以减少超过几个迭代的次数。事实证明，对于这个问题，使用以前的非线性更新作为起点实际上会损害收敛性，并增加所需的迭代次数，所以我们简单地将其设置为零。 <br  />
</p>
<p>该函数返回收敛到一个解决方案所需的迭代次数。这个数字以后将被用来在屏幕上生成输出，显示每次非线性迭代需要多少次迭代。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> SineGordonProblem&lt;dim&gt;::solve()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12 * system_rhs.l2_norm());</div>
<div class="line">  <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div>
<div class="line">  preconditioner.<a class="code" href="group__Preconditioners.html#ga7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  cg.solve(system_matrix, solution_update, system_rhs, preconditioner);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> solver_control.last_step();</div>
<div class="line">}</div>
<div class="ttc" id="aclassPreconditionSSOR_html"><div class="ttname"><a href="classPreconditionSSOR.html">PreconditionSSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00650">precondition.h:651</a></div></div>
<div class="ttc" id="aclassSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00095">solver_cg.h:96</a></div></div>
<div class="ttc" id="aclassSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00065">solver_control.h:66</a></div></div>
<div class="ttc" id="agroup__Preconditioners_html_ga7a3d66b17bb0ea1b16606e222474c2ea"><div class="ttname"><a href="group__Preconditioners.html#ga7a3d66b17bb0ea1b16606e222474c2ea">PreconditionSSOR::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const typename BaseClass::AdditionalData &amp;parameters=typename BaseClass::AdditionalData())</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemoutput_results"></a> </p><h4>SineGordonProblem::output_results</h4>
<p>这个函数将结果输出到一个文件。它与 <a class="el" href="step_23.html">step-23</a> 和 <a class="el" href="step_24.html">step-24</a> 中的相应函数基本相同。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::output_results(</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a>(dof_handler);</div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(solution, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">  data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::string filename =</div>
<div class="line">    <span class="stringliteral">&quot;solution-&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(timestep_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">  <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> vtk_flags;</div>
<div class="line">  vtk_flags.<a class="code" href="group__Exceptions.html#ga3be0d6de1c92b770e8664bce2fc7c107">compression_level</a> =</div>
<div class="line">    DataOutBase::VtkFlags::ZlibCompressionLevel::best_speed;</div>
<div class="line">  data_out.<a class="code" href="group__Exceptions.html#gac7280a24690b117454acfb0fa058299c">set_flags</a>(vtk_flags);</div>
<div class="line">  std::ofstream output(filename);</div>
<div class="line">  data_out.<a class="code" href="group__Exceptions.html#ga93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(output);</div>
<div class="line">}</div>
<div class="ttc" id="aclassDataOut__DoFData_html_ac1eb26168177faa30ffbcf9cbb9c3cd5"><div class="ttname"><a href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandlerType &amp;)</div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_ace4b76e565ba0701c4d32c26075ed3b9"><div class="ttname"><a href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l01087">data_out_dof_data.h:1087</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00147">data_out.h:150</a></div></div>
<div class="ttc" id="aclassDataOut_html_a5eb51872b8736849bb7e8d2007fae086"><div class="ttname"><a href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01085">data_out.cc:1085</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga3be0d6de1c92b770e8664bce2fc7c107"><div class="ttname"><a href="group__Exceptions.html#ga3be0d6de1c92b770e8664bce2fc7c107">DataOutBase::VtkFlags::compression_level</a></div><div class="ttdeci">ZlibCompressionLevel compression_level</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01151">data_out_base.h:1151</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga93c780f93105e0daaa76c6c43694b4ae"><div class="ttname"><a href="group__Exceptions.html#ga93c780f93105e0daaa76c6c43694b4ae">DataOutInterface::write_vtu</a></div><div class="ttdeci">void write_vtu(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07188">data_out_base.cc:7188</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="group__Exceptions.html#gac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08166">data_out_base.cc:8166</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="astructDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01087">data_out_base.h:1088</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="SineGordonProblemrun"></a> </p><h4>SineGordonProblem::run</h4>
<p>这个函数对一切都有最高级别的控制：它运行（外部）时间步长循环，（内部）非线性求解器循环，并在每个时间步长后输出解。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">SineGordonProblem&lt;dim&gt;::run</a>()</div>
<div class="line">{</div>
<div class="line">  make_grid_and_dofs();</div>
</div><!-- fragment --><p>为了确认初始条件，我们必须使用函数 \(u_0(x)\) 来计算 \(U^0\) 。为此，下面我们将创建一个 <code>InitialValues</code> 类型的对象；注意，当我们创建这个对象（它来自 <code><a class="el" href="classFunction.html">Function</a></code> 类）时，我们将其内部时间变量设置为 \(t_0\) ，以表明初始条件是在 \(t=t_0\) 处评估的空间和时间函数。 <br  />
</p>
<p>然后我们通过使用 <code><a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></code> 将 \(u_0(x)\) 投影到网格上，产生 \(U^0\) 。我们必须使用与 <a class="el" href="step_21.html">step-21</a> 相同的悬挂节点约束结构： <a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a> 函数需要一个悬挂节点约束对象，但要使用它，我们首先需要关闭它。</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> constraints;</div>
<div class="line">  constraints.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
<div class="line">  <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>(dof_handler,</div>
<div class="line">                       constraints,</div>
<div class="line">                       <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                       InitialValues&lt;dim&gt;(1, time),</div>
<div class="line">                       solution);</div>
<div class="line">}</div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html_a1611aa37f754086388ca76bcd421cce5"><div class="ttname"><a href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">AffineConstraints::close</a></div><div class="ttdeci">void close()</div></div>
<div class="ttc" id="anamespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
</div><!-- fragment --><p>为了完整起见，我们像其他时间步骤一样，将第2个时间步骤输出到一个文件中。</p>
<div class="fragment"><div class="line">output_results(0);</div>
</div><!-- fragment --><p>现在我们进行时间步进：在每个时间步进中，我们解决与问题的有限元离散化相对应的矩阵方程，然后根据我们在介绍中讨论的时间步进公式推进我们的解决方案。</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 1;</div>
<div class="line"><span class="keywordflow">for</span> (time += time_step; time &lt;= final_time;</div>
<div class="line">     time += time_step, ++timestep_number)</div>
<div class="line">  {</div>
<div class="line">    old_solution = solution;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; std::endl</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Time step #&quot;</span> &lt;&lt; timestep_number &lt;&lt; <span class="stringliteral">&quot;; &quot;</span></div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;advancing to t = &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>在每个时间步长的开始，我们必须通过牛顿方法求解拆分公式中的非线性方程&mdash;即求解 \(\delta U^{n,l}\) ，然后计算 \(U^{n,l+1}\) ，依此类推。这种非线性迭代的停止标准是： \(\|F_h(U^{n,l})\|_2 \le 10^{-6} \|F_h(U^{n,0})\|_2\) 。因此，我们需要在第一次迭代中记录残差的规范。 <br  />
</p>
<p>在每次迭代结束时，我们向控制台输出我们花了多少次线性求解器的迭代。当下面的循环完成后，我们有（一个近似的） \(U^n\) 。</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> initial_rhs_norm = 0.;</div>
<div class="line"><span class="keywordtype">bool</span>   first_iteration  = <span class="keyword">true</span>;</div>
<div class="line"><span class="keywordflow">do</span></div>
<div class="line">  {</div>
<div class="line">    assemble_system();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (first_iteration == <span class="keyword">true</span>)</div>
<div class="line">      initial_rhs_norm = system_rhs.l2_norm();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_iterations = solve();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    solution += solution_update;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (first_iteration == <span class="keyword">true</span>)</div>
<div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; n_iterations;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      std::cout &lt;&lt; <span class="charliteral">&#39;+&#39;</span> &lt;&lt; n_iterations;</div>
<div class="line">    first_iteration = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">while</span> (system_rhs.l2_norm() &gt; 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-6 * initial_rhs_norm);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot; CG iterations per nonlinear step.&quot;</span> &lt;&lt; std::endl;</div>
</div><!-- fragment --><p>在得到问题的第一个方程 \(t=t_n\) 的解后，我们必须更新辅助速度变量 \(V^n\) 。然而，我们不计算和存储 \(V^n\) ，因为它不是我们在问题中直接使用的数量。因此，为了简单起见，我们直接更新 \(MV^n\) 。</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> tmp_vector(solution.size());</div>
<div class="line">laplace_matrix.vmult(tmp_vector, solution);</div>
<div class="line">M_x_velocity.add(-time_step * theta, tmp_vector);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">laplace_matrix.vmult(tmp_vector, old_solution);</div>
<div class="line">M_x_velocity.add(-time_step * (1 - theta), tmp_vector);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">compute_nl_term(old_solution, solution, tmp_vector);</div>
<div class="line">M_x_velocity.add(-time_step, tmp_vector);</div>
</div><!-- fragment --><p>很多时候，特别是对于细网格，我们必须选择相当小的时间步长，以使方案稳定。因此，有很多时间步数在求解过程中 "没有任何有趣的事情发生"。为了提高整体效率&ndash;特别是加快程序速度和节省磁盘空间&ndash;我们每隔 <code>output_timestep_skip</code> 个时间步数才输出解。</p>
<div class="fragment"><div class="line">        <span class="keywordflow">if</span> (timestep_number % output_timestep_skip == 0)</div>
<div class="line">          output_results(timestep_number);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step25</span></div>
</div><!-- fragment --><p><a class="anchor" id="Thecodemaincodefunction"></a> </p><h3>The <code>main</code> function</h3>
<p>这是该程序的主要功能。它创建了一个顶层类的对象，并调用其主函数。如果在执行 <code>SineGordonProblem</code> 类的运行方法时抛出了异常，我们会在这里捕获并报告它们。关于异常的更多信息，读者应该参考 <a class="el" href="step_6.html">step-6</a> 。</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span>Step25;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      SineGordonProblem&lt;1&gt; sg_problem;</div>
<div class="line">      sg_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>显式欧拉时间步进方案（ \(\theta=0\) ）对于我们希望解决的问题来说表现得很充分。不幸的是，由于稳定性问题，必须选择一个相当小的时间步长---&mdash; \(k\sim h/10\) 似乎对我们进行的大多数模拟都有效。另一方面，Crank-Nicolson方案（ \(\theta=\frac{1}{2}\) ）是无条件稳定的，并且（至少对于一维呼吸器的情况）我们可以选择大到 \(25h\) 的时间步长而不对解决方案产生任何不良影响。隐式欧拉方案（ \(\theta=1\) ）是 "指数阻尼 "的，所以它不是解决正弦戈登方程的好选择，因为它是保守的。然而， \(\theta\) -方法所提供的连续体中的一些阻尼方案对于消除边界效应引起的虚假振荡很有帮助。</p>
<p>在下面的模拟中，我们在一维的区间 \(\Omega = [-10,10]\) 和二维的正方形 \(\Omega = [-10,10]\times [-10,10]\) 上解决正弦-戈登方程。在每种情况下，各自的网格被均匀地细化了6次，即 \(h\sim 2^{-6}\) 。</p>
<p><a class="anchor" id="An11dSolution"></a></p><h3>An (1+1)-d Solution</h3>
<p>我们讨论的第一个例子是正弦-戈登方程的所谓一维（静止）呼吸器解。正如在介绍中提到的，呼吸器有如下闭合形式的表达。 </p><p class="formulaDsp">
\[ u_{\mathrm{breather}}(x,t) = -4\arctan \left(\frac{m}{\sqrt{1-m^2}} \frac{\sin\left(\sqrt{1-m^2}t +c_2\right)}{\cosh(mx+c_1)} \right), \]
</p>
<p> 其中 \(c_1\) 、 \(c_2\) 和 \(m&lt;1\) 为常数。在下面的模拟中，我们选择了 \(c_1=0\) , \(c_2=0\) , \(m=0.5\) 。此外，我们知道呼吸器的振荡周期是 \(2\pi\sqrt{1-m^2}\) ，因此我们选择了 \(t_0=-5.4414\) 和 \(t_f=2.7207\) ，这样我们可以观察到溶液的三次振荡。然后，取 \(u_0(x) = u_{\mathrm{breather}}(x,t_0)\) ， \(\theta=0\) 和 \(k=h/10\) ，程序计算出以下解。</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-25.1d-breather.gif" alt="Animation of the 1D stationary breather." class="inline"/> <br  />
</p>
<p>虽然程序中没有显示如何做到这一点，但另一种可视化(1+1)-d解决方案的方法是使用DataOutStack类产生的输出；它允许 "堆叠 "各个时间步骤的解决方案，因此我们从一维时间相关的解决方案中得到二维时空图。这就产生了下面的时空图，而不是上面的动画。</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-25.1d-breather_stp.png" alt="A space-time plot of the 1D stationary breather." class="inline"/> <br  />
</p>
<p>此外，由于呼吸器是正弦戈登方程的分析解，我们可以用它来验证我们的代码，尽管我们必须假设我们选择诺伊曼边界条件引入的误差与数值误差相比很小。在这种假设下，可以使用 <a class="el" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a> 函数来计算数值解和本程序的 <code>ExactSolution</code> 类描述的函数之间的差异。对于上面两幅图所示的模拟，每个时间步长的有限元解的误差的 \(L^2\) 准则保持在 \(10^{-2}\) 的数量级。因此，我们可以得出结论，数值方法在程序中得到了正确的实现。</p>
<p><a class="anchor" id="Afew21DSolutions"></a></p><h3>A few (2+1)D Solutions</h3>
<p>在文献中可以找到的正弦戈登方程在(2+1)D中的唯一分析解是所谓的克氏孤波。它有以下闭合式表达。 </p><p class="formulaDsp">
\[ u(x,y,t) = 4 \arctan \left[a_0 e^{s\xi}\right] \]
</p>
<p>与 </p><p class="formulaDsp">
\[ \xi = x \cos\vartheta + \sin(\vartheta) (y\cosh\lambda + t\sinh \lambda) \]
</p>
<p>，其中 \(a_0\) 、 \(\vartheta\) 和 \(\lambda\) 为常数。在下面的模拟中，我们选择了 \(a_0=\lambda=1\) 。请注意，如果 \(\vartheta=\pi\) 是静止的，那么它将是一个很好的解决方案，我们可以用它来验证二维的程序，因为没有发生域边界的反射。</p>
<p>下面显示的模拟是用 \(u_0(x) = u_{\mathrm{kink}}(x,t_0)\) 、 \(\theta=\frac{1}{2}\) 、 \(k=20h\) 、 \(t_0=1\) 和 \(t_f=500\) 进行的。每个时间步长的有限元解的 \(L^2\) 误差准则保持在 \(10^{-2}\) 的数量级上，表明该程序在二维和一维都能正常工作。不幸的是，这个解决方案不是很有趣，尽管如此，为了完整起见，我们还是把它的一个快照放在下面。</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-25.2d-kink.png" alt="Stationary 2D kink." class="inline"/> <br  />
</p>
<p>现在我们已经在一维和二维中验证了代码，我们转到一个分析解未知的问题上。</p>
<p>为此，我们围绕 \(z\) 轴旋转上面讨论的扭结解：我们让 \(\vartheta=\frac{\pi}{4}\) 。后者的结果是一个不与网格对齐的孤波，所以反射会立即在域的边界发生。对于下面所示的模拟，我们采取了 \(u_0(x)=u_{\mathrm{kink}}(x,t_0)\) 、 \(\theta=\frac{2}{3}\) 、 \(k=20h\) 、 \(t_0=0\) 和 \(t_f=20\) 。此外，我们不得不选择 \(\theta=\frac{2}{3}\) ，因为对于任何 \(\theta\le\frac{1}{2}\) 的边界都会产生振荡，这可能是由于方案而不是方程造成的，因此选择 \(\theta\) 的值是在时间步进方案的 "指数阻尼 "频谱中的一个好位置，确保这些振荡不会被产生。</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-25.2d-angled_kink.gif" alt="Animation of a moving 2D kink, at 45 degrees to the axes of the grid, showing boundary effects." class="inline"/> <br  />
</p>
<p>正弦-戈登方程的另一个有趣的解决方案（不能通过分析获得）可以通过使用两个一维呼吸器来构建以下可分离的二维初始条件来产生。 </p><p class="formulaDsp">
\[ u_0(x) = u_{\mathrm{pseudobreather}}(x,t_0) = 16\arctan \left( \frac{m}{\sqrt{1-m^2}} \frac{\sin\left(\sqrt{1-m^2}t_0\right)}{\cosh(mx_1)} \right) \arctan \left( \frac{m}{\sqrt{1-m^2}} \frac{\sin\left(\sqrt{1-m^2}t_0\right)}{\cosh(mx_2)} \right), \]
</p>
<p> 其中 \(x=(x_1,x_2)\in{R}^2\) , \(m=0.5&lt;1\) 与我们上面讨论的一维情况一样。对于下面的模拟，我们选择了 \(\theta=\frac{1}{2}\) , \(k=10h\) , \(t_0=-5.4414\) 和 \(t_f=2.7207\) 。这个解决方案相当有趣</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-25.2d-pseudobreather.gif" alt="Animation of a 2D pseudobreather." class="inline"/> <br  />
</p>
<p><a class="anchor" id="extensions"></a> <a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>改变初始条件是有启发的。大多数选择不会导致保持局部的解决方案（在孤子界，这样的解决方案被称为 "静止的"，尽管解决方案确实随时间变化），而是导致解决方案，其中方程的波状特征占主导地位，波从局部初始条件的位置走了。例如，值得玩一玩 <code>InitialValues</code> 类，把对 <code>ExactSolution</code> 类的调用替换成类似这样的函数。 </p><p class="formulaDsp">
\[ u_0(x,y) = \cos\left(\frac x2\right)\cos\left(\frac y2\right) \]
</p>
<p> 如果 \(|x|,|y|\le \frac\pi 2\) ，而 \(u_0(x,y)=0\) 在这个区域之外。</p>
<p>第二个方面是研究该方案是否是能量保全的。对于 <a class="el" href="step_23.html">@ref step_23 </a>step-23" "中讨论的纯波方程，如果我们选择时间步进参数，使我们得到Crank-Nicolson方案，情况就是这样。我们可以在这里做类似的事情，注意到正弦-戈登解的能量定义为 </p><p class="formulaDsp">
\[ E(t) = \frac 12 \int_\Omega \left(\frac{\partial u}{\partial t}\right)^2 + \left(\nabla u\right)^2 + 2 (1-\cos u) \; dx. \]
</p>
<p>（我们在公式中使用 \(1-\cos u\) 而不是 \(-\cos u\) ，以确保对能量的所有贡献都是正的，从而使衰减解在无界域上具有有限的能量）。</p>
<p>除此以外，还有两个明显的领域。</p>
<ul>
<li>显然，自适应性（即时间自适应网格）会对这样的问题感兴趣。它们的复杂性导致我们再次将其排除在本方案之外，尽管 <a class="el" href="step_23.html">@ref step_23 </a>step-23" "介绍中的一般评论仍然正确。</li>
<li>更快的方案来解决这个问题。虽然今天的计算机已经足够快，可以在不长的时间内解决二维甚至三维静止的问题，但时间相关的问题提出了一个完全不同的问题类别。我们在 step-48 中讨论了这个问题，在那里我们展示了如何并行地解决这个问题，而且根本不需要组装或反转任何矩阵。<a class="anchor" id="PlainProg"></a> <h1>The plain program</h1>
</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2006 - 2020 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Ivan Christov, Wolfgang Bangerth, Texas A&amp;M University, 2006</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dynamic__sparsity__pattern_8h.html">deal.II/lac/dynamic_sparsity_pattern.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>Step25</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>SineGordonProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    SineGordonProblem();</div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span>         make_grid_and_dofs();</div>
<div class="line">    <span class="keywordtype">void</span>         assemble_system();</div>
<div class="line">    <span class="keywordtype">void</span>         compute_nl_term(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                                 <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                                 <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;      nl_term) <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">void</span>         compute_nl_matrix(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                                   <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                                   <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> &amp;nl_matrix) <span class="keyword">const</span>;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> solve();</div>
<div class="line">    <span class="keywordtype">void</span>         output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line">    <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>          fe;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>    dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a>      sparsity_pattern;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> laplace_matrix;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_global_refinements;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span>       time;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> final_time, time_step;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> theta;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> solution, solution_update, old_solution;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> M_x_velocity;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> system_rhs;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> output_timestep_skip;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    ExactSolution(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components = 1, <span class="keyword">const</span> <span class="keywordtype">double</span> time = 0.)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;(n_components, time)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="comment">/*component*/</span> = 0)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">switch</span> (dim)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 1:</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> m  = 0.5;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> c1 = 0.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> c2 = 0.;</div>
<div class="line">              <span class="keywordflow">return</span> -4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(m / std::sqrt(1. - m * m) *</div>
<div class="line">                                     std::sin(std::sqrt(1. - m * m) * t + c2) /</div>
<div class="line">                                     <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(m * p[0] + c1));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> 2:</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> theta  = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="group__Exceptions.html#gga841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> a0     = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> s      = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> arg    = p[0] * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta) +</div>
<div class="line">                                 <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * (p[1] * <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(lambda) +</div>
<div class="line">                                                    t * <a class="code" href="namespaceDifferentiation_1_1SD.html#a766e4d9bbfe24e99245081947db6a0c7">std::sinh</a>(lambda));</div>
<div class="line">              <span class="keywordflow">return</span> 4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(a0 * std::exp(s * arg));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> 3:</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> theta = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> phi   = <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> / 4;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> tau   = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> c0    = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> s     = 1.;</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> arg   = p[0] * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta) +</div>
<div class="line">                                 p[1] * <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * <a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(phi) +</div>
<div class="line">                                 <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta) * <a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(phi) *</div>
<div class="line">                                   (p[2] * <a class="code" href="namespaceDifferentiation_1_1SD.html#a26c1f7a69dc8ac2e16144493d3b3b896">std::cosh</a>(tau) + t * <a class="code" href="namespaceDifferentiation_1_1SD.html#a766e4d9bbfe24e99245081947db6a0c7">std::sinh</a>(tau));</div>
<div class="line">              <span class="keywordflow">return</span> 4. * <a class="code" href="namespaceDifferentiation_1_1SD.html#a803fcea270d7a523a91e3b7c173059f9">std::atan</a>(c0 * std::exp(s * arg));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keywordflow">return</span> -1e8;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>InitialValues : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    InitialValues(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components = 1, <span class="keyword">const</span> <span class="keywordtype">double</span> time = 0.)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;(n_components, time)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keywordflow">return</span> ExactSolution&lt;dim&gt;(1, this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>()).value(p, component);</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  SineGordonProblem&lt;dim&gt;::SineGordonProblem()</div>
<div class="line">    : fe(1)</div>
<div class="line">    , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div>
<div class="line">    , n_global_refinements(6)</div>
<div class="line">    , time(-5.4414)</div>
<div class="line">    , final_time(2.7207)</div>
<div class="line">    , time_step(10 * 1. / std::<a class="code" href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">pow</a>(2., 1. * n_global_refinements))</div>
<div class="line">    , theta(0.5)</div>
<div class="line">    , output_timestep_skip(1)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, -10, 10);</div>
<div class="line">    <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(n_global_refinements);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div>
<div class="line">              &lt;&lt; std::endl</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;   Total number of cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_cells()</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    dof_handler.distribute_dofs(fe);</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div>
<div class="line">              &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(), dof_handler.n_dofs());</div>
<div class="line">    <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp);</div>
<div class="line">    sparsity_pattern.copy_from(dsp);</div>
<div class="line"> </div>
<div class="line">    system_matrix.reinit(sparsity_pattern);</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.reinit(sparsity_pattern);</div>
<div class="line">    laplace_matrix.reinit(sparsity_pattern);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a>(dof_handler,</div>
<div class="line">                                      <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                                      <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div>
<div class="line">    <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a>(dof_handler,</div>
<div class="line">                                         <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                                         laplace_matrix);</div>
<div class="line"> </div>
<div class="line">    solution.reinit(dof_handler.n_dofs());</div>
<div class="line">    solution_update.reinit(dof_handler.n_dofs());</div>
<div class="line">    old_solution.reinit(dof_handler.n_dofs());</div>
<div class="line">    M_x_velocity.reinit(dof_handler.n_dofs());</div>
<div class="line">    system_rhs.reinit(dof_handler.n_dofs());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::assemble_system()</div>
<div class="line">  {</div>
<div class="line">    system_matrix.copy_from(<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div>
<div class="line">    system_matrix.add(std::pow(time_step * theta, 2), laplace_matrix);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> tmp_matrix(sparsity_pattern);</div>
<div class="line">    compute_nl_matrix(old_solution, solution, tmp_matrix);</div>
<div class="line">    system_matrix.add(std::pow(time_step * theta, 2), tmp_matrix);</div>
<div class="line"> </div>
<div class="line">    system_rhs = 0.;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> tmp_vector(solution.size());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(system_rhs, solution);</div>
<div class="line">    laplace_matrix.vmult(tmp_vector, solution);</div>
<div class="line">    system_rhs.add(std::pow(time_step * theta, 2), tmp_vector);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(tmp_vector, old_solution);</div>
<div class="line">    system_rhs.add(-1.0, tmp_vector);</div>
<div class="line">    laplace_matrix.vmult(tmp_vector, old_solution);</div>
<div class="line">    system_rhs.add(std::pow(time_step, 2) * theta * (1 - theta), tmp_vector);</div>
<div class="line"> </div>
<div class="line">    system_rhs.add(-time_step, M_x_velocity);</div>
<div class="line"> </div>
<div class="line">    compute_nl_term(old_solution, solution, tmp_vector);</div>
<div class="line">    system_rhs.add(std::pow(time_step, 2) * theta, tmp_vector);</div>
<div class="line"> </div>
<div class="line">    system_rhs *= -1.;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::compute_nl_term(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">                                               <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">                                               <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;nl_term)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    nl_term = 0;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 1);</div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>     fe_values(fe,</div>
<div class="line">                            quadrature_formula,</div>
<div class="line">                            <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> |</div>
<div class="line">                              <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>                       local_nl_term(dofs_per_cell);</div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div>
<div class="line">    std::vector&lt;double&gt;                  old_data_values(n_q_points);</div>
<div class="line">    std::vector&lt;double&gt;                  new_data_values(n_q_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        local_nl_term = 0;</div>
<div class="line">        fe_values.reinit(cell);</div>
<div class="line">        fe_values.get_function_values(old_data, old_data_values);</div>
<div class="line">        fe_values.get_function_values(new_data, new_data_values);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">            local_nl_term(i) +=</div>
<div class="line">              (<a class="code" href="numbers_8h.html#a27989bdc7b4b828564982787d126bd91">std::sin</a>(theta * new_data_values[q_point] +</div>
<div class="line">                        (1 - theta) * old_data_values[q_point]) *</div>
<div class="line">               fe_values.shape_value(i, q_point) * fe_values.JxW(q_point));</div>
<div class="line"> </div>
<div class="line">        cell-&gt;get_dof_indices(local_dof_indices);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">          nl_term(local_dof_indices[i]) += local_nl_term(i);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::compute_nl_matrix(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;old_data,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;new_data,</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> &amp;nl_matrix)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>   quadrature_formula(fe.degree + 1);</div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div>
<div class="line">                            quadrature_formula,</div>
<div class="line">                            <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> |</div>
<div class="line">                              <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> local_nl_matrix(dofs_per_cell, dofs_per_cell);</div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div>
<div class="line">    std::vector&lt;double&gt;                  old_data_values(n_q_points);</div>
<div class="line">    std::vector&lt;double&gt;                  new_data_values(n_q_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        local_nl_matrix = 0;</div>
<div class="line">        fe_values.reinit(cell);</div>
<div class="line">        fe_values.get_function_values(old_data, old_data_values);</div>
<div class="line">        fe_values.get_function_values(new_data, new_data_values);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; n_q_points; ++q_point)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div>
<div class="line">              local_nl_matrix(i, j) +=</div>
<div class="line">                (<a class="code" href="numbers_8h.html#a02761f62f66f685e954daed42bcb3a1b">std::cos</a>(theta * new_data_values[q_point] +</div>
<div class="line">                          (1 - theta) * old_data_values[q_point]) *</div>
<div class="line">                 fe_values.shape_value(i, q_point) *</div>
<div class="line">                 fe_values.shape_value(j, q_point) * fe_values.JxW(q_point));</div>
<div class="line"> </div>
<div class="line">        cell-&gt;get_dof_indices(local_dof_indices);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div>
<div class="line">            nl_matrix.<a class="code" href="classSparseMatrix.html#acabf7629046afdd9077f77f7746a7a3f">add</a>(local_dof_indices[i],</div>
<div class="line">                          local_dof_indices[j],</div>
<div class="line">                          local_nl_matrix(i, j));</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> SineGordonProblem&lt;dim&gt;::solve()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12 * system_rhs.l2_norm());</div>
<div class="line">    <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div>
<div class="line">    preconditioner.<a class="code" href="group__Preconditioners.html#ga7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div>
<div class="line"> </div>
<div class="line">    cg.solve(system_matrix, solution_update, system_rhs, preconditioner);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> solver_control.last_step();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> SineGordonProblem&lt;dim&gt;::output_results(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(solution, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename =</div>
<div class="line">      <span class="stringliteral">&quot;solution-&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(timestep_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">    <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> vtk_flags;</div>
<div class="line">    vtk_flags.<a class="code" href="group__Exceptions.html#ga3be0d6de1c92b770e8664bce2fc7c107">compression_level</a> =</div>
<div class="line">      DataOutBase::VtkFlags::ZlibCompressionLevel::best_speed;</div>
<div class="line">    data_out.<a class="code" href="group__Exceptions.html#gac7280a24690b117454acfb0fa058299c">set_flags</a>(vtk_flags);</div>
<div class="line">    std::ofstream output(filename);</div>
<div class="line">    data_out.<a class="code" href="group__Exceptions.html#ga93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(output);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">SineGordonProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> constraints;</div>
<div class="line">      constraints.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>(dof_handler,</div>
<div class="line">                           constraints,</div>
<div class="line">                           <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div>
<div class="line">                           InitialValues&lt;dim&gt;(1, time),</div>
<div class="line">                           solution);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 1;</div>
<div class="line">    <span class="keywordflow">for</span> (time += time_step; time &lt;= final_time;</div>
<div class="line">         time += time_step, ++timestep_number)</div>
<div class="line">      {</div>
<div class="line">        old_solution = solution;</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; std::endl</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Time step #&quot;</span> &lt;&lt; timestep_number &lt;&lt; <span class="stringliteral">&quot;; &quot;</span></div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;advancing to t = &quot;</span> &lt;&lt; time &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">double</span> initial_rhs_norm = 0.;</div>
<div class="line">        <span class="keywordtype">bool</span>   first_iteration  = <span class="keyword">true</span>;</div>
<div class="line">        <span class="keywordflow">do</span></div>
<div class="line">          {</div>
<div class="line">            assemble_system();</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (first_iteration == <span class="keyword">true</span>)</div>
<div class="line">              initial_rhs_norm = system_rhs.l2_norm();</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_iterations = solve();</div>
<div class="line"> </div>
<div class="line">            solution += solution_update;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (first_iteration == <span class="keyword">true</span>)</div>
<div class="line">              std::cout &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; n_iterations;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              std::cout &lt;&lt; <span class="charliteral">&#39;+&#39;</span> &lt;&lt; n_iterations;</div>
<div class="line">            first_iteration = <span class="keyword">false</span>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">while</span> (system_rhs.l2_norm() &gt; 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-6 * initial_rhs_norm);</div>
<div class="line"> </div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot; CG iterations per nonlinear step.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classVector.html">Vector&lt;double&gt;</a> tmp_vector(solution.size());</div>
<div class="line">        laplace_matrix.vmult(tmp_vector, solution);</div>
<div class="line">        M_x_velocity.add(-time_step * theta, tmp_vector);</div>
<div class="line"> </div>
<div class="line">        laplace_matrix.vmult(tmp_vector, old_solution);</div>
<div class="line">        M_x_velocity.add(-time_step * (1 - theta), tmp_vector);</div>
<div class="line"> </div>
<div class="line">        compute_nl_term(old_solution, solution, tmp_vector);</div>
<div class="line">        M_x_velocity.add(-time_step, tmp_vector);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % output_timestep_skip == 0)</div>
<div class="line">          output_results(timestep_number);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step25</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span>Step25;</div>
<div class="line"> </div>
<div class="line">      SineGordonProblem&lt;1&gt; sg_problem;</div>
<div class="line">      sg_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_a76bc1cc7649cc416723f450d24fdd91d"><div class="ttname"><a href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">Utilities::System::get_time</a></div><div class="ttdeci">std::string get_time()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l01019">utilities.cc:1019</a></div></div>
<div class="ttc" id="anamespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div><div class="ttdeci">@ value</div></div>
<div class="ttc" id="anumbers_8h_html_af44aee1db5cdcd0bab54e3c011d2be66"><div class="ttname"><a href="numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;, const Number p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05422">vectorization.h:5422</a></div></div>
</div><!-- fragment --><p> 。 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
