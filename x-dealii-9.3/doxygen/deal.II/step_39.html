<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_39.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-39 tutorial program 。</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.3.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.3.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-39 tutorial program 。 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>本教程取决于 <a class="el" href="step_12.html">step-12</a> b.</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Thelocalintegrators">The local integrators</a><a href="#Thelocalintegrators">The local integrators</a>
        <li><a href="#Themainclass">The main class</a><a href="#Themainclass">The main class</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Logfileoutput">Logfile output</a><a href="#Logfileoutput">Logfile output</a>
        <li><a href="#Postprocessingofthelogfile">Postprocessing of the logfile</a><a href="#Postprocessingofthelogfile">Postprocessing of the logfile</a>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
</p>
<p><a class="anchor" id="Intro"></a></p>
<p>在这个程序中，我们使用内部惩罚方法和Nitsche的弱边界条件来解决Poisson方程。我们在局部细化的网格上使用多网格方法，这些网格的生成使用了一个批量准则和一个基于单元和面残差的标准误差估计器。所有的操作都是通过MeshWorker接口实现的。</p>
<p>像 <a class="el" href="step_12.html">step-12</a> 一样，离散化依赖于有限元空间，它在网格单元内部是多项式的 \(K\in \mathbb T_h\) ，但在单元之间没有连续性。由于这种函数在每个内部面 \(F\in \mathbb F_h^i\) 上有两个值，每边一个，我们定义均值和跳跃算子如下：让<em>K</em><sub>1</sub>和<em>K</em><sub>2</sub>是共享一个面的两个单元，让函数的轨迹<em>u<sub>i</sub></em>和外法向量<b>n</b><em><sub>i</sub></em> 被相应地标记。然后，在这个面上，我们让 </p><p class="formulaDsp">
\[ \average{ u } = \frac{u_1 + u_2}2 \]
</p>
<p>注意，如果这样的表达式包含一个法向量，平均运算符就会变成一个跳跃。问题 </p><p class="formulaDsp">
\[ -\Delta u = f \text{ in }\Omega \qquad u = u^D \text{ on } \partial\Omega \]
</p>
<p>的内部惩罚方法变成 </p><p class="formulaDsp">
\begin{multline*} \sum_{K\in \mathbb T_h} (\nabla u, \nabla v)_K \\ + \sum_{F \in F_h^i} \biggl\{4\sigma_F (\average{ u \mathbf n}, \average{ v \mathbf n })_F - 2 (\average{ \nabla u },\average{ v\mathbf n })_F - 2 (\average{ \nabla v },\average{ u\mathbf n })_F \biggr\} \\ + \sum_{F \in F_h^b} \biggl\{2\sigma_F (u, v)_F - (\partial_n u,v)_F - (\partial_n v,u)_F \biggr\} \\ = (f, v)_\Omega + \sum_{F \in F_h^b} \biggl\{ 2\sigma_F (u^D, v)_F - (\partial_n v,u^D)_F \biggr\}. \end{multline*}
</p>
<p>这里， \(\sigma_F\) 是惩罚参数，其选择如下：对于单元格<em>K</em>的一个面<em>F</em>，计算值 </p><p class="formulaDsp">
\[ \sigma_{F,K} = p(p+1) \frac{|F|_{d-1}}{|K|_d}, \]
</p>
<p>，其中<em>p</em>是有限元函数的多项式程度， \(|\cdot|_d\) 和 \(|\cdot|_{d-1}\) 表示相应对象的 \(d\) 和 \(d-1\) 维的豪斯多尔夫度。如果面在边界上，选择 \(\sigma_F = \sigma_{F,K}\) 。对于一个内部的面，我们取这个面的两个值的平均值。</p>
<p>在我们的有限元程序中，我们区分了三种不同的积分，分别对应于上面的单元格、内部面和边界面的总和。由于 <a class="el" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a> 为我们组织了这些和，我们只需要实现每个网格元素的积分。下面的MatrixIntegrator类有这三个函数用于公式的左边，RHSIntegrator类用于右边。</p>
<p>正如我们将在下面看到的，即使是误差估计也是同样的结构，因为它可以写为</p>
<p class="formulaDsp">
\begin{align*} \eta^2 &amp;= \eta_K^2 + \eta_F^2 + \eta_B^2 \\ \eta_K^2 &amp;= \sum_{K\in \mathbb T_h} h^2 \|f + \Delta u_h\|^2 \\ \eta_F^2 &amp;= \sum_{F \in F_h^i} \biggl\{ 4 \sigma_F \| \average{u_h\mathbf n} \|^2 + h \|\average{\partial_n u_h}\|^2 \biggr\} \\ \eta_B^2 &amp;= \sum_{F \in F_h^b} 2\sigma_F \| u_h-u^D \|^2. \end{align*}
</p>
<p>因此，下面用于组装矩阵、右手和误差估计的函数展示了这些循环都是通用的，可以用同样的方式进行编程。</p>
<p>这个程序与 step-12 b有关，因为它使用MeshWorker和不连续Galerkin方法。在那里，我们解决的是一个平流问题，而这里是一个扩散问题。在这里，我们还使用了多网格预处理和一个理论上合理的误差估计器，见Karakashian和Pascal（2003）。Kanschat (2004)详细讨论了多层次方案。Hoppe, Kanschat, and Warburton (2009)讨论了自适应迭代及其收敛性（对于三角形网格）。<a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p>用于线性代数的include文件。一个常规的SparseMatrix，它又将包括SparsityPattern和Vector类的必要文件。</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dynamic__sparsity__pattern_8h.html">deal.II/lac/dynamic_sparsity_pattern.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition__block_8h.html">deal.II/lac/precondition_block.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="block__vector_8h.html">deal.II/lac/block_vector.h</a>&gt;</span></div>
<div class="ttc" id="ablock__vector_8h_html"><div class="ttname"><a href="block__vector_8h.html">block_vector.h</a></div></div>
<div class="ttc" id="adynamic__sparsity__pattern_8h_html"><div class="ttname"><a href="dynamic__sparsity__pattern_8h.html">dynamic_sparsity_pattern.h</a></div></div>
<div class="ttc" id="aprecondition_8h_html"><div class="ttname"><a href="precondition_8h.html">precondition.h</a></div></div>
<div class="ttc" id="aprecondition__block_8h_html"><div class="ttname"><a href="precondition__block_8h.html">precondition_block.h</a></div></div>
<div class="ttc" id="asolver__cg_8h_html"><div class="ttname"><a href="solver__cg_8h.html">solver_cg.h</a></div></div>
<div class="ttc" id="asparse__matrix_8h_html"><div class="ttname"><a href="sparse__matrix_8h.html">sparse_matrix.h</a></div></div>
</div><!-- fragment --><p>用于设置网格的包含文件</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__refinement_8h.html">deal.II/grid/grid_refinement.h</a>&gt;</span></div>
<div class="ttc" id="agrid_2grid__refinement_8h_html"><div class="ttname"><a href="grid_2grid__refinement_8h.html">grid_refinement.h</a></div></div>
<div class="ttc" id="agrid__generator_8h_html"><div class="ttname"><a href="grid__generator_8h.html">grid_generator.h</a></div></div>
</div><!-- fragment --><p>包含FiniteElement类和DoFHandler的文件。</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__dgp_8h.html">deal.II/fe/fe_dgp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="ttc" id="adof__tools_8h_html"><div class="ttname"><a href="dof__tools_8h.html">dof_tools.h</a></div></div>
<div class="ttc" id="afe__dgp_8h_html"><div class="ttname"><a href="fe__dgp_8h.html">fe_dgp.h</a></div></div>
<div class="ttc" id="afe__dgq_8h_html"><div class="ttname"><a href="fe__dgq_8h.html">fe_dgq.h</a></div></div>
<div class="ttc" id="afe__q_8h_html"><div class="ttname"><a href="fe__q_8h.html">fe_q.h</a></div></div>
</div><!-- fragment --><p>使用MeshWorker框架的包含文件</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="meshworker_2dof__info_8h.html">deal.II/meshworker/dof_info.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="integration__info_8h.html">deal.II/meshworker/integration_info.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="assembler_8h.html">deal.II/meshworker/assembler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="loop_8h.html">deal.II/meshworker/loop.h</a>&gt;</span></div>
<div class="ttc" id="aassembler_8h_html"><div class="ttname"><a href="assembler_8h.html">assembler.h</a></div></div>
<div class="ttc" id="aintegration__info_8h_html"><div class="ttname"><a href="integration__info_8h.html">integration_info.h</a></div></div>
<div class="ttc" id="aloop_8h_html"><div class="ttname"><a href="loop_8h.html">loop.h</a></div></div>
<div class="ttc" id="ameshworker_2dof__info_8h_html"><div class="ttname"><a href="meshworker_2dof__info_8h.html">dof_info.h</a></div></div>
</div><!-- fragment --><p>与Laplacian相关的局部积分器的包含文件</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="laplace_8h.html">deal.II/integrators/laplace.h</a>&gt;</span></div>
<div class="ttc" id="alaplace_8h_html"><div class="ttname"><a href="laplace_8h.html">laplace.h</a></div></div>
</div><!-- fragment --><p>对多网格方法的支持</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__tools_8h.html">deal.II/multigrid/mg_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="multigrid_8h.html">deal.II/multigrid/multigrid.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__matrix_8h.html">deal.II/multigrid/mg_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__transfer_8h.html">deal.II/multigrid/mg_transfer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__coarse_8h.html">deal.II/multigrid/mg_coarse.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__smoother_8h.html">deal.II/multigrid/mg_smoother.h</a>&gt;</span></div>
<div class="ttc" id="amg__coarse_8h_html"><div class="ttname"><a href="mg__coarse_8h.html">mg_coarse.h</a></div></div>
<div class="ttc" id="amg__matrix_8h_html"><div class="ttname"><a href="mg__matrix_8h.html">mg_matrix.h</a></div></div>
<div class="ttc" id="amg__smoother_8h_html"><div class="ttname"><a href="mg__smoother_8h.html">mg_smoother.h</a></div></div>
<div class="ttc" id="amg__tools_8h_html"><div class="ttname"><a href="mg__tools_8h.html">mg_tools.h</a></div></div>
<div class="ttc" id="amg__transfer_8h_html"><div class="ttname"><a href="mg__transfer_8h.html">mg_transfer.h</a></div></div>
<div class="ttc" id="amultigrid_8h_html"><div class="ttname"><a href="multigrid_8h.html">multigrid.h</a></div></div>
</div><!-- fragment --><p>最后，我们从库中取出我们的精确解，以及正交和附加工具。</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="function__lib_8h.html">deal.II/base/function_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="ttc" id="afunction__lib_8h_html"><div class="ttname"><a href="function__lib_8h.html">function_lib.h</a></div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="aquadrature__lib_8h_html"><div class="ttname"><a href="quadrature__lib_8h.html">quadrature_lib.h</a></div></div>
<div class="ttc" id="avector__tools_8h_html"><div class="ttname"><a href="vector__tools_8h.html">vector_tools.h</a></div></div>
</div><!-- fragment --><p>deal.II库的所有类都在dealii的命名空间中。为了节省打字，我们告诉编译器也要在那里搜索名字。</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>Step39</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="namespace__dealii_8h_source.html#l00025">namespace_dealii.h:26</a></div></div>
</div><!-- fragment --><p>这是我们用来设置边界值的函数，也是我们比较的精确解。</p>
<div class="fragment"><div class="line"><a class="code" href="classFunctions_1_1SlitSingularityFunction.html">Functions::SlitSingularityFunction&lt;2&gt;</a> exact_solution;</div>
<div class="ttc" id="aclassFunctions_1_1SlitSingularityFunction_html"><div class="ttname"><a href="classFunctions_1_1SlitSingularityFunction.html">Functions::SlitSingularityFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function__lib_8h_source.html#l00508">function_lib.h:509</a></div></div>
</div><!-- fragment --><p><a class="anchor" id="Thelocalintegrators"></a> </p><h3>The local integrators</h3>
<p>MeshWorker将局部积分与单元格和面的循环分开。因此，我们必须编写局部积分类来生成矩阵、右手边和误差估计器。</p>
<p>所有这些类都有相同的三个函数，分别用于对单元、边界面和内部面的积分。局部积分所需的所有信息都由 MeshWorker::IntegrationInfo&lt;dim&gt;. 提供。请注意，函数的签名不能改变，因为这是 <a class="el" href="group__MeshWorker.html#ga93cfb35f7969ce8f0be7628255dfe7fb">MeshWorker::integration_loop()</a>. 所期望的。</p>
<p>定义局部积分器的第一类负责计算单元和面矩阵。它被用来组装全局矩阵以及水平矩阵。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>MatrixIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a44cc05e3e905a8cd5af4c12d3026ea2a">cell</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">       <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a796bd92a5f7d1fd3f555f5b8a85569cb">boundary</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a6aab57ca24b0fd3e9a1614b5a6cb49e2">face</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">            <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
<div class="ttc" id="aclassMeshWorker_1_1DoFInfo_html"><div class="ttname"><a href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2dof__info_8h_source.html#l00075">dof_info.h:76</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00077">integration_info.h:78</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalIntegrator_html"><div class="ttname"><a href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a></div><div class="ttdef"><b>Definition:</b> <a href="local__integrator_8h_source.html#l00056">local_integrator.h:57</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalIntegrator_html_a44cc05e3e905a8cd5af4c12d3026ea2a"><div class="ttname"><a href="classMeshWorker_1_1LocalIntegrator.html#a44cc05e3e905a8cd5af4c12d3026ea2a">MeshWorker::LocalIntegrator::cell</a></div><div class="ttdeci">virtual void cell(DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo, IntegrationInfo&lt; dim, spacedim &gt; &amp;info) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__worker_8cc_source.html#l00081">mesh_worker.cc:81</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalIntegrator_html_a6aab57ca24b0fd3e9a1614b5a6cb49e2"><div class="ttname"><a href="classMeshWorker_1_1LocalIntegrator.html#a6aab57ca24b0fd3e9a1614b5a6cb49e2">MeshWorker::LocalIntegrator::face</a></div><div class="ttdeci">virtual void face(DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo1, DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo2, IntegrationInfo&lt; dim, spacedim &gt; &amp;info1, IntegrationInfo&lt; dim, spacedim &gt; &amp;info2) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__worker_8cc_source.html#l00101">mesh_worker.cc:101</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalIntegrator_html_a796bd92a5f7d1fd3f555f5b8a85569cb"><div class="ttname"><a href="classMeshWorker_1_1LocalIntegrator.html#a796bd92a5f7d1fd3f555f5b8a85569cb">MeshWorker::LocalIntegrator::boundary</a></div><div class="ttdeci">virtual void boundary(DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo, IntegrationInfo&lt; dim, spacedim &gt; &amp;info) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh__worker_8cc_source.html#l00091">mesh_worker.cc:91</a></div></div>
</div><!-- fragment --><p>在每个单元上，我们对Dirichlet形式进行积分。我们使用LocalIntegrators中现成的积分库来避免自己编写这些循环。同样地，我们实现了Nitsche边界条件和单元间的内部惩罚通量。 <br  />
</p>
<p>边界和通量项需要一个惩罚参数，这个参数应该根据单元的大小和多项式的程度进行调整。在 <a class="el" href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty()</a> 中可以找到这个参数对常数系数的安全选择，我们在下面使用这个参数。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::cell(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">LocalIntegrators::Laplace::cell_matrix</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">                                         info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0).get_fe().tensor_degree();</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#af88167a13d65d1367d093a798a847263">LocalIntegrators::Laplace::nitsche_matrix</a>(</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">    info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty</a>(dinfo, dinfo, degree, degree));</div>
<div class="line">}</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html_a32fa7363be71ba320bcdc94f6d677843"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">MeshWorker::IntegrationInfo::fe_values</a></div><div class="ttdeci">const FEValuesBase&lt; dim, spacedim &gt; &amp; fe_values() const</div><div class="ttdoc">Access to finite element.</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00676">integration_info.h:676</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalResults_html_a06c5d817ce47a4c26966df1cdcebeac4"><div class="ttname"><a href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">MeshWorker::LocalResults::matrix</a></div><div class="ttdeci">MatrixBlock&lt; FullMatrix&lt; number &gt; &gt; &amp; matrix(const unsigned int i, const bool external=false)</div><div class="ttdef"><b>Definition:</b> <a href="local__results_8h_source.html#l00591">local_results.h:591</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Laplace_html_a733b581e72bfe9d27cc59501a35bcd30"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">LocalIntegrators::Laplace::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="laplace_8h_source.html#l00052">laplace.h:52</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Laplace_html_aa920ce4642983b9cb2fbf996b75d3c52"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty</a></div><div class="ttdeci">double compute_penalty(const MeshWorker::DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo1, const MeshWorker::DoFInfo&lt; dim, spacedim, number &gt; &amp;dinfo2, unsigned int deg1, unsigned int deg2)</div><div class="ttdef"><b>Definition:</b> <a href="laplace_8h_source.html#l00685">laplace.h:685</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Laplace_html_af88167a13d65d1367d093a798a847263"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Laplace.html#af88167a13d65d1367d093a798a847263">LocalIntegrators::Laplace::nitsche_matrix</a></div><div class="ttdeci">void nitsche_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, double penalty, double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="laplace_8h_source.html#l00157">laplace.h:157</a></div></div>
</div><!-- fragment --><p>内部面使用内部惩罚方法</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::face(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0).get_fe().tensor_degree();</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#acf43744b2ca29cbf871cf63054bd3436">LocalIntegrators::Laplace::ip_matrix</a>(</div>
<div class="line">    dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">    dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">true</span>).matrix,</div>
<div class="line">    dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">true</span>).matrix,</div>
<div class="line">    dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">    info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">    info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty</a>(</div>
<div class="line">      dinfo1, dinfo2, degree, degree));</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Laplace_html_acf43744b2ca29cbf871cf63054bd3436"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Laplace.html#acf43744b2ca29cbf871cf63054bd3436">LocalIntegrators::Laplace::ip_matrix</a></div><div class="ttdeci">void ip_matrix(FullMatrix&lt; double &gt; &amp;M11, FullMatrix&lt; double &gt; &amp;M12, FullMatrix&lt; double &gt; &amp;M21, FullMatrix&lt; double &gt; &amp;M22, const FEValuesBase&lt; dim &gt; &amp;fe1, const FEValuesBase&lt; dim &gt; &amp;fe2, double penalty, double factor1=1., double factor2=-1.)</div><div class="ttdef"><b>Definition:</b> <a href="laplace_8h_source.html#l00359">laplace.h:359</a></div></div>
</div><!-- fragment --><p>第二个局部积分器建立了右手边。在我们的例子中，右手边的函数为零，这样，这里只设置了弱形式的边界条件。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>RHSIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a44cc05e3e905a8cd5af4c12d3026ea2a">cell</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">       <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a796bd92a5f7d1fd3f555f5b8a85569cb">boundary</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a6aab57ca24b0fd3e9a1614b5a6cb49e2">face</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">            <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">RHSIntegrator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                         <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> RHSIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe           = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;         local_vector = dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a13d325f993aa366ce5f837f37d96a90b">vector</a>(0).block(0);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::vector&lt;double&gt; boundary_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">  exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), boundary_values);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                         dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div>
<div class="line">      local_vector(i) +=</div>
<div class="line">        (-penalty * fe.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, k)              <span class="comment">// (-sigma * v_i(x_k)</span></div>
<div class="line">         + fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * fe.<a class="code" href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">shape_grad</a>(i, k)) <span class="comment">// + n * grad v_i(x_k))</span></div>
<div class="line">          boundary_values[k] * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);             <span class="comment">// u^D(x_k) * dx</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">RHSIntegrator&lt;dim&gt;::face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                         <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                         <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                         <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{}</div>
<div class="ttc" id="aclassFEValuesBase_html"><div class="ttname"><a href="classFEValuesBase.html">FEValuesBase</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02324">fe_values.h:2325</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a1dd48cb744013c448d57f8f77640c08d"><div class="ttname"><a href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">FEValuesBase::shape_value</a></div><div class="ttdeci">const double &amp; shape_value(const unsigned int function_no, const unsigned int point_no) const</div></div>
<div class="ttc" id="aclassFEValuesBase_html_a46aefdb527125dafb59dcba92a0f256e"><div class="ttname"><a href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">FEValuesBase::shape_grad</a></div><div class="ttdeci">const Tensor&lt; 1, spacedim &gt; &amp; shape_grad(const unsigned int function_no, const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="aclassFEValuesBase_html_a5b264d5b2fb6615f5dea7a21135ed1a5"><div class="ttname"><a href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">FEValuesBase::dofs_per_cell</a></div><div class="ttdeci">const unsigned int dofs_per_cell</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02362">fe_values.h:2362</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a807c3049bfe81743fc0f237dfc2fbdea"><div class="ttname"><a href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">FEValuesBase::n_quadrature_points</a></div><div class="ttdeci">const unsigned int n_quadrature_points</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02344">fe_values.h:2344</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_abade89efb068b71b7ced7082012a2441"><div class="ttname"><a href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">FEValuesBase::JxW</a></div><div class="ttdeci">double JxW(const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="aclassFEValuesBase_html_ac25ec6835799c3b6c7c842f8acb05eb3"><div class="ttname"><a href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">FEValuesBase::normal_vector</a></div><div class="ttdeci">const Tensor&lt; 1, spacedim &gt; &amp; normal_vector(const unsigned int i) const</div></div>
<div class="ttc" id="aclassFEValuesBase_html_ade22ffd9fb5b07842daa504929244aa7"><div class="ttname"><a href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">FEValuesBase::get_fe</a></div><div class="ttdeci">const FiniteElement&lt; dim, spacedim &gt; &amp; get_fe() const</div></div>
<div class="ttc" id="aclassFEValuesBase_html_ae41b67cfd48e02f6035e39c84f0fb47a"><div class="ttname"><a href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">FEValuesBase::get_quadrature_points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; spacedim &gt; &gt; &amp; get_quadrature_points() const</div></div>
<div class="ttc" id="aclassFiniteElementData_html_a584a56a1611a86a04c8b9a26d0eb9f27"><div class="ttname"><a href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">FiniteElementData::tensor_degree</a></div><div class="ttdeci">unsigned int tensor_degree() const</div></div>
<div class="ttc" id="aclassFunctions_1_1SlitSingularityFunction_html_a3f0ece56f98717e112cb3c4b0c96aa2d"><div class="ttname"><a href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">Functions::SlitSingularityFunction::value_list</a></div><div class="ttdeci">virtual void value_list(const std::vector&lt; Point&lt; dim &gt;&gt; &amp;points, std::vector&lt; double &gt; &amp;values, const unsigned int component=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="function__lib_8cc_source.html#l01489">function_lib.cc:1489</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1DoFInfo_html_abe132f9c608609ab4cd529548b3fc8f5"><div class="ttname"><a href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">MeshWorker::DoFInfo::face</a></div><div class="ttdeci">Triangulation&lt; dim, spacedim &gt;::face_iterator face</div><div class="ttdoc">The current face.</div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2dof__info_8h_source.html#l00082">dof_info.h:82</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1DoFInfo_html_acdb25148428f90647ca6c6166e212ffa"><div class="ttname"><a href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">MeshWorker::DoFInfo::cell</a></div><div class="ttdeci">Triangulation&lt; dim, spacedim &gt;::cell_iterator cell</div><div class="ttdoc">The current cell.</div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2dof__info_8h_source.html#l00079">dof_info.h:79</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalResults_html_a13d325f993aa366ce5f837f37d96a90b"><div class="ttname"><a href="classMeshWorker_1_1LocalResults.html#a13d325f993aa366ce5f837f37d96a90b">MeshWorker::LocalResults::vector</a></div><div class="ttdeci">BlockVector&lt; number &gt; &amp; vector(const unsigned int i)</div><div class="ttdef"><b>Definition:</b> <a href="local__results_8h_source.html#l00582">local_results.h:582</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
</div><!-- fragment --><p>第三个局部积分器负责对误差估计的贡献。这是由Karakashian和Pascal（2003）提出的标准能量估计器。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>Estimator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a44cc05e3e905a8cd5af4c12d3026ea2a">cell</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">       <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a796bd92a5f7d1fd3f555f5b8a85569cb">boundary</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a6aab57ca24b0fd3e9a1614b5a6cb49e2">face</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">            <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p>单元的贡献是离散解的拉普拉斯，因为右手边是零。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Estimator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                     <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Tensor&lt;2, dim&gt;&gt; &amp;DDuh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a17bb3b94327dbbe22c0c3a57076f3b80">hessians</a>[0][0];</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> t = dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;diameter() * <a class="code" href="classSymmetricTensor.html#a9137b6052702150e8e5b1188d1971906">trace</a>(DDuh[k]);</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += t * t * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">}</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html_a17bb3b94327dbbe22c0c3a57076f3b80"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html#a17bb3b94327dbbe22c0c3a57076f3b80">MeshWorker::IntegrationInfo::hessians</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; Tensor&lt; 2, spacedim &gt; &gt; &gt; &gt; hessians</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00189">integration_info.h:189</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalResults_html_aff764a87d095e5266364c578ff2b0757"><div class="ttname"><a href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">MeshWorker::LocalResults::value</a></div><div class="ttdeci">number &amp; value(const unsigned int i)</div><div class="ttdef"><b>Definition:</b> <a href="local__results_8h_source.html#l00573">local_results.h:573</a></div></div>
<div class="ttc" id="aclassSymmetricTensor_html_a9137b6052702150e8e5b1188d1971906"><div class="ttname"><a href="classSymmetricTensor.html#a9137b6052702150e8e5b1188d1971906">SymmetricTensor::trace</a></div><div class="ttdeci">constexpr Number trace(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l02680">symmetric_tensor.h:2680</a></div></div>
<div class="ttc" id="anumbers_8h_html_ac4a2ed1890a931d0b6a55933310eadca"><div class="ttname"><a href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a></div><div class="ttdeci">::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05406">vectorization.h:5406</a></div></div>
</div><!-- fragment --><p>在边界，我们简单地使用边界残差的加权形式，即有限元解和正确边界条件之间的差值的规范。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> Estimator&lt;dim&gt;::boundary(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::vector&lt;double&gt; boundary_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">  exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), boundary_values);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                         dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff = boundary_values[k] - uh[k];</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += penalty * diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">}</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html_afb909cb1bef4fa870b7cc10f3fe6da49"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">MeshWorker::IntegrationInfo::values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00169">integration_info.h:169</a></div></div>
</div><!-- fragment --><p>最后，在内部面，估计器由解的跳跃和它的法向导数组成，并适当地加权。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">Estimator&lt;dim&gt;::face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">                     <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">                     <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">                     <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;          fe   = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh1  = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh2  = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh1 = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh2 = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>       penalty1 =</div>
<div class="line">    degree * (degree + 1) * dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty2 =</div>
<div class="line">    degree * (degree + 1) * dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = penalty1 + penalty2;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> h       = dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff1 = uh1[k] - uh2[k];</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff2 =</div>
<div class="line">        fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * Duh1[k] - fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * Duh2[k];</div>
<div class="line">      dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) +=</div>
<div class="line">        (penalty * diff1 * diff1 + h * diff2 * diff2) * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html_aa1260e7eaafa7f7455cb98d1b110383b"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">MeshWorker::IntegrationInfo::gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; Tensor&lt; 1, spacedim &gt; &gt; &gt; &gt; gradients</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00179">integration_info.h:179</a></div></div>
</div><!-- fragment --><p>最后，我们有一个误差的积分器。由于非连续Galerkin问题的能量准则不仅涉及到单元内部的梯度差，还涉及到跨面和边界的跳跃项，所以我们不能仅仅使用 <a class="el" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference()</a>. 而是使用MeshWorker接口来计算误差。</p>
<p>有几种不同的方法来定义这个能量准则，但是所有的方法都是随着网格大小的变化而等价的（有些不是随着多项式程度的变化而等价）。这里，我们选择 </p><p class="formulaDsp">
\[ \|u\|_{1,h} = \sum_{K\in \mathbb T_h} \|\nabla u\|_K^2 + \sum_{F \in F_h^i} 4\sigma_F\|\average{ u \mathbf n}\|^2_F + \sum_{F \in F_h^b} 2\sigma_F\|u\|^2_F \]
</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>ErrorIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a44cc05e3e905a8cd5af4c12d3026ea2a">cell</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">       <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a796bd92a5f7d1fd3f555f5b8a85569cb">boundary</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html#a6aab57ca24b0fd3e9a1614b5a6cb49e2">face</a>(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">            <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">            <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p>这里我们在单元格上进行积分。目前MeshWorker中还没有好的接口可以让我们访问正交点的正则函数值。因此，我们必须在单元格积分器中为精确的函数值和梯度创建向量。之后，一切都和以前一样，我们只需将差值的平方加起来。</p>
<p>除了计算能量准则的误差外，我们还利用网格工作者的能力同时计算两个函数，并在同一循环中计算<em>L<sup>2</sup></em>的误差。很明显，这个函数没有任何跳跃项，只出现在单元格的积分中。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::cell(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;   fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">  std::vector&lt;Tensor&lt;1, dim&gt;&gt; exact_gradients(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">  std::vector&lt;double&gt;         exact_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#af86d98b6e5fb169e556e71e33de2ca2b">gradient_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_gradients);</div>
<div class="line">  exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_values);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh  = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">double</span> <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a> = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_gradients[k][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] - Duh[k][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line">          <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a> += diff * diff;</div>
<div class="line">        }</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_values[k] - uh[k];</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += <a class="code" href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">sum</a> * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1) += diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::vector&lt;double&gt; exact_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">  exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_values);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                         dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_values[k] - uh[k];</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += penalty * diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::face(</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;  fe  = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh1 = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh2 = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>       penalty1 =</div>
<div class="line">    degree * (degree + 1) * dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty2 =</div>
<div class="line">    degree * (degree + 1) * dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = penalty1 + penalty2;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> diff = uh1[k] - uh2[k];</div>
<div class="line">      dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += (penalty * diff * diff) * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">    }</div>
<div class="line">  dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aclassFunctions_1_1SlitSingularityFunction_html_af86d98b6e5fb169e556e71e33de2ca2b"><div class="ttname"><a href="classFunctions_1_1SlitSingularityFunction.html#af86d98b6e5fb169e556e71e33de2ca2b">Functions::SlitSingularityFunction::gradient_list</a></div><div class="ttdeci">virtual void gradient_list(const std::vector&lt; Point&lt; dim &gt;&gt; &amp;points, std::vector&lt; Tensor&lt; 1, dim &gt;&gt; &amp;gradients, const unsigned int component=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="function__lib_8cc_source.html#l01582">function_lib.cc:1582</a></div></div>
<div class="ttc" id="aclassSymmetricTensor_html_a6c9d8cfe285d568676bb6e308146c147"><div class="ttname"><a href="classSymmetricTensor.html#a6c9d8cfe285d568676bb6e308146c147">SymmetricTensor::sum</a></div><div class="ttdeci">SymmetricTensor&lt; rank, dim, Number &gt; sum(const SymmetricTensor&lt; rank, dim, Number &gt; &amp;local, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
</div><!-- fragment --><p><a class="anchor" id="Themainclass"></a> </p><h3>The main class</h3>
<p>这个类做主要的工作，就像前面的例子一样。关于这里声明的函数的描述，请参考下面的实现。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>InteriorPenaltyProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">using</span> CellInfo = <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  InteriorPenaltyProblem(<span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_steps);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span>   setup_system();</div>
<div class="line">  <span class="keywordtype">void</span>   assemble_matrix();</div>
<div class="line">  <span class="keywordtype">void</span>   assemble_mg_matrix();</div>
<div class="line">  <span class="keywordtype">void</span>   assemble_right_hand_side();</div>
<div class="line">  <span class="keywordtype">void</span>   error();</div>
<div class="line">  <span class="keywordtype">double</span> estimate();</div>
<div class="line">  <span class="keywordtype">void</span>   solve();</div>
<div class="line">  <span class="keywordtype">void</span>   output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle) <span class="keyword">const</span>;</div>
<div class="ttc" id="aclassFiniteElement_html"><div class="ttname"><a href="classFiniteElement.html">FiniteElement</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00645">fe.h:646</a></div></div>
<div class="ttc" id="anamespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00691">work_stream.h:691</a></div></div>
</div><!-- fragment --><p>与离散化有关的成员对象在这里。</p>
<div class="fragment"><div class="line"><a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a>        <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classMappingQ1.html">MappingQ1&lt;dim&gt;</a>      mapping;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe;</div>
<div class="line"><a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>           dof_handler;</div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00314">dof_handler.h:315</a></div></div>
<div class="ttc" id="aclassMappingQ1_html"><div class="ttname"><a href="classMappingQ1.html">MappingQ1</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1_8h_source.html#l00054">mapping_q1.h:55</a></div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l01127">tria.h:1128</a></div></div>
<div class="ttc" id="ap4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
</div><!-- fragment --><p>然后，我们有与全局离散系统相关的矩阵和向量。</p>
<div class="fragment"><div class="line"><a class="code" href="classSparsityPattern.html">SparsityPattern</a>      sparsity;</div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>       solution;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>       right_hand_side;</div>
<div class="line"><a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a>  estimates;</div>
<div class="ttc" id="aclassBlockVector_html"><div class="ttname"><a href="classBlockVector.html">BlockVector</a></div><div class="ttdef"><b>Definition:</b> <a href="block__vector_8h_source.html#l00070">block_vector.h:71</a></div></div>
<div class="ttc" id="aclassSparseMatrix_html"><div class="ttname"><a href="classSparseMatrix.html">SparseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="sparsity__pattern_8h_source.html#l00868">sparsity_pattern.h:869</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdeci">@ matrix</div><div class="ttdoc">Contents is actually a matrix.</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00058">lapack_support.h:58</a></div></div>
</div><!-- fragment --><p>最后，我们有一组与多级预处理程序相关的稀疏模式和稀疏矩阵。 首先，我们有一个水平矩阵和它的稀疏性模式。</p>
<div class="fragment"><div class="line"><a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparsityPattern&gt;</a>      mg_sparsity;</div>
<div class="line"><a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix;</div>
<div class="ttc" id="aclassMGLevelObject_html"><div class="ttname"><a href="classMGLevelObject.html">MGLevelObject&lt; SparsityPattern &gt;</a></div></div>
</div><!-- fragment --><p>当我们在局部细化的网格上进行局部平滑的多网格时，需要额外的矩阵；见Kanschat（2004）。这里是这些边缘矩阵的稀疏性模式。我们只需要一个，因为上矩阵的模式是下矩阵的转置。实际上，我们并不太关心这些细节，因为MeshWorker正在填充这些矩阵。</p>
<div class="fragment"><div class="line"><a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparsityPattern&gt;</a> mg_sparsity_dg_interface;</div>
</div><!-- fragment --><p>精细化边缘的通量矩阵，将精细级的自由度与粗略级的自由度进行耦合。</p>
<div class="fragment"><div class="line"><a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix_dg_down;</div>
</div><!-- fragment --><p>细化边缘的通量矩阵的转置，将粗级自由度耦合到细级。</p>
<div class="fragment"><div class="line">  <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix_dg_up;</div>
<div class="line">};</div>
</div><!-- fragment --><p>构造函数简单地设置了粗略的网格和DoFHandler。有限元素被作为参数提供，以实现灵活性。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">InteriorPenaltyProblem&lt;dim&gt;::InteriorPenaltyProblem(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe)</div>
<div class="line">  : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>(<a class="code" href="classTriangulation.html">Triangulation</a>&lt;dim&gt;::limit_level_difference_at_vertices)</div>
<div class="line">  , mapping()</div>
<div class="line">  , fe(fe)</div>
<div class="line">  , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div>
<div class="line">  , estimates(1)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceGridGenerator.html#a5114625911496e4f51758fe00562a14a">GridGenerator::hyper_cube_slit</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, -1, 1);</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceGridGenerator_html_a5114625911496e4f51758fe00562a14a"><div class="ttname"><a href="namespaceGridGenerator.html#a5114625911496e4f51758fe00562a14a">GridGenerator::hyper_cube_slit</a></div><div class="ttdeci">void hyper_cube_slit(Triangulation&lt; dim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
</div><!-- fragment --><p>在这个函数中，我们设置了线性系统的维度和全局矩阵以及水平矩阵的稀疏模式。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::setup_system()</div>
<div class="line">{</div>
</div><!-- fragment --><p>首先，我们使用有限元将自由度分布在网格上并对其进行编号。</p>
<div class="fragment"><div class="line">dof_handler.distribute_dofs(fe);</div>
<div class="line">dof_handler.distribute_mg_dofs();</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.n_dofs();</div>
</div><!-- fragment --><p>然后，我们已经知道代表有限元函数的向量的大小。</p>
<div class="fragment"><div class="line">solution.reinit(n_dofs);</div>
<div class="line">right_hand_side.reinit(n_dofs);</div>
</div><!-- fragment --><p>接下来，我们设置全局矩阵的稀疏性模式。由于我们事先不知道行的大小，我们首先填充一个临时的DynamicSparsityPattern对象，一旦完成，就把它复制到常规的SparsityPattern。</p>
<div class="fragment"><div class="line"><a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(n_dofs);</div>
<div class="line"><a class="code" href="group__constraints.html#ga7b2627e9bde96b98d4fcf95b629e4fd4">DoFTools::make_flux_sparsity_pattern</a>(dof_handler, dsp);</div>
<div class="line">sparsity.copy_from(dsp);</div>
<div class="line"><a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>.reinit(sparsity);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_levels = <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels();</div>
<div class="ttc" id="aclassDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00318">dynamic_sparsity_pattern.h:319</a></div></div>
<div class="ttc" id="agroup__constraints_html_ga7b2627e9bde96b98d4fcf95b629e4fd4"><div class="ttname"><a href="group__constraints.html#ga7b2627e9bde96b98d4fcf95b629e4fd4">DoFTools::make_flux_sparsity_pattern</a></div><div class="ttdeci">void make_flux_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00699">dof_tools_sparsity.cc:699</a></div></div>
</div><!-- fragment --><p>全局系统已经设置好了，现在我们来处理水平矩阵。我们调整所有的矩阵对象的大小，以便每层容纳一个矩阵。</p>
<div class="fragment"><div class="line">mg_matrix.resize(0, n_levels - 1);</div>
<div class="line">mg_matrix.clear_elements();</div>
<div class="line">mg_matrix_dg_up.resize(0, n_levels - 1);</div>
<div class="line">mg_matrix_dg_up.clear_elements();</div>
<div class="line">mg_matrix_dg_down.resize(0, n_levels - 1);</div>
<div class="line">mg_matrix_dg_down.clear_elements();</div>
</div><!-- fragment --><p>在为级别矩阵调用<code>clear()</code>之后，更新稀疏模式是很重要的，因为矩阵通过SmartPointer和Subscriptor机制锁定稀疏模式。</p>
<div class="fragment"><div class="line">mg_sparsity.resize(0, n_levels - 1);</div>
<div class="line">mg_sparsity_dg_interface.resize(0, n_levels - 1);</div>
</div><!-- fragment --><p>现在，所有的对象都准备好了，每个级别持有一个稀疏模式或矩阵。剩下的就是在每个层次上设置稀疏模式了。</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> = mg_sparsity.min_level();</div>
<div class="line">     <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> &lt;= mg_sparsity.max_level();</div>
<div class="line">     ++<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>)</div>
<div class="line">  {</div>
<div class="ttc" id="agrid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
</div><!-- fragment --><p>这与上面的全局矩阵的行数大致相同，现在是为每一层设置。</p>
<div class="fragment"><div class="line"><a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>));</div>
<div class="line"><a class="code" href="namespaceMGTools.html#a1a1273930a0c3cd4a537063b26a2a95f">MGTools::make_flux_sparsity_pattern</a>(dof_handler, dsp, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>);</div>
<div class="line">mg_sparsity[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].copy_from(dsp);</div>
<div class="line">mg_matrix[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="ttc" id="anamespaceMGTools_html_a1a1273930a0c3cd4a537063b26a2a95f"><div class="ttname"><a href="namespaceMGTools.html#a1a1273930a0c3cd4a537063b26a2a95f">MGTools::make_flux_sparsity_pattern</a></div><div class="ttdeci">void make_flux_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity, const unsigned int level)</div><div class="ttdef"><b>Definition:</b> <a href="mg__tools_8cc_source.html#l00628">mg_tools.cc:628</a></div></div>
</div><!-- fragment --><p>此外，我们需要初始化各层之间细化边缘的转移矩阵。它们被存储在指代两个索引中较细的索引处，因此在第0层没有这样的对象。</p>
<div class="fragment"><div class="line">      <span class="keywordflow">if</span> (<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> &gt; 0)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp;</div>
<div class="line">          dsp.<a class="code" href="group__Sparsity.html#gaa32f9f3ebad084d001349cd3ddb4074e">reinit</a>(dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> - 1),</div>
<div class="line">                     dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>));</div>
<div class="line">          <a class="code" href="namespaceMGTools.html#aa242701df963b91f9139020fe79b1196">MGTools::make_flux_sparsity_pattern_edge</a>(dof_handler, dsp, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>);</div>
<div class="line">          mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].copy_from(dsp);</div>
<div class="line">          mg_matrix_dg_up[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="line">          mg_matrix_dg_down[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Sparsity_html_gaa32f9f3ebad084d001349cd3ddb4074e"><div class="ttname"><a href="group__Sparsity.html#gaa32f9f3ebad084d001349cd3ddb4074e">DynamicSparsityPattern::reinit</a></div><div class="ttdeci">void reinit(const size_type m, const size_type n, const IndexSet &amp;rowset=IndexSet())</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8cc_source.html#l00301">dynamic_sparsity_pattern.cc:301</a></div></div>
<div class="ttc" id="anamespaceMGTools_html_aa242701df963b91f9139020fe79b1196"><div class="ttname"><a href="namespaceMGTools.html#aa242701df963b91f9139020fe79b1196">MGTools::make_flux_sparsity_pattern_edge</a></div><div class="ttdeci">void make_flux_sparsity_pattern_edge(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity, const unsigned int level)</div><div class="ttdef"><b>Definition:</b> <a href="mg__tools_8cc_source.html#l00703">mg_tools.cc:703</a></div></div>
</div><!-- fragment --><p>在这个函数中，我们组装全局系统矩阵，这里的全局是指我们所求解的离散系统的矩阵，它覆盖整个网格。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_matrix()</div>
<div class="line">{</div>
</div><!-- fragment --><p>首先，我们需要建立一个提供积分值的对象。这个对象包含所有需要的FEValues和FEFaceValues对象，并且自动维护它们，使它们总是指向当前单元。为此，我们首先需要告诉它，在哪里计算，计算什么。由于我们没有做任何花哨的事情，我们可以依靠他们对正交规则的标准选择。 <br  />
</p>
<p>由于他们的默认更新标志是最小的，我们额外添加我们需要的东西，即所有对象（单元、边界和内部面）上的形状函数的值和梯度。之后，我们准备初始化容器，它将创建所有必要的FEValuesBase对象进行整合。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line"><a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> update_flags = <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox</a></div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00297">integration_info.h:298</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_a3bdba7e7b483b45afac9ed1e83b3038d"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">MeshWorker::IntegrationInfoBox::initialize</a></div><div class="ttdeci">void initialize(const FiniteElement&lt; dim, spacedim &gt; &amp;el, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const BlockInfo *block_info=nullptr)</div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_a7572e2216a5ce6a0f30b3df417dc90c6"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">MeshWorker::IntegrationInfoBox::add_update_flags_all</a></div><div class="ttdeci">void add_update_flags_all(const UpdateFlags flags)</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00751">integration_info.h:751</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00066">fe_update_flags.h:67</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00078">fe_update_flags.h:78</a></div></div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdeci">@ update_gradients</div><div class="ttdoc">Shape function gradients.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00084">fe_update_flags.h:84</a></div></div>
</div><!-- fragment --><p>这是我们整合本地数据的对象。它由MatrixIntegrator中的局部整合例程填充，然后由汇编器用来将信息分配到全局矩阵中。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
</div><!-- fragment --><p>此外，我们还需要一个将局部矩阵装配到全局矩阵的对象。这些装配器对象拥有目标对象结构的所有知识，在这种情况下是稀疏矩阵，可能的约束和网格结构。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html">MeshWorker::Assembler::MatrixSimple&lt;SparseMatrix&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html#a16aa7c79a160c3f8531fe77531965df6">initialize</a>(<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>);</div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1MatrixSimple_html"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html">MeshWorker::Assembler::MatrixSimple</a></div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00152">simple.h:153</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1MatrixSimple_html_a16aa7c79a160c3f8531fe77531965df6"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html#a16aa7c79a160c3f8531fe77531965df6">MeshWorker::Assembler::MatrixSimple::initialize</a></div><div class="ttdeci">void initialize(MatrixType &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00585">simple.h:585</a></div></div>
</div><!-- fragment --><p>现在是我们自己编码的部分，局部积分器。这是唯一与问题有关的部分。</p>
<div class="fragment"><div class="line">MatrixIntegrator&lt;dim&gt; integrator;</div>
</div><!-- fragment --><p>现在，我们把所有的东西都扔到一个 <a class="el" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop()</a>, 中，这个 <a class="el" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop()</a>, 遍历了网格的所有活动单元，计算单元和面的矩阵，并把它们组合成全局矩阵。我们在这里使用变量<code>dof_handler</code>，以便使用全局自由度的编号。</p>
<div class="fragment"><div class="line">  MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                         dof_handler.end(),</div>
<div class="line">                                         dof_info,</div>
<div class="line">                                         info_box,</div>
<div class="line">                                         integrator,</div>
<div class="line">                                         assembler);</div>
<div class="line">}</div>
</div><!-- fragment --><p>现在，我们对水平矩阵做同样的处理。不太令人惊讶的是，这个函数看起来像前一个函数的孪生兄弟。事实上，只有两个小的区别。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_mg_matrix()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">  <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> update_flags = <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
</div><!-- fragment --><p>很明显，需要用一个填充水平矩阵的汇编器来代替。请注意，它也会自动填充边缘矩阵。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html">MeshWorker::Assembler::MGMatrixSimple&lt;SparseMatrix&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#aba020fe5832606b5a7ec4c3c54526adb">initialize</a>(mg_matrix);</div>
<div class="line">assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#a1fce17a3ff22b59c0f023fd9a58e43f6">initialize_fluxes</a>(mg_matrix_dg_up, mg_matrix_dg_down);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">MatrixIntegrator&lt;dim&gt; integrator;</div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1MGMatrixSimple_html"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html">MeshWorker::Assembler::MGMatrixSimple</a></div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00254">simple.h:255</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1MGMatrixSimple_html_a1fce17a3ff22b59c0f023fd9a58e43f6"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#a1fce17a3ff22b59c0f023fd9a58e43f6">MeshWorker::Assembler::MGMatrixSimple::initialize_fluxes</a></div><div class="ttdeci">void initialize_fluxes(MGLevelObject&lt; MatrixType &gt; &amp;flux_up, MGLevelObject&lt; MatrixType &gt; &amp;flux_down)</div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00783">simple.h:783</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1MGMatrixSimple_html_aba020fe5832606b5a7ec4c3c54526adb"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#aba020fe5832606b5a7ec4c3c54526adb">MeshWorker::Assembler::MGMatrixSimple::initialize</a></div><div class="ttdeci">void initialize(MGLevelObject&lt; MatrixType &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00768">simple.h:768</a></div></div>
</div><!-- fragment --><p>这里是与前一个函数的另一个区别：我们在所有的单元格上运行，而不仅仅是活动单元格。而且我们使用以 <code>_mg</code> 结尾的函数，因为我们需要每一层的自由度，而不是全局的编号。</p>
<div class="fragment"><div class="line">  MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_mg(),</div>
<div class="line">                                         dof_handler.end_mg(),</div>
<div class="line">                                         dof_info,</div>
<div class="line">                                         info_box,</div>
<div class="line">                                         integrator,</div>
<div class="line">                                         assembler);</div>
<div class="line">}</div>
</div><!-- fragment --><p>这里我们有另一个assemble函数的克隆。与组装系统矩阵的区别在于，我们在这里组装了一个向量。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_right_hand_side()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">  <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a>                         update_flags =</div>
<div class="line">    <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="ttc" id="afe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00122">fe_update_flags.h:122</a></div></div>
</div><!-- fragment --><p>由于这个装配器允许我们填充多个向量，因此界面比上面的要复杂一些。向量的指针必须存储在一个AnyData对象中。虽然这在这里似乎造成了两行额外的代码，但实际上在更复杂的应用中它是很方便的。</p>
<div class="fragment"><div class="line">  <a class="code" href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html">MeshWorker::Assembler::ResidualSimple&lt;Vector&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">  <a class="code" href="classAnyData.html">AnyData</a>                                               data;</div>
<div class="line">  data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;right_hand_side, <span class="stringliteral">&quot;RHS&quot;</span>);</div>
<div class="line">  assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html#affc8d054d00d3838c2ab8d8adbd5ccb5">initialize</a>(data);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  RHSIntegrator&lt;dim&gt; integrator;</div>
<div class="line">  MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                         dof_handler.end(),</div>
<div class="line">                                         dof_info,</div>
<div class="line">                                         info_box,</div>
<div class="line">                                         integrator,</div>
<div class="line">                                         assembler);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  right_hand_side *= -1.;</div>
<div class="line">}</div>
<div class="ttc" id="aclassAnyData_html"><div class="ttname"><a href="classAnyData.html">AnyData</a></div><div class="ttdef"><b>Definition:</b> <a href="any__data_8h_source.html#l00037">any_data.h:38</a></div></div>
<div class="ttc" id="aclassAnyData_html_a5949f684f8ce7ccce9d45e65af32580c"><div class="ttname"><a href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">AnyData::add</a></div><div class="ttdeci">void add(type entry, const std::string &amp;name)</div><div class="ttdoc">Add a new data object.</div><div class="ttdef"><b>Definition:</b> <a href="any__data_8h_source.html#l00432">any_data.h:432</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1ResidualSimple_html"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html">MeshWorker::Assembler::ResidualSimple</a></div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00059">simple.h:60</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1ResidualSimple_html_affc8d054d00d3838c2ab8d8adbd5ccb5"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html#affc8d054d00d3838c2ab8d8adbd5ccb5">MeshWorker::Assembler::ResidualSimple::initialize</a></div><div class="ttdeci">void initialize(AnyData &amp;results)</div><div class="ttdef"><b>Definition:</b> <a href="simple_8h_source.html#l00513">simple.h:513</a></div></div>
</div><!-- fragment --><p>现在我们已经编码了构建离散线性系统的所有函数，现在是我们实际解决它的时候了。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::solve()</div>
<div class="line">{</div>
</div><!-- fragment --><p>所选择的求解器是共轭梯度。</p>
<div class="fragment"><div class="line"><a class="code" href="classSolverControl.html">SolverControl</a>            control(1000, 1.e-12);</div>
<div class="line"><a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(control);</div>
<div class="ttc" id="aclassSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00095">solver_cg.h:96</a></div></div>
<div class="ttc" id="aclassSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00065">solver_control.h:66</a></div></div>
</div><!-- fragment --><p>现在，我们正在设置多级预处理器的组件。首先，我们需要在网格层之间进行转移。我们在这里使用的对象为这些转移生成了稀疏矩阵。</p>
<div class="fragment"><div class="line"><a class="code" href="classMGTransferPrebuilt.html">MGTransferPrebuilt&lt;Vector&lt;double&gt;</a>&gt; mg_transfer;</div>
<div class="line">mg_transfer.<a class="code" href="classMGTransferPrebuilt.html#a305c601c3f8c17c957a5ce71c95b933a">build</a>(dof_handler);</div>
<div class="ttc" id="aclassMGTransferPrebuilt_html"><div class="ttname"><a href="classMGTransferPrebuilt.html">MGTransferPrebuilt</a></div><div class="ttdef"><b>Definition:</b> <a href="mg__transfer_8h_source.html#l00636">mg_transfer.h:637</a></div></div>
<div class="ttc" id="aclassMGTransferPrebuilt_html_a305c601c3f8c17c957a5ce71c95b933a"><div class="ttname"><a href="classMGTransferPrebuilt.html#a305c601c3f8c17c957a5ce71c95b933a">MGTransferPrebuilt::build</a></div><div class="ttdeci">void build(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler)</div><div class="ttdef"><b>Definition:</b> <a href="mg__transfer__prebuilt_8cc_source.html#l00152">mg_transfer_prebuilt.cc:152</a></div></div>
</div><!-- fragment --><p>然后，我们需要一个最粗层的矩阵的精确解算器。</p>
<div class="fragment"><div class="line"><a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> coarse_matrix;</div>
<div class="line">coarse_matrix.<a class="code" href="classFullMatrix.html#ae9e8fbf00e15c7b66d527a5de4b31404">copy_from</a>(mg_matrix[0]);</div>
<div class="line"><a class="code" href="classMGCoarseGridHouseholder.html">MGCoarseGridHouseholder&lt;double, Vector&lt;double&gt;</a>&gt; mg_coarse;</div>
<div class="line">mg_coarse.<a class="code" href="classMGCoarseGridHouseholder.html#a07bd76dc7f6f66cb22d3e7951a558f50">initialize</a>(coarse_matrix);</div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassFullMatrix_html_ae9e8fbf00e15c7b66d527a5de4b31404"><div class="ttname"><a href="classFullMatrix.html#ae9e8fbf00e15c7b66d527a5de4b31404">FullMatrix::copy_from</a></div><div class="ttdeci">void copy_from(const MatrixType &amp;)</div></div>
<div class="ttc" id="aclassMGCoarseGridHouseholder_html"><div class="ttname"><a href="classMGCoarseGridHouseholder.html">MGCoarseGridHouseholder</a></div><div class="ttdef"><b>Definition:</b> <a href="mg__coarse_8h_source.html#l00175">mg_coarse.h:176</a></div></div>
<div class="ttc" id="aclassMGCoarseGridHouseholder_html_a07bd76dc7f6f66cb22d3e7951a558f50"><div class="ttname"><a href="classMGCoarseGridHouseholder.html#a07bd76dc7f6f66cb22d3e7951a558f50">MGCoarseGridHouseholder::initialize</a></div><div class="ttdeci">void initialize(const FullMatrix&lt; number &gt; &amp;A)</div></div>
</div><!-- fragment --><p>虽然转移和粗网格求解器基本是通用的，但为平滑器提供了更多灵活性。首先，我们选择Gauss-Seidel作为我们的平滑方法。</p>
<div class="fragment"><div class="line"><a class="code" href="classGrowingVectorMemory.html">GrowingVectorMemory&lt;Vector&lt;double&gt;</a>&gt; mem;</div>
<div class="line"><span class="keyword">using</span> RELAXATION = <a class="code" href="classPreconditionSOR.html">PreconditionSOR&lt;SparseMatrix&lt;double&gt;</a>&gt;;</div>
<div class="line"><a class="code" href="classmg_1_1SmootherRelaxation.html">mg::SmootherRelaxation&lt;RELAXATION, Vector&lt;double&gt;</a>&gt; mg_smoother;</div>
<div class="line">RELAXATION::AdditionalData                         smoother_data(1.);</div>
<div class="line">mg_smoother.<a class="code" href="classmg_1_1SmootherRelaxation.html#ae9e03c626c50a1b13dffe338f5f977b0">initialize</a>(mg_matrix, smoother_data);</div>
<div class="ttc" id="aclassGrowingVectorMemory_html"><div class="ttname"><a href="classGrowingVectorMemory.html">GrowingVectorMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2lac_2vector__memory_8h_source.html#l00313">vector_memory.h:314</a></div></div>
<div class="ttc" id="aclassPreconditionSOR_html"><div class="ttname"><a href="classPreconditionSOR.html">PreconditionSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00583">precondition.h:584</a></div></div>
<div class="ttc" id="aclassmg_1_1SmootherRelaxation_html"><div class="ttname"><a href="classmg_1_1SmootherRelaxation.html">mg::SmootherRelaxation</a></div><div class="ttdef"><b>Definition:</b> <a href="mg__smoother_8h_source.html#l00183">mg_smoother.h:185</a></div></div>
<div class="ttc" id="aclassmg_1_1SmootherRelaxation_html_ae9e03c626c50a1b13dffe338f5f977b0"><div class="ttname"><a href="classmg_1_1SmootherRelaxation.html#ae9e03c626c50a1b13dffe338f5f977b0">mg::SmootherRelaxation::initialize</a></div><div class="ttdeci">void initialize(const MGLevelObject&lt; MatrixType2 &gt; &amp;matrices, const typename RelaxationType::AdditionalData &amp;additional_data=typename RelaxationType::AdditionalData())</div></div>
</div><!-- fragment --><p>在每个层次上做两个平滑步骤。</p>
<div class="fragment"><div class="line">mg_smoother.<a class="code" href="classMGSmoother.html#a9976182b6b272aac7800a8fbf18c8ab9">set_steps</a>(2);</div>
<div class="ttc" id="aclassMGSmoother_html_a9976182b6b272aac7800a8fbf18c8ab9"><div class="ttname"><a href="classMGSmoother.html#a9976182b6b272aac7800a8fbf18c8ab9">MGSmoother::set_steps</a></div><div class="ttdeci">void set_steps(const unsigned int)</div></div>
</div><!-- fragment --><p>由于SOR方法不是对称的，但我们在下面使用共轭梯度迭代，这里有一个技巧，使多级预处理器成为对称算子，即使是非对称的平滑器。</p>
<div class="fragment"><div class="line">mg_smoother.<a class="code" href="classMGSmoother.html#abed2837ee4e224f94c6a98405906df8f">set_symmetric</a>(<span class="keyword">true</span>);</div>
<div class="ttc" id="aclassMGSmoother_html_abed2837ee4e224f94c6a98405906df8f"><div class="ttname"><a href="classMGSmoother.html#abed2837ee4e224f94c6a98405906df8f">MGSmoother::set_symmetric</a></div><div class="ttdeci">void set_symmetric(const bool)</div></div>
</div><!-- fragment --><p>平滑器类可以选择实现可变的V型循环，我们在这里不希望这样。</p>
<div class="fragment"><div class="line">mg_smoother.<a class="code" href="classMGSmoother.html#ae35e1ca776c5e1ce40149510e2207f36">set_variable</a>(<span class="keyword">false</span>);</div>
<div class="ttc" id="aclassMGSmoother_html_ae35e1ca776c5e1ce40149510e2207f36"><div class="ttname"><a href="classMGSmoother.html#ae35e1ca776c5e1ce40149510e2207f36">MGSmoother::set_variable</a></div><div class="ttdeci">void set_variable(const bool)</div></div>
</div><!-- fragment --><p>最后，我们必须将我们的矩阵包裹在一个具有所需乘法函数的对象中。</p>
<div class="fragment"><div class="line"><a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgmatrix(mg_matrix);</div>
<div class="line"><a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgdown(mg_matrix_dg_down);</div>
<div class="line"><a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgup(mg_matrix_dg_up);</div>
<div class="ttc" id="aclassmg_1_1Matrix_html"><div class="ttname"><a href="classmg_1_1Matrix.html">mg::Matrix</a></div><div class="ttdef"><b>Definition:</b> <a href="mg__matrix_8h_source.html#l00044">mg_matrix.h:45</a></div></div>
</div><!-- fragment --><p>现在，我们已经准备好设置V型循环算子和多级预处理程序。</p>
<div class="fragment"><div class="line"><a class="code" href="classMultigrid.html">Multigrid&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="namespacemg.html">mg</a>(</div>
<div class="line">  mgmatrix, mg_coarse, mg_transfer, mg_smoother, mg_smoother);</div>
<div class="ttc" id="aclassMultigrid_html"><div class="ttname"><a href="classMultigrid.html">Multigrid</a></div><div class="ttdef"><b>Definition:</b> <a href="multigrid_8h_source.html#l00152">multigrid.h:153</a></div></div>
<div class="ttc" id="anamespacemg_html"><div class="ttname"><a href="namespacemg.html">mg</a></div><div class="ttdef"><b>Definition:</b> <a href="mg_8h_source.html#l00081">mg.h:82</a></div></div>
</div><!-- fragment --><p>我们不要忘记由于自适应细化而需要的边缘矩阵。</p>
<div class="fragment"><div class="line"><a class="code" href="namespacemg.html">mg</a>.set_edge_flux_matrices(mgdown, mgup);</div>
</div><!-- fragment --><p>在所有准备工作完成后，将多网格对象包裹到另一个对象中，该对象可作为常规预处理程序使用。</p>
<div class="fragment"><div class="line"><a class="code" href="classPreconditionMG.html">PreconditionMG&lt;dim, Vector&lt;double&gt;</a>, <a class="code" href="classMGTransferPrebuilt.html">MGTransferPrebuilt&lt;Vector&lt;double&gt;</a>&gt;&gt;</div>
<div class="line">  preconditioner(dof_handler, <a class="code" href="namespacemg.html">mg</a>, mg_transfer);</div>
<div class="ttc" id="aclassPreconditionMG_html"><div class="ttname"><a href="classPreconditionMG.html">PreconditionMG</a></div><div class="ttdef"><b>Definition:</b> <a href="multigrid_8h_source.html#l00467">multigrid.h:468</a></div></div>
</div><!-- fragment --><p>并使用它来解决系统。</p>
<div class="fragment"><div class="line">  solver.solve(<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, solution, right_hand_side, preconditioner);</div>
<div class="line">}</div>
</div><!-- fragment --><p>另一个集合函数的克隆。与之前的函数最大的不同是，这里我们也有一个输入向量。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">double</span> InteriorPenaltyProblem&lt;dim&gt;::estimate()</div>
<div class="line">{</div>
</div><!-- fragment --><p>估算器的结果被存储在一个每个单元格有一个条目的向量中。由于deal.II中的单元格没有编号，我们必须建立自己的编号，以便使用这个向量。对于下面使用的汇编器来说，结果存储在向量的哪个分量中的信息是由每个单元的user_index变量传送的。我们需要在这里设置这个编号。 <br  />
</p>
<p>另一方面，有人可能已经使用了用户指数。所以，让我们做个好公民，在篡改它们之前保存它们。</p>
<div class="fragment"><div class="line">std::vector&lt;unsigned int&gt; old_user_indices;</div>
<div class="line"><a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.save_user_indices(old_user_indices);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">estimates.block(0).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div>
<div class="line">  cell-&gt;set_user_index(i++);</div>
</div><!-- fragment --><p>这就像以前一样开始了。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  n_gauss_points =</div>
<div class="line">  dof_handler.get_fe().tensor_degree() + 1;</div>
<div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a2ccc96521da795a762213a979c581138">initialize_gauss_quadrature</a>(n_gauss_points,</div>
<div class="line">                                     n_gauss_points + 1,</div>
<div class="line">                                     n_gauss_points);</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_a2ccc96521da795a762213a979c581138"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#a2ccc96521da795a762213a979c581138">MeshWorker::IntegrationInfoBox::initialize_gauss_quadrature</a></div><div class="ttdeci">void initialize_gauss_quadrature(unsigned int n_cell_points, unsigned int n_boundary_points, unsigned int n_face_points, const bool force=true)</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00735">integration_info.h:735</a></div></div>
</div><!-- fragment --><p>但现在我们需要通知信息框我们要在正交点上评估的有限元函数。首先，我们用这个向量创建一个AnyData对象，它是我们刚刚计算的解决方案。</p>
<div class="fragment"><div class="line"><a class="code" href="classAnyData.html">AnyData</a> solution_data;</div>
<div class="line">solution_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;solution, <span class="stringliteral">&quot;solution&quot;</span>);</div>
</div><!-- fragment --><p>然后，我们告诉单元格的 Meshworker::VectorSelector ，我们需要这个解的二阶导数（用来计算拉普拉斯的）。因此，选择函数值和一阶导数的布尔参数为假，只有选择二阶导数的最后一个参数为真。</p>
<div class="fragment"><div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#ac2d837236f8a481331a3b5fb9f28898d">cell_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_ac2d837236f8a481331a3b5fb9f28898d"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#ac2d837236f8a481331a3b5fb9f28898d">MeshWorker::IntegrationInfoBox::cell_selector</a></div><div class="ttdeci">MeshWorker::VectorSelector cell_selector</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00489">integration_info.h:489</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1VectorSelector_html_aef1fc2a6ae5d2f756a72e8d2557972a8"><div class="ttname"><a href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">MeshWorker::VectorSelector::add</a></div><div class="ttdeci">void add(const std::string &amp;name, const bool values=true, const bool gradients=false, const bool hessians=false)</div><div class="ttdef"><b>Definition:</b> <a href="vector__selector_8h_source.html#l00420">vector_selector.h:420</a></div></div>
</div><!-- fragment --><p>在内部和边界面，我们需要函数值和第一导数，但不需要第二导数。</p>
<div class="fragment"><div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7d704e8c204409401eccbd3ffbade4e0">boundary_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae8e0b03e68c8f78090033b22ae7c4f8">face_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_a7d704e8c204409401eccbd3ffbade4e0"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#a7d704e8c204409401eccbd3ffbade4e0">MeshWorker::IntegrationInfoBox::boundary_selector</a></div><div class="ttdeci">MeshWorker::VectorSelector boundary_selector</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00495">integration_info.h:495</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_aae8e0b03e68c8f78090033b22ae7c4f8"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#aae8e0b03e68c8f78090033b22ae7c4f8">MeshWorker::IntegrationInfoBox::face_selector</a></div><div class="ttdeci">MeshWorker::VectorSelector face_selector</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00501">integration_info.h:501</a></div></div>
</div><!-- fragment --><p>我们继续像以前一样，除了默认的更新标志已经被调整为我们上面要求的值和导数之外。</p>
<div class="fragment"><div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aefd53d6be1d70953af6dca9090310d24">add_update_flags_boundary</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping, solution_data, solution);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_aefd53d6be1d70953af6dca9090310d24"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#aefd53d6be1d70953af6dca9090310d24">MeshWorker::IntegrationInfoBox::add_update_flags_boundary</a></div><div class="ttdeci">void add_update_flags_boundary(const UpdateFlags flags)</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00767">integration_info.h:767</a></div></div>
</div><!-- fragment --><p>汇编器在每个单元格中存储一个数字，否则这与计算右手边的情况相同。</p>
<div class="fragment"><div class="line"><a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html">MeshWorker::Assembler::CellsAndFaces&lt;double&gt;</a> assembler;</div>
<div class="line"><a class="code" href="classAnyData.html">AnyData</a>                                      out_data;</div>
<div class="line">out_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> *&gt;(&amp;estimates, <span class="stringliteral">&quot;cells&quot;</span>);</div>
<div class="line">assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html#a79b368b14edd85f14b30e8efad299279">initialize</a>(out_data, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">Estimator&lt;dim&gt; integrator;</div>
<div class="line">MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                       dof_handler.end(),</div>
<div class="line">                                       dof_info,</div>
<div class="line">                                       info_box,</div>
<div class="line">                                       integrator,</div>
<div class="line">                                       assembler);</div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1CellsAndFaces_html"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html">MeshWorker::Assembler::CellsAndFaces</a></div><div class="ttdef"><b>Definition:</b> <a href="functional_8h_source.html#l00106">functional.h:107</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1Assembler_1_1CellsAndFaces_html_a79b368b14edd85f14b30e8efad299279"><div class="ttname"><a href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html#a79b368b14edd85f14b30e8efad299279">MeshWorker::Assembler::CellsAndFaces::initialize</a></div><div class="ttdeci">void initialize(AnyData &amp;results, bool separate_faces=true)</div><div class="ttdef"><b>Definition:</b> <a href="functional_8h_source.html#l00231">functional.h:231</a></div></div>
</div><!-- fragment --><p>就在我们返回误差估计的结果之前，我们恢复了旧的用户索引。</p>
<div class="fragment"><div class="line">  <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.load_user_indices(old_user_indices);</div>
<div class="line">  <span class="keywordflow">return</span> estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).l2_norm();</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Exceptions_html_gae05a0e26814f032473ed2ef66da018bd"><div class="ttname"><a href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">BlockVectorBase::block</a></div><div class="ttdeci">BlockType &amp; block(const unsigned int i)</div></div>
</div><!-- fragment --><p>这里我们将我们的有限元解与（已知的）精确解进行比较，计算梯度和函数本身的平均二次误差。这个函数是上面那个估计函数的克隆。</p>
<p>由于我们分别计算能量和<em>L<sup>2</sup></em>-norm的误差，我们的块向量在这里需要两个块。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::error()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> errors(2);</div>
<div class="line">  errors.block(0).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line">  errors.block(1).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  std::vector&lt;unsigned int&gt; old_user_indices;</div>
<div class="line">  <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.save_user_indices(old_user_indices);</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div>
<div class="line">    cell-&gt;set_user_index(i++);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  n_gauss_points =</div>
<div class="line">    dof_handler.get_fe().tensor_degree() + 1;</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a2ccc96521da795a762213a979c581138">initialize_gauss_quadrature</a>(n_gauss_points,</div>
<div class="line">                                       n_gauss_points + 1,</div>
<div class="line">                                       n_gauss_points);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classAnyData.html">AnyData</a> solution_data;</div>
<div class="line">  solution_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;solution, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#ac2d837236f8a481331a3b5fb9f28898d">cell_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7d704e8c204409401eccbd3ffbade4e0">boundary_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae8e0b03e68c8f78090033b22ae7c4f8">face_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae049a9cef81c6fcd743c3681e53d008">add_update_flags_cell</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aefd53d6be1d70953af6dca9090310d24">add_update_flags_boundary</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">  info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping, solution_data, solution);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html">MeshWorker::Assembler::CellsAndFaces&lt;double&gt;</a> assembler;</div>
<div class="line">  <a class="code" href="classAnyData.html">AnyData</a>                                      out_data;</div>
<div class="line">  out_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> *&gt;(&amp;errors, <span class="stringliteral">&quot;cells&quot;</span>);</div>
<div class="line">  assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html#a79b368b14edd85f14b30e8efad299279">initialize</a>(out_data, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  ErrorIntegrator&lt;dim&gt; integrator;</div>
<div class="line">  MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                         dof_handler.end(),</div>
<div class="line">                                         dof_info,</div>
<div class="line">                                         info_box,</div>
<div class="line">                                         integrator,</div>
<div class="line">                                         assembler);</div>
<div class="line">  <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.load_user_indices(old_user_indices);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;energy-error: &quot;</span> &lt;&lt; errors.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).l2_norm() &lt;&lt; std::endl;</div>
<div class="line">  <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;L2-error:     &quot;</span> &lt;&lt; errors.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(1).l2_norm() &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfoBox_html_aae049a9cef81c6fcd743c3681e53d008"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfoBox.html#aae049a9cef81c6fcd743c3681e53d008">MeshWorker::IntegrationInfoBox::add_update_flags_cell</a></div><div class="ttdeci">void add_update_flags_cell(const UpdateFlags flags)</div><div class="ttdef"><b>Definition:</b> <a href="integration__info_8h_source.html#l00759">integration_info.h:759</a></div></div>
<div class="ttc" id="alogstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
</div><!-- fragment --><p>创建图形输出。我们通过整理其各个组成部分的名称来产生文件名，包括我们用两位数输出的细化周期。</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">InteriorPenaltyProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> std::string filename =</div>
<div class="line">    <span class="stringliteral">&quot;sol-&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(cycle, 2) + <span class="stringliteral">&quot;.gnuplot&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Writing solution to &lt;&quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;&gt;...&quot;</span> &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">  std::ofstream gnuplot_output(filename);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a>(dof_handler);</div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(solution, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0), <span class="stringliteral">&quot;est&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  data_out.<a class="code" href="group__Exceptions.html#ga85407e870a68179ebe62410d9efc153f">write_gnuplot</a>(gnuplot_output);</div>
<div class="line">}</div>
<div class="ttc" id="aclassDataOut__DoFData_html_ac1eb26168177faa30ffbcf9cbb9c3cd5"><div class="ttname"><a href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandlerType &amp;)</div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_ace4b76e565ba0701c4d32c26075ed3b9"><div class="ttname"><a href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l01087">data_out_dof_data.h:1087</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00147">data_out.h:150</a></div></div>
<div class="ttc" id="aclassDataOut_html_a5eb51872b8736849bb7e8d2007fae086"><div class="ttname"><a href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01085">data_out.cc:1085</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga85407e870a68179ebe62410d9efc153f"><div class="ttname"><a href="group__Exceptions.html#ga85407e870a68179ebe62410d9efc153f">DataOutInterface::write_gnuplot</a></div><div class="ttdeci">void write_gnuplot(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07112">data_out_base.cc:7112</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
</div><!-- fragment --><p>最后是自适应循环，或多或少与前面的例子一样。</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">InteriorPenaltyProblem&lt;dim&gt;::run</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_steps)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Element: &quot;</span> &lt;&lt; fe.get_name() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 0; s &lt; n_steps; ++s)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Step &quot;</span> &lt;&lt; s &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">if</span> (estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).size() == 0)</div>
<div class="line">          <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(1);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridRefinement.html#ae90dc87c4db158b8d01f6d564ac614e5">GridRefinement::refine_and_coarsen_fixed_fraction</a>(</div>
<div class="line">              <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0), 0.5, 0.0);</div>
<div class="line">            <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.execute_coarsening_and_refinement();</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Triangulation &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; cells, &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels() &lt;&lt; <span class="stringliteral">&quot; levels&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        setup_system();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;DoFHandler &quot;</span> &lt;&lt; dof_handler.n_dofs() &lt;&lt; <span class="stringliteral">&quot; dofs, level dofs&quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> &lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels(); ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div>
<div class="line">          <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; dof_handler.n_dofs(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>);</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble matrix&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_matrix();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble multilevel matrix&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_mg_matrix();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble right hand side&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_right_hand_side();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Solve&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        solve();</div>
<div class="line">        error();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Estimate &quot;</span> &lt;&lt; estimate() &lt;&lt; std::endl;</div>
<div class="line">        output_results(s);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step39</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span>Step39;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(2);</div>
<div class="line">      std::ofstream logfile(<span class="stringliteral">&quot;deallog&quot;</span>);</div>
<div class="line">      <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a609671be1ee6882b9df6a1383311241e">attach</a>(logfile);</div>
<div class="line">      <a class="code" href="classFE__DGQ.html">FE_DGQ&lt;2&gt;</a>                 fe1(3);</div>
<div class="line">      InteriorPenaltyProblem&lt;2&gt; test1(fe1);</div>
<div class="line">      test1.run(12);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__dgq_8h_source.html#l00110">fe_dgq.h:111</a></div></div>
<div class="ttc" id="aclassLogStream_html_a609671be1ee6882b9df6a1383311241e"><div class="ttname"><a href="classLogStream.html#a609671be1ee6882b9df6a1383311241e">LogStream::attach</a></div><div class="ttdeci">void attach(std::ostream &amp;o, const bool print_job_id=true, const std::ios_base::fmtflags flags=std::ios::showpoint|std::ios::left)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00219">logstream.cc:219</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="anamespaceGridRefinement_html_ae90dc87c4db158b8d01f6d564ac614e5"><div class="ttname"><a href="namespaceGridRefinement.html#ae90dc87c4db158b8d01f6d564ac614e5">GridRefinement::refine_and_coarsen_fixed_fraction</a></div><div class="ttdeci">void refine_and_coarsen_fixed_fraction(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double top_fraction, const double bottom_fraction, const unsigned int max_n_cells=std::numeric_limits&lt; unsigned int &gt;::max(), const VectorTools::NormType norm_type=VectorTools::NormType::L1_norm)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00390">grid_refinement.cc:390</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_adb1b44ad6f1741fbbbecc43f95d26baf"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">Physics::Elasticity::Kinematics::l</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; l(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
</div><!-- fragment --><p><a class="anchor" id="Results"></a></p><h1>Results</h1>
<p><a class="anchor" id="Logfileoutput"></a></p><h3>Logfile output</h3>
<p>首先，该程序产生通常的日志文件，在这里存储在<code>deallog</code>。它的内容是（省略了中间的步骤</p>
<div class="fragment"><div class="line">DEAL::Element: <a class="code" href="classFE__DGQ.html">FE_DGQ&lt;2&gt;</a>(3)</div>
<div class="line">DEAL::Step 0</div>
<div class="line">DEAL::<a class="code" href="classTriangulation.html">Triangulation</a> 16 cells, 2 levels</div>
<div class="line">DEAL::<a class="code" href="classDoFHandler.html">DoFHandler</a> 256 dofs, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> dofs 64 256</div>
<div class="line">DEAL::Assemble <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble multilevel <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble right hand side</div>
<div class="line">DEAL::Solve</div>
<div class="line">DEAL:cg::Starting value 37.4071</div>
<div class="line">DEAL:cg::Convergence step 13 value 1.64974<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-13</div>
<div class="line">DEAL::energy-error: 0.297419</div>
<div class="line">DEAL::<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a>-error:     0.00452447</div>
<div class="line">DEAL::Estimate 0.990460</div>
<div class="line">DEAL::Writing solution to &lt;sol-00.<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a>&gt;...</div>
<div class="line">DEAL::</div>
<div class="line">DEAL::Step 1</div>
<div class="line">DEAL::<a class="code" href="classTriangulation.html">Triangulation</a> 25 cells, 3 levels</div>
<div class="line">DEAL::<a class="code" href="classDoFHandler.html">DoFHandler</a> 400 dofs, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> dofs 64 256 192</div>
<div class="line">DEAL::Assemble <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble multilevel <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble right hand side</div>
<div class="line">DEAL::Solve</div>
<div class="line">DEAL:cg::Starting value 37.4071</div>
<div class="line">DEAL:cg::Convergence step 14 value 3.72262<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-13</div>
<div class="line">DEAL::energy-error: 0.258559</div>
<div class="line">DEAL::<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a>-error:     0.00288510</div>
<div class="line">DEAL::Estimate 0.738624</div>
<div class="line">DEAL::Writing solution to &lt;sol-01.<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a>&gt;...</div>
<div class="line">DEAL::</div>
<div class="line">DEAL::Step 2</div>
<div class="line">DEAL::<a class="code" href="classTriangulation.html">Triangulation</a> 34 cells, 4 levels</div>
<div class="line">DEAL::<a class="code" href="classDoFHandler.html">DoFHandler</a> 544 dofs, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> dofs 64 256 256 128</div>
<div class="line">DEAL::Assemble <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble multilevel <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble right hand side</div>
<div class="line">DEAL::Solve</div>
<div class="line">DEAL:cg::Starting value 37.4071</div>
<div class="line">DEAL:cg::Convergence step 15 value 1.91610<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-13</div>
<div class="line">DEAL::energy-error: 0.189234</div>
<div class="line">DEAL::<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a>-error:     0.00147954</div>
<div class="line">DEAL::Estimate 0.657507</div>
<div class="line">DEAL::Writing solution to &lt;sol-02.<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a>&gt;...</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">DEAL::Step 10</div>
<div class="line">DEAL::<a class="code" href="classTriangulation.html">Triangulation</a> 232 cells, 11 levels</div>
<div class="line">DEAL::<a class="code" href="classDoFHandler.html">DoFHandler</a> 3712 dofs, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> dofs 64 256 896 768 768 640 512 256 256 256 256</div>
<div class="line">DEAL::Assemble <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble multilevel <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble right hand side</div>
<div class="line">DEAL::Solve</div>
<div class="line">DEAL:cg::Starting value 51.1571</div>
<div class="line">DEAL:cg::Convergence step 15 value 7.19599<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-13</div>
<div class="line">DEAL::energy-error: 0.0132475</div>
<div class="line">DEAL::<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a>-error:     1.00423<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-05</div>
<div class="line">DEAL::Estimate 0.0470724</div>
<div class="line">DEAL::Writing solution to &lt;sol-10.<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a>&gt;...</div>
<div class="line">DEAL::</div>
<div class="line">DEAL::Step 11</div>
<div class="line">DEAL::<a class="code" href="classTriangulation.html">Triangulation</a> 322 cells, 12 levels</div>
<div class="line">DEAL::<a class="code" href="classDoFHandler.html">DoFHandler</a> 5152 dofs, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> dofs 64 256 1024 1024 896 768 768 640 448 320 320 320</div>
<div class="line">DEAL::Assemble <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble multilevel <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div>
<div class="line">DEAL::Assemble right hand side</div>
<div class="line">DEAL::Solve</div>
<div class="line">DEAL:cg::Starting value 52.2226</div>
<div class="line">DEAL:cg::Convergence step 15 value 8.15195<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-13</div>
<div class="line">DEAL::energy-error: 0.00934891</div>
<div class="line">DEAL::<a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a>-error:     5.41095<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-06</div>
<div class="line">DEAL::Estimate 0.0329102</div>
<div class="line">DEAL::Writing solution to &lt;sol-11.<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a>&gt;...</div>
<div class="line">DEAL::</div>
<div class="ttc" id="agroup__Exceptions_html_gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1"><div class="ttname"><a href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">DataOutBase::gnuplot</a></div><div class="ttdeci">@ gnuplot</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01570">data_out_base.h:1570</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1L2_html_a0a7d7409a5f53485a841a33fda68d916"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">LocalIntegrators::L2::L2</a></div><div class="ttdeci">void L2(Vector&lt; number &gt; &amp;result, const FEValuesBase&lt; dim &gt; &amp;fe, const std::vector&lt; double &gt; &amp;input, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00160">l2.h:160</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
</div><!-- fragment --><p>例如，这个日志显示共轭梯度迭代步骤的数量恒定在大约15个。</p>
<p><a class="anchor" id="Postprocessingofthelogfile"></a></p><h3>Postprocessing of the logfile</h3>
<p><img src="https://www.dealii.org/images/steps/developer/step-39-convergence.svg" alt="" style="pointer-events: none;" class="inline"/> 使用perl脚本<code>postprocess.pl</code>，我们将相关数据提取到<code>output.dat</code>，可以用<code>gnuplot</code>绘制图表。例如，上面的图是用gnuplot脚本<code>plot_errors.gpl</code>制作的，通过</p>
<div class="fragment"><div class="line">perl postprocess.pl <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &amp;&gt; output.dat</div>
<div class="line"><a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1a025233c1a8124e5521952c7c7cd78df1">gnuplot</a> plot_errors.gpl</div>
</div><!-- fragment --><p>参考数据可以在<code>output.reference.dat</code>中找到。<a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2010 - 2020 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Guido Kanschat, Texas A&amp;M University, 2009</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dynamic__sparsity__pattern_8h.html">deal.II/lac/dynamic_sparsity_pattern.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="precondition__block_8h.html">deal.II/lac/precondition_block.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="block__vector_8h.html">deal.II/lac/block_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__refinement_8h.html">deal.II/grid/grid_refinement.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__dgp_8h.html">deal.II/fe/fe_dgp.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="meshworker_2dof__info_8h.html">deal.II/meshworker/dof_info.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="integration__info_8h.html">deal.II/meshworker/integration_info.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="assembler_8h.html">deal.II/meshworker/assembler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="loop_8h.html">deal.II/meshworker/loop.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="laplace_8h.html">deal.II/integrators/laplace.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__tools_8h.html">deal.II/multigrid/mg_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="multigrid_8h.html">deal.II/multigrid/multigrid.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__matrix_8h.html">deal.II/multigrid/mg_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__transfer_8h.html">deal.II/multigrid/mg_transfer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__coarse_8h.html">deal.II/multigrid/mg_coarse.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mg__smoother_8h.html">deal.II/multigrid/mg_smoother.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="function__lib_8h.html">deal.II/base/function_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>Step39</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFunctions_1_1SlitSingularityFunction.html">Functions::SlitSingularityFunction&lt;2&gt;</a> exact_solution;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>MatrixIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">         boundary(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">              <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::cell(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">LocalIntegrators::Laplace::cell_matrix</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">                                           info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0).get_fe().tensor_degree();</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#af88167a13d65d1367d093a798a847263">LocalIntegrators::Laplace::nitsche_matrix</a>(</div>
<div class="line">      dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">      info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">      <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty</a>(dinfo, dinfo, degree, degree));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::face(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0).get_fe().tensor_degree();</div>
<div class="line">    <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#acf43744b2ca29cbf871cf63054bd3436">LocalIntegrators::Laplace::ip_matrix</a>(</div>
<div class="line">      dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">      dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">true</span>).matrix,</div>
<div class="line">      dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">true</span>).matrix,</div>
<div class="line">      dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0, <span class="keyword">false</span>).matrix,</div>
<div class="line">      info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">      info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">      <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#aa920ce4642983b9cb2fbf996b75d3c52">LocalIntegrators::Laplace::compute_penalty</a>(</div>
<div class="line">        dinfo1, dinfo2, degree, degree));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>RHSIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">         boundary(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">              <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  RHSIntegrator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                           <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> RHSIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe           = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;         local_vector = dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a13d325f993aa366ce5f837f37d96a90b">vector</a>(0).block(0);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;double&gt; boundary_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">    exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), boundary_values);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                           dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div>
<div class="line">        local_vector(i) +=</div>
<div class="line">          (-penalty * fe.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, k)              <span class="comment">// (-sigma * v_i(x_k)</span></div>
<div class="line">           + fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * fe.<a class="code" href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">shape_grad</a>(i, k)) <span class="comment">// + n * grad v_i(x_k))</span></div>
<div class="line">          * boundary_values[k] * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);             <span class="comment">// u^D(x_k) * dx</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  RHSIntegrator&lt;dim&gt;::face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                           <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                           <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;,</div>
<div class="line">                           <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>Estimator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">         boundary(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">              <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  Estimator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                       <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;2, dim&gt;&gt; &amp;DDuh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a17bb3b94327dbbe22c0c3a57076f3b80">hessians</a>[0][0];</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> t = dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;diameter() * <a class="code" href="symmetric__tensor_8h.html#a4248760c880275bab1f288fc80f27039">trace</a>(DDuh[k]);</div>
<div class="line">        dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += t * t * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> Estimator&lt;dim&gt;::boundary(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;double&gt; boundary_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">    exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), boundary_values);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                           dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff = boundary_values[k] - uh[k];</div>
<div class="line">        dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += penalty * diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  Estimator&lt;dim&gt;::face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">                       <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">                       <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">                       <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;          fe   = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh1  = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh2  = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh1 = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh2 = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>       penalty1 =</div>
<div class="line">      degree * (degree + 1) * dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty2 =</div>
<div class="line">      degree * (degree + 1) * dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = penalty1 + penalty2;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> h       = dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff1 = uh1[k] - uh2[k];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff2 =</div>
<div class="line">          fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * Duh1[k] - fe.<a class="code" href="classFEValuesBase.html#ac25ec6835799c3b6c7c842f8acb05eb3">normal_vector</a>(k) * Duh2[k];</div>
<div class="line">        dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) +=</div>
<div class="line">          (penalty * diff1 * diff1 + h * diff2 * diff2) * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">    dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ErrorIntegrator : <span class="keyword">public</span> <a class="code" href="classMeshWorker_1_1LocalIntegrator.html">MeshWorker::LocalIntegrator</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">         boundary(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">                  <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info) <span class="keyword">const override</span>;</div>
<div class="line">    <span class="keywordtype">void</span> face(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">              <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">              <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::cell(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;   fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">    std::vector&lt;Tensor&lt;1, dim&gt;&gt; exact_gradients(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">    std::vector&lt;double&gt;         exact_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">    exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#af86d98b6e5fb169e556e71e33de2ca2b">gradient_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_gradients);</div>
<div class="line">    exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_values);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;Duh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#aa1260e7eaafa7f7455cb98d1b110383b">gradients</a>[0][0];</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        uh  = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_gradients[k][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] - Duh[k][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div>
<div class="line">            <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> += diff * diff;</div>
<div class="line">          }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_values[k] - uh[k];</div>
<div class="line">        dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">        dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1) += diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(1));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::boundary(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;fe = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;double&gt; exact_values(fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div>
<div class="line">    exact_solution.<a class="code" href="classFunctions_1_1SlitSingularityFunction.html#a3f0ece56f98717e112cb3c4b0c96aa2d">value_list</a>(fe.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), exact_values);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh = info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = 2. * degree * (degree + 1) * dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() /</div>
<div class="line">                           dinfo.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff = exact_values[k] - uh[k];</div>
<div class="line">        dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += penalty * diff * diff * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> ErrorIntegrator&lt;dim&gt;::face(</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo1,</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> &amp;                 dinfo2,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info1,</div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info2)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a> &amp;  fe  = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>();</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh1 = info1.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;double&gt; &amp;uh2 = info2.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#afb909cb1bef4fa870b7cc10f3fe6da49">values</a>[0][0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = fe.<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>().<a class="code" href="classFiniteElementData.html#a584a56a1611a86a04c8b9a26d0eb9f27">tensor_degree</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>       penalty1 =</div>
<div class="line">      degree * (degree + 1) * dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo1.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty2 =</div>
<div class="line">      degree * (degree + 1) * dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#abe132f9c608609ab4cd529548b3fc8f5">face</a>-&gt;measure() / dinfo2.<a class="code" href="classMeshWorker_1_1DoFInfo.html#acdb25148428f90647ca6c6166e212ffa">cell</a>-&gt;measure();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty = penalty1 + penalty2;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; fe.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++k)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> diff = uh1[k] - uh2[k];</div>
<div class="line">        dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) += (penalty * diff * diff) * fe.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(k);</div>
<div class="line">      }</div>
<div class="line">    dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = <a class="code" href="numbers_8h.html#ac4a2ed1890a931d0b6a55933310eadca">std::sqrt</a>(dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0));</div>
<div class="line">    dinfo2.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0) = dinfo1.<a class="code" href="classMeshWorker_1_1LocalResults.html#aff764a87d095e5266364c578ff2b0757">value</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>InteriorPenaltyProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">using</span> CellInfo = <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    InteriorPenaltyProblem(<span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_steps);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span>   setup_system();</div>
<div class="line">    <span class="keywordtype">void</span>   assemble_matrix();</div>
<div class="line">    <span class="keywordtype">void</span>   assemble_mg_matrix();</div>
<div class="line">    <span class="keywordtype">void</span>   assemble_right_hand_side();</div>
<div class="line">    <span class="keywordtype">void</span>   error();</div>
<div class="line">    <span class="keywordtype">double</span> estimate();</div>
<div class="line">    <span class="keywordtype">void</span>   solve();</div>
<div class="line">    <span class="keywordtype">void</span>   output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a>        <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMappingQ1.html">MappingQ1&lt;dim&gt;</a>      mapping;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>           dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a>      sparsity;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>       solution;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>       right_hand_side;</div>
<div class="line">    <a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a>  estimates;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparsityPattern&gt;</a>      mg_sparsity;</div>
<div class="line">    <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparsityPattern&gt;</a> mg_sparsity_dg_interface;</div>
<div class="line">    <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix_dg_down;</div>
<div class="line">    <a class="code" href="classMGLevelObject.html">MGLevelObject&lt;SparseMatrix&lt;double&gt;</a>&gt; mg_matrix_dg_up;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  InteriorPenaltyProblem&lt;dim&gt;::InteriorPenaltyProblem(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim&gt;</a> &amp;fe)</div>
<div class="line">    : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>(<a class="code" href="classTriangulation.html">Triangulation</a>&lt;dim&gt;::limit_level_difference_at_vertices)</div>
<div class="line">    , mapping()</div>
<div class="line">    , fe(fe)</div>
<div class="line">    , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div>
<div class="line">    , estimates(1)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#a5114625911496e4f51758fe00562a14a">GridGenerator::hyper_cube_slit</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, -1, 1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::setup_system()</div>
<div class="line">  {</div>
<div class="line">    dof_handler.distribute_dofs(fe);</div>
<div class="line">    dof_handler.distribute_mg_dofs();</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.n_dofs();</div>
<div class="line">    solution.reinit(n_dofs);</div>
<div class="line">    right_hand_side.reinit(n_dofs);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(n_dofs);</div>
<div class="line">    <a class="code" href="group__constraints.html#ga7b2627e9bde96b98d4fcf95b629e4fd4">DoFTools::make_flux_sparsity_pattern</a>(dof_handler, dsp);</div>
<div class="line">    sparsity.copy_from(dsp);</div>
<div class="line">    <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>.reinit(sparsity);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_levels = <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels();</div>
<div class="line">    mg_matrix.resize(0, n_levels - 1);</div>
<div class="line">    mg_matrix.clear_elements();</div>
<div class="line">    mg_matrix_dg_up.resize(0, n_levels - 1);</div>
<div class="line">    mg_matrix_dg_up.clear_elements();</div>
<div class="line">    mg_matrix_dg_down.resize(0, n_levels - 1);</div>
<div class="line">    mg_matrix_dg_down.clear_elements();</div>
<div class="line">    mg_sparsity.resize(0, n_levels - 1);</div>
<div class="line">    mg_sparsity_dg_interface.resize(0, n_levels - 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> = mg_sparsity.min_level();</div>
<div class="line">         <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> &lt;= mg_sparsity.max_level();</div>
<div class="line">         ++<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>));</div>
<div class="line">        <a class="code" href="namespaceMGTools.html#a1a1273930a0c3cd4a537063b26a2a95f">MGTools::make_flux_sparsity_pattern</a>(dof_handler, dsp, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>);</div>
<div class="line">        mg_sparsity[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].copy_from(dsp);</div>
<div class="line">        mg_matrix[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> &gt; 0)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp;</div>
<div class="line">            dsp.<a class="code" href="group__Sparsity.html#gaa32f9f3ebad084d001349cd3ddb4074e">reinit</a>(dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> - 1),</div>
<div class="line">                       dof_handler.n_dofs(<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>));</div>
<div class="line">            <a class="code" href="namespaceMGTools.html#aa242701df963b91f9139020fe79b1196">MGTools::make_flux_sparsity_pattern_edge</a>(dof_handler, dsp, <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>);</div>
<div class="line">            mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].copy_from(dsp);</div>
<div class="line">            mg_matrix_dg_up[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="line">            mg_matrix_dg_down[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>].reinit(mg_sparsity_dg_interface[<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a>]);</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_matrix()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">    <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> update_flags = <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html">MeshWorker::Assembler::MatrixSimple&lt;SparseMatrix&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MatrixSimple.html#a16aa7c79a160c3f8531fe77531965df6">initialize</a>(<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>);</div>
<div class="line"> </div>
<div class="line">    MatrixIntegrator&lt;dim&gt; integrator;</div>
<div class="line">    MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                           dof_handler.end(),</div>
<div class="line">                                           dof_info,</div>
<div class="line">                                           info_box,</div>
<div class="line">                                           integrator,</div>
<div class="line">                                           assembler);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_mg_matrix()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">    <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> update_flags = <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html">MeshWorker::Assembler::MGMatrixSimple&lt;SparseMatrix&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#aba020fe5832606b5a7ec4c3c54526adb">initialize</a>(mg_matrix);</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1MGMatrixSimple.html#a1fce17a3ff22b59c0f023fd9a58e43f6">initialize_fluxes</a>(mg_matrix_dg_up, mg_matrix_dg_down);</div>
<div class="line"> </div>
<div class="line">    MatrixIntegrator&lt;dim&gt; integrator;</div>
<div class="line">    MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_mg(),</div>
<div class="line">                                           dof_handler.end_mg(),</div>
<div class="line">                                           dof_info,</div>
<div class="line">                                           info_box,</div>
<div class="line">                                           integrator,</div>
<div class="line">                                           assembler);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::assemble_right_hand_side()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">    <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a>                         update_flags =</div>
<div class="line">      <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7572e2216a5ce6a0f30b3df417dc90c6">add_update_flags_all</a>(update_flags);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html">MeshWorker::Assembler::ResidualSimple&lt;Vector&lt;double&gt;</a>&gt; assembler;</div>
<div class="line">    <a class="code" href="classAnyData.html">AnyData</a>                                               data;</div>
<div class="line">    data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;right_hand_side, <span class="stringliteral">&quot;RHS&quot;</span>);</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1ResidualSimple.html#affc8d054d00d3838c2ab8d8adbd5ccb5">initialize</a>(data);</div>
<div class="line"> </div>
<div class="line">    RHSIntegrator&lt;dim&gt; integrator;</div>
<div class="line">    MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                           dof_handler.end(),</div>
<div class="line">                                           dof_info,</div>
<div class="line">                                           info_box,</div>
<div class="line">                                           integrator,</div>
<div class="line">                                           assembler);</div>
<div class="line"> </div>
<div class="line">    right_hand_side *= -1.;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::solve()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classSolverControl.html">SolverControl</a>            control(1000, 1.e-12);</div>
<div class="line">    <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(control);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMGTransferPrebuilt.html">MGTransferPrebuilt&lt;Vector&lt;double&gt;</a>&gt; mg_transfer;</div>
<div class="line">    mg_transfer.<a class="code" href="classMGTransferPrebuilt.html#a305c601c3f8c17c957a5ce71c95b933a">build</a>(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> coarse_matrix;</div>
<div class="line">    coarse_matrix.<a class="code" href="classFullMatrix.html#ae9e8fbf00e15c7b66d527a5de4b31404">copy_from</a>(mg_matrix[0]);</div>
<div class="line">    <a class="code" href="classMGCoarseGridHouseholder.html">MGCoarseGridHouseholder&lt;double, Vector&lt;double&gt;</a>&gt; mg_coarse;</div>
<div class="line">    mg_coarse.<a class="code" href="classMGCoarseGridHouseholder.html#a07bd76dc7f6f66cb22d3e7951a558f50">initialize</a>(coarse_matrix);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classGrowingVectorMemory.html">GrowingVectorMemory&lt;Vector&lt;double&gt;</a>&gt; mem;</div>
<div class="line">    <span class="keyword">using</span> RELAXATION = <a class="code" href="classPreconditionSOR.html">PreconditionSOR&lt;SparseMatrix&lt;double&gt;</a>&gt;;</div>
<div class="line">    <a class="code" href="classmg_1_1SmootherRelaxation.html">mg::SmootherRelaxation&lt;RELAXATION, Vector&lt;double&gt;</a>&gt; mg_smoother;</div>
<div class="line">    RELAXATION::AdditionalData                         smoother_data(1.);</div>
<div class="line">    mg_smoother.<a class="code" href="classmg_1_1SmootherRelaxation.html#ae9e03c626c50a1b13dffe338f5f977b0">initialize</a>(mg_matrix, smoother_data);</div>
<div class="line"> </div>
<div class="line">    mg_smoother.<a class="code" href="classMGSmoother.html#a9976182b6b272aac7800a8fbf18c8ab9">set_steps</a>(2);</div>
<div class="line">    mg_smoother.<a class="code" href="classMGSmoother.html#abed2837ee4e224f94c6a98405906df8f">set_symmetric</a>(<span class="keyword">true</span>);</div>
<div class="line">    mg_smoother.<a class="code" href="classMGSmoother.html#ae35e1ca776c5e1ce40149510e2207f36">set_variable</a>(<span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgmatrix(mg_matrix);</div>
<div class="line">    <a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgdown(mg_matrix_dg_down);</div>
<div class="line">    <a class="code" href="classmg_1_1Matrix.html">mg::Matrix&lt;Vector&lt;double&gt;</a>&gt; mgup(mg_matrix_dg_up);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMultigrid.html">Multigrid&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="namespacemg.html">mg</a>(</div>
<div class="line">      mgmatrix, mg_coarse, mg_transfer, mg_smoother, mg_smoother);</div>
<div class="line">    <a class="code" href="namespacemg.html">mg</a>.set_edge_flux_matrices(mgdown, mgup);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classPreconditionMG.html">PreconditionMG&lt;dim, Vector&lt;double&gt;</a>, <a class="code" href="classMGTransferPrebuilt.html">MGTransferPrebuilt&lt;Vector&lt;double&gt;</a>&gt;&gt;</div>
<div class="line">      preconditioner(dof_handler, <a class="code" href="namespacemg.html">mg</a>, mg_transfer);</div>
<div class="line">    solver.solve(<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, solution, right_hand_side, preconditioner);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> InteriorPenaltyProblem&lt;dim&gt;::estimate()</div>
<div class="line">  {</div>
<div class="line">    std::vector&lt;unsigned int&gt; old_user_indices;</div>
<div class="line">    <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.save_user_indices(old_user_indices);</div>
<div class="line"> </div>
<div class="line">    estimates.block(0).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div>
<div class="line">      cell-&gt;set_user_index(i++);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  n_gauss_points =</div>
<div class="line">      dof_handler.get_fe().tensor_degree() + 1;</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a2ccc96521da795a762213a979c581138">initialize_gauss_quadrature</a>(n_gauss_points,</div>
<div class="line">                                         n_gauss_points + 1,</div>
<div class="line">                                         n_gauss_points);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAnyData.html">AnyData</a> solution_data;</div>
<div class="line">    solution_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;solution, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#ac2d837236f8a481331a3b5fb9f28898d">cell_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7d704e8c204409401eccbd3ffbade4e0">boundary_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae8e0b03e68c8f78090033b22ae7c4f8">face_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aefd53d6be1d70953af6dca9090310d24">add_update_flags_boundary</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping, solution_data, solution);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html">MeshWorker::Assembler::CellsAndFaces&lt;double&gt;</a> assembler;</div>
<div class="line">    <a class="code" href="classAnyData.html">AnyData</a>                                      out_data;</div>
<div class="line">    out_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> *&gt;(&amp;estimates, <span class="stringliteral">&quot;cells&quot;</span>);</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html#a79b368b14edd85f14b30e8efad299279">initialize</a>(out_data, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    Estimator&lt;dim&gt; integrator;</div>
<div class="line">    MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                           dof_handler.end(),</div>
<div class="line">                                           dof_info,</div>
<div class="line">                                           info_box,</div>
<div class="line">                                           integrator,</div>
<div class="line">                                           assembler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.load_user_indices(old_user_indices);</div>
<div class="line">    <span class="keywordflow">return</span> estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).l2_norm();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> InteriorPenaltyProblem&lt;dim&gt;::error()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> errors(2);</div>
<div class="line">    errors.block(0).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line">    errors.block(1).reinit(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;unsigned int&gt; old_user_indices;</div>
<div class="line">    <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.save_user_indices(old_user_indices);</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div>
<div class="line">      cell-&gt;set_user_index(i++);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html">MeshWorker::IntegrationInfoBox&lt;dim&gt;</a> info_box;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  n_gauss_points =</div>
<div class="line">      dof_handler.get_fe().tensor_degree() + 1;</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a2ccc96521da795a762213a979c581138">initialize_gauss_quadrature</a>(n_gauss_points,</div>
<div class="line">                                         n_gauss_points + 1,</div>
<div class="line">                                         n_gauss_points);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAnyData.html">AnyData</a> solution_data;</div>
<div class="line">    solution_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a> *&gt;(&amp;solution, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#ac2d837236f8a481331a3b5fb9f28898d">cell_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a7d704e8c204409401eccbd3ffbade4e0">boundary_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae8e0b03e68c8f78090033b22ae7c4f8">face_selector</a>.<a class="code" href="classMeshWorker_1_1VectorSelector.html#aef1fc2a6ae5d2f756a72e8d2557972a8">add</a>(<span class="stringliteral">&quot;solution&quot;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aae049a9cef81c6fcd743c3681e53d008">add_update_flags_cell</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#aefd53d6be1d70953af6dca9090310d24">add_update_flags_boundary</a>(<a class="code" href="fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">    info_box.<a class="code" href="classMeshWorker_1_1IntegrationInfoBox.html#a3bdba7e7b483b45afac9ed1e83b3038d">initialize</a>(fe, mapping, solution_data, solution);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a> dof_info(dof_handler);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html">MeshWorker::Assembler::CellsAndFaces&lt;double&gt;</a> assembler;</div>
<div class="line">    <a class="code" href="classAnyData.html">AnyData</a>                                      out_data;</div>
<div class="line">    out_data.<a class="code" href="classAnyData.html#a5949f684f8ce7ccce9d45e65af32580c">add</a>&lt;<a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a> *&gt;(&amp;errors, <span class="stringliteral">&quot;cells&quot;</span>);</div>
<div class="line">    assembler.<a class="code" href="classMeshWorker_1_1Assembler_1_1CellsAndFaces.html#a79b368b14edd85f14b30e8efad299279">initialize</a>(out_data, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    ErrorIntegrator&lt;dim&gt; integrator;</div>
<div class="line">    MeshWorker::integration_loop&lt;dim, dim&gt;(dof_handler.begin_active(),</div>
<div class="line">                                           dof_handler.end(),</div>
<div class="line">                                           dof_info,</div>
<div class="line">                                           info_box,</div>
<div class="line">                                           integrator,</div>
<div class="line">                                           assembler);</div>
<div class="line">    <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.load_user_indices(old_user_indices);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;energy-error: &quot;</span> &lt;&lt; errors.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).l2_norm() &lt;&lt; std::endl;</div>
<div class="line">    <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;L2-error:     &quot;</span> &lt;&lt; errors.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(1).l2_norm() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  InteriorPenaltyProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> std::string filename =</div>
<div class="line">      <span class="stringliteral">&quot;sol-&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(cycle, 2) + <span class="stringliteral">&quot;.gnuplot&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Writing solution to &lt;&quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot;&gt;...&quot;</span> &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    std::ofstream gnuplot_output(filename);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ac1eb26168177faa30ffbcf9cbb9c3cd5">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(solution, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#ace4b76e565ba0701c4d32c26075ed3b9">add_data_vector</a>(estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0), <span class="stringliteral">&quot;est&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a5eb51872b8736849bb7e8d2007fae086">build_patches</a>();</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="group__Exceptions.html#ga85407e870a68179ebe62410d9efc153f">write_gnuplot</a>(gnuplot_output);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">InteriorPenaltyProblem&lt;dim&gt;::run</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_steps)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Element: &quot;</span> &lt;&lt; fe.get_name() &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> s = 0; s &lt; n_steps; ++s)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Step &quot;</span> &lt;&lt; s &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">if</span> (estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0).size() == 0)</div>
<div class="line">          <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(1);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridRefinement.html#ae90dc87c4db158b8d01f6d564ac614e5">GridRefinement::refine_and_coarsen_fixed_fraction</a>(</div>
<div class="line">              <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, estimates.<a class="code" href="group__Exceptions.html#gae05a0e26814f032473ed2ef66da018bd">block</a>(0), 0.5, 0.0);</div>
<div class="line">            <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.execute_coarsening_and_refinement();</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Triangulation &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; cells, &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels() &lt;&lt; <span class="stringliteral">&quot; levels&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        setup_system();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;DoFHandler &quot;</span> &lt;&lt; dof_handler.n_dofs() &lt;&lt; <span class="stringliteral">&quot; dofs, level dofs&quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> &lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_levels(); ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div>
<div class="line">          <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; dof_handler.n_dofs(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>);</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble matrix&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_matrix();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble multilevel matrix&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_mg_matrix();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Assemble right hand side&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        assemble_right_hand_side();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Solve&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        solve();</div>
<div class="line">        error();</div>
<div class="line">        <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Estimate &quot;</span> &lt;&lt; estimate() &lt;&lt; std::endl;</div>
<div class="line">        output_results(s);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step39</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span>Step39;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(2);</div>
<div class="line">      std::ofstream logfile(<span class="stringliteral">&quot;deallog&quot;</span>);</div>
<div class="line">      <a class="code" href="logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a609671be1ee6882b9df6a1383311241e">attach</a>(logfile);</div>
<div class="line">      <a class="code" href="classFE__DGQ.html">FE_DGQ&lt;2&gt;</a>                 fe1(3);</div>
<div class="line">      InteriorPenaltyProblem&lt;2&gt; test1(fe1);</div>
<div class="line">      test1.run(12);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (std::exception &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="asymmetric__tensor_8h_html_a4248760c880275bab1f288fc80f27039"><div class="ttname"><a href="symmetric__tensor_8h.html#a4248760c880275bab1f288fc80f27039">trace</a></div><div class="ttdeci">constexpr Number trace(const SymmetricTensor&lt; 2, dim2, Number &gt; &amp;)</div></div>
</div><!-- fragment --><p> 。 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
