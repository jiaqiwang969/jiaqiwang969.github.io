<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/classArborXWrappers_1_1BVH.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: ArborXWrappers::BVH Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="9.3.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 9.3.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceArborXWrappers.html">ArborXWrappers</a></li><li class="navelem"><a class="el" href="classArborXWrappers_1_1BVH.html">BVH</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classArborXWrappers_1_1BVH-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ArborXWrappers::BVH Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="bvh_8h_source.html">deal.II/arborx/bvh.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7fdceb93b7c7a94ec7042aa48232f4e0"><td class="memTemplParams" colspan="2">template&lt;int dim, typename Number &gt; </td></tr>
<tr class="memitem:a7fdceb93b7c7a94ec7042aa48232f4e0"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArborXWrappers_1_1BVH.html#a7fdceb93b7c7a94ec7042aa48232f4e0">BVH</a> (const std::vector&lt; <a class="el" href="classBoundingBox.html">BoundingBox</a>&lt; dim, Number &gt;&gt; &amp;bounding_boxes)</td></tr>
<tr class="separator:a7fdceb93b7c7a94ec7042aa48232f4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a424efa29fe23a86056aa6642527534ad"><td class="memTemplParams" colspan="2">template&lt;int dim, typename Number &gt; </td></tr>
<tr class="memitem:a424efa29fe23a86056aa6642527534ad"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArborXWrappers_1_1BVH.html#a424efa29fe23a86056aa6642527534ad">BVH</a> (const std::vector&lt; <a class="el" href="classPoint.html">Point</a>&lt; dim, Number &gt;&gt; &amp;points)</td></tr>
<tr class="separator:a424efa29fe23a86056aa6642527534ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b0351b0a05e368ccd3201cbef3f09a0"><td class="memTemplParams" colspan="2">template&lt;typename QueryType &gt; </td></tr>
<tr class="memitem:a6b0351b0a05e368ccd3201cbef3f09a0"><td class="memTemplItemLeft" align="right" valign="top">std::pair&lt; std::vector&lt; int &gt;, std::vector&lt; int &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArborXWrappers_1_1BVH.html#a6b0351b0a05e368ccd3201cbef3f09a0">query</a> (const QueryType &amp;queries)</td></tr>
<tr class="separator:a6b0351b0a05e368ccd3201cbef3f09a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a20f36483696d26db11714402442bfd3f"><td class="memItemLeft" align="right" valign="top">ArborX::BVH&lt; Kokkos::HostSpace &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a></td></tr>
<tr class="separator:a20f36483696d26db11714402442bfd3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a wrapper around ArborX::BVH. <a class="el" href="classArborXWrappers_1_1BVH.html">BVH</a> stands for Bounding Volume Hierarchy.</p>
<p>From <a href="https://en.wikipedia.org/wiki/Bounding_Volume_Hierarchy">Wikipedia</a>: </p><blockquote class="doxtable">
<p>A bounding volume hierarchy (<a class="el" href="classArborXWrappers_1_1BVH.html">BVH</a>) is a tree structure on a set of geometric objects. All geometric objects are wrapped in bounding volumes that form the leaf nodes of the tree. These nodes are then grouped as small sets and enclosed within larger bounding volumes. These, in turn, are also grouped and enclosed within other larger bounding volumes in a recursive fashion, eventually resulting in a tree structure with a single bounding volume at the top of the tree. Bounding volume hierarchies are used to support several operations on sets of geometric objects efficiently, such as in collision detection and ray tracing. </p>
</blockquote>
<p>Because <a class="el" href="namespaceArborX.html">ArborX</a> uses Kokkos, Kokkos needs to be initialized and finalized before using this class. </p>

<p class="definition">Definition at line <a class="el" href="bvh_8h_source.html#l00054">54</a> of file <a class="el" href="bvh_8h_source.html">bvh.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7fdceb93b7c7a94ec7042aa48232f4e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fdceb93b7c7a94ec7042aa48232f4e0">&#9670;&nbsp;</a></span>BVH() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim, typename Number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">ArborXWrappers::BVH::BVH </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classBoundingBox.html">BoundingBox</a>&lt; dim, Number &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>bounding_boxes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Use a vector of <a class="el" href="classBoundingBox.html">BoundingBox</a> <code>bounding_boxes</code> as primitives. </p>

<p class="definition">Definition at line <a class="el" href="bvh_8h_source.html#l00152">152</a> of file <a class="el" href="bvh_8h_source.html">bvh.h</a>.</p>

</div>
</div>
<a id="a424efa29fe23a86056aa6642527534ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a424efa29fe23a86056aa6642527534ad">&#9670;&nbsp;</a></span>BVH() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim, typename Number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">ArborXWrappers::BVH::BVH </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classPoint.html">Point</a>&lt; dim, Number &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>points</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Use a vector of <code>points</code> as primitives. </p>

<p class="definition">Definition at line <a class="el" href="bvh_8h_source.html#l00159">159</a> of file <a class="el" href="bvh_8h_source.html">bvh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6b0351b0a05e368ccd3201cbef3f09a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b0351b0a05e368ccd3201cbef3f09a0">&#9670;&nbsp;</a></span>query()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename QueryType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; std::vector&lt; int &gt;, std::vector&lt; int &gt; &gt; ArborXWrappers::BVH::query </td>
          <td>(</td>
          <td class="paramtype">const QueryType &amp;&#160;</td>
          <td class="paramname"><em>queries</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the indices of those <a class="el" href="classBoundingBox.html">BoundingBox</a> objects that satisfy the <code>queries</code>. Because <code>queries</code> can contain multiple queries, the function returns a pair of indices and offsets.</p>
<p>Below is an example piece of code that does the following: Let us assume that we have a set of bounding boxes for objects &ndash; say, the bounding boxes of each of the cells in a triangulation, or the bounding boxes for each of the parts of a triangulation in a parallel triangulation. We will store those in the <code>bvh_bounding_boxes</code> array below.</p>
<p>Let us then also assume that we have a set of other bounding boxes, let's say for small objects that are moving around in our domain. We will put these bounding boxes into the <code>bb_intersect</code> array. The question we would then like to answer is the following: with which of the <a class="el" href="classArborXWrappers_1_1BVH.html">BVH</a> bounding box(es) do each of the bb_intersect bounding boxes intersect? In other words, in which cell(s) or partition(s) are the particles?</p>
<p>This query is answered by the following piece of code:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;BoundingBox&lt;dim&gt;&gt; query_bounding_boxes = ...</div>
<div class="line">ArborXWrappers::BoundingBoxIntersectPredicate</div>
<div class="line">bb_intersect(query_bounding_boxes);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::vector&lt;BoundingBox&lt;dim&gt;&gt; bvh_bounding_boxes = ...</div>
<div class="line">ArborxWrappers::BVH <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>(bvh_bounding_boxes);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> [indices, offset] = <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>.query(bb_intersect);</div>
<div class="ttc" id="aclassArborXWrappers_1_1BVH_html_a20f36483696d26db11714402442bfd3f"><div class="ttname"><a href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">ArborXWrappers::BVH::bvh</a></div><div class="ttdeci">ArborX::BVH&lt; Kokkos::HostSpace &gt; bvh</div><div class="ttdef"><b>Definition:</b> <a href="bvh_8h_source.html#l00146">bvh.h:146</a></div></div>
</div><!-- fragment --><p>The elements of <code>bvh_bounding_boxes</code> that intersect the <code>j</code>th <a class="el" href="classBoundingBox.html">BoundingBox</a> of <code>query_bounding_boxes</code> are given by:</p>
<div class="fragment"><div class="line">std::vector&lt;int&gt; bvh_bounding_box_indices;</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = offset[j]; i &lt; offset[j+1]; ++i)</div>
<div class="line">  bvh_bounding_box_indices.push_back(indices[i]);</div>
</div><!-- fragment --><p>In many other applications, we are interested not only in finding which bounding boxes another bounding box lies in, but in fact which bounding boxes individual points lie in &ndash; say, if instead of objects we have point-like particles moving around. In that case, we would need to answer a query for points, and this can be done as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; query_points = ...</div>
<div class="line">ArborXWrappers::PointIntersectPredicate pt_intersect(query_points);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::vector&lt;BoundingBox&lt;dim&gt;&gt; bvh_bounding_boxes = ...</div>
<div class="line">ArborxWrappers::BVH <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>(bvh_bounding_boxes);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> [indices, offset] = <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>.query(pt_intersect);</div>
</div><!-- fragment --><p>As a final example, we want to show how to find the five nearest points of a given set of points. This can done as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; query_points = ...</div>
<div class="line">ArborXWrappers::PointNearestPredicate pt_nearest(query_points, 5);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; bvh_points = ...</div>
<div class="line">ArborxWrappers::BVH <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>(bvh_points);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> [indices, offset] = <a class="code" href="classArborXWrappers_1_1BVH.html#a20f36483696d26db11714402442bfd3f">bvh</a>.query(pt_nearest);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="bvh_8h_source.html#l00167">167</a> of file <a class="el" href="bvh_8h_source.html">bvh.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a20f36483696d26db11714402442bfd3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20f36483696d26db11714402442bfd3f">&#9670;&nbsp;</a></span>bvh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ArborX::BVH&lt;Kokkos::HostSpace&gt; ArborXWrappers::BVH::bvh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Underlying <a class="el" href="namespaceArborX.html">ArborX</a> object. </p>

<p class="definition">Definition at line <a class="el" href="bvh_8h_source.html#l00146">146</a> of file <a class="el" href="bvh_8h_source.html">bvh.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/deal.II/arborx/<a class="el" href="bvh_8h_source.html">bvh.h</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
