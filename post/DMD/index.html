<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>DMD | DEAL-II-Fluid</title><meta name="robots" content="noindex"><meta name="description" content="DMD 算法汇总PODrealization of a stationary stochastic process and therefore can use statistical tools such as  POD to obtain a meaningful decomposition. POD is a linear decomposition of the flow field int"><meta name="keywords" content="着色器"><meta name="author" content="Jiaqi"><meta name="copyright" content="Jiaqi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://deal-ii.com/post/DMD/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="DMD"><meta property="og:url" content="http://deal-ii.com/post/DMD/"><meta property="og:site_name" content="DEAL-II-Fluid"><meta property="og:description" content="DMD 算法汇总PODrealization of a stationary stochastic process and therefore can use statistical tools such as  POD to obtain a meaningful decomposition. POD is a linear decomposition of the flow field int"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/cover-blog-shader.webp"><meta property="article:published_time" content="2020-11-30T05:55:34.000Z"><meta property="article:modified_time" content="2021-01-29T07:25:51.526Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-01-29 15:25:51'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/flink.min.css"><link rel="stylesheet" href="/gitcalendar/css/gitcalendar.css"/><meta name="generator" content="Hexo 5.3.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/me.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">26</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">34</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 索引</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/x-dealii-9.3"><i class="fa-fw fa-book"></i><span> deal.ii Library</span></a></li><li><a class="site-page" href="/x-fem"><i class="fa-fw fa-book"></i><span> FEM-learning</span></a></li><li><a class="site-page" href="/x-swirlflow/"><i class="fa-fw fa fa-book"></i><span> swirlflow</span></a></li><li><a class="site-page" href="/x-codepen/"><i class="fa-fw fa fa-magic"></i><span> codepen</span></a></li><li><a class="site-page" href="/x-gallery/"><i class="fa-fw fa fa-beer"></i><span> gallery</span></a></li><li><a class="site-page" href="/x-shadertoy/"><i class="fa-fw fa fa-star"></i><span> shadertoy</span></a></li><li><a class="site-page" href="/x-webgl1/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl1</span></a></li><li><a class="site-page" href="/x-webgl2/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl2</span></a></li><li><a class="site-page" href="/x-markdown/"><i class="fa-fw fa fa-tree"></i><span> Vditor</span></a></li><li><a class="site-page" href="/x-DNN/"><i class="fa-fw fa fa-heartbeat"></i><span> DNN</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#DMD-%E7%AE%97%E6%B3%95%E6%B1%87%E6%80%BB"><span class="toc-number">1.</span> <span class="toc-text">DMD 算法汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#POD"><span class="toc-number">1.1.</span> <span class="toc-text">POD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#standard-DMD"><span class="toc-number">1.2.</span> <span class="toc-text">standard DMD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#On-line-DMD1"><span class="toc-number">1.3.</span> <span class="toc-text">On-line DMD1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hankel-DMD"><span class="toc-number">2.</span> <span class="toc-text">Hankel-DMD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Koopman-mode-decomposition-4"><span class="toc-number">3.</span> <span class="toc-text">Koopman mode decomposition 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text"> </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hypergraph-amp-amp-mix-norm-7"><span class="toc-number">4.1.</span> <span class="toc-text">Hypergraph &amp;&amp; mix_norm 7</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Basic-theory-of-the-WLS-meshless-methods"><span class="toc-number">4.1.1.</span> <span class="toc-text">Basic theory of the WLS meshless methods</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">4.2.</span> <span class="toc-text"> </span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Application-of-Dynamic-mode-decomposition-for-separating-flow-instability-in-a-high-speed-compressor"><span class="toc-number"></span> <span class="toc-text">Application of Dynamic mode decomposition for separating flow instability in a high-speed compressor</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%98%E8%A6%81%EF%BC%9A"><span class="toc-number">0.1.</span> <span class="toc-text">摘要：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Introduction"><span class="toc-number">1.</span> <span class="toc-text">1. Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Experimental-setup"><span class="toc-number">2.</span> <span class="toc-text">2. Experimental  setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Time-delay-DMD-for-a-real-rotating-system"><span class="toc-number">3.</span> <span class="toc-text">3. Time-delay DMD for a real rotating system</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E7%9A%84DMD-algorithms-%E5%AF%B9%E6%AF%94%E5%92%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">3.1.</span> <span class="toc-text">不同的DMD algorithms 对比和结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Dynamic-spectrum-analysis"><span class="toc-number">4.</span> <span class="toc-text">4. Dynamic spectrum analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Eigenvalues-of-RI-SI-and-RS"><span class="toc-number">4.1.</span> <span class="toc-text">Eigenvalues of RI, SI, and RS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RS-Dynamic-modes-separation"><span class="toc-number">4.2.</span> <span class="toc-text">RS:     Dynamic modes separation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RI-spectrum-interpretation-by-dynamic-modes"><span class="toc-number">4.3.</span> <span class="toc-text">RI:     spectrum interpretation by dynamic modes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-DMD-for-RS-extraction"><span class="toc-number">5.</span> <span class="toc-text">5. DMD for RS extraction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#The-idea-of-DMD-method-for-background-removal"><span class="toc-number">5.1.</span> <span class="toc-text">The idea of DMD method for background removal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Average-scale-results-with-background-removal"><span class="toc-number">5.2.</span> <span class="toc-text">Average-scale results with background removal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-DMD-for-shock-wave-extraction"><span class="toc-number">6.</span> <span class="toc-text">6. DMD for shock wave extraction</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Conclusion"><span class="toc-number">6.1.</span> <span class="toc-text">Conclusion</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#of-Mechanical-Engineers-pp-V02AT45A024%E2%80%93V02AT45A024"><span class="toc-number">6.1.0.1.</span> <span class="toc-text">of Mechanical Engineers, pp. V02AT45A024–V02AT45A024.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8D%89%E7%A8%BF"><span class="toc-number">6.2.</span> <span class="toc-text">草稿</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/cover-blog-shader.webp)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">DEAL-II-Fluid</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 索引</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/x-dealii-9.3"><i class="fa-fw fa-book"></i><span> deal.ii Library</span></a></li><li><a class="site-page" href="/x-fem"><i class="fa-fw fa-book"></i><span> FEM-learning</span></a></li><li><a class="site-page" href="/x-swirlflow/"><i class="fa-fw fa fa-book"></i><span> swirlflow</span></a></li><li><a class="site-page" href="/x-codepen/"><i class="fa-fw fa fa-magic"></i><span> codepen</span></a></li><li><a class="site-page" href="/x-gallery/"><i class="fa-fw fa fa-beer"></i><span> gallery</span></a></li><li><a class="site-page" href="/x-shadertoy/"><i class="fa-fw fa fa-star"></i><span> shadertoy</span></a></li><li><a class="site-page" href="/x-webgl1/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl1</span></a></li><li><a class="site-page" href="/x-webgl2/"><i class="fa-fw fa fa-camera-retro"></i><span> webgl2</span></a></li><li><a class="site-page" href="/x-markdown/"><i class="fa-fw fa fa-tree"></i><span> Vditor</span></a></li><li><a class="site-page" href="/x-DNN/"><i class="fa-fw fa fa-heartbeat"></i><span> DNN</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">DMD</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-11-30 13:55:34"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2020-11-30</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2021-01-29 15:25:51"><i class="fas fa-history fa-fw"></i> 更新于 2021-01-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/private/">private</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="DMD-算法汇总"><a href="#DMD-算法汇总" class="headerlink" title="DMD 算法汇总"></a>DMD 算法汇总</h2><h3 id="POD"><a href="#POD" class="headerlink" title="POD"></a>POD</h3><p>realization of a stationary stochastic process and therefore can use statistical tools such as  POD to obtain a meaningful decomposition. POD is a linear decomposition of the flow field into spatially orthogonal modes and uncorrelated temporal coefficients.</p>
<p>the chaotic component $u_c(x,y,t)$ 可以分解：</p>
<script type="math/tex; mode=display">
u_c(x,y,t)= \sum_k a_k (t)\phi_k(x,y)</script><p>其中， $\phi_k$ 为POD 模态<sup><a href="#fn_3" id="reffn_3">3</a></sup>, $a_k$ 与时间相关。</p>
<p>DMD 或 Koopman decomposition mode, could evolve exponentially with time.  POD 模态 互相空间正交，DMD 不必。POD provide a robust representation of post-transient chaotic components since the modes become independent of the initial condition due to 遍历性. </p>
<p>在该<sup><a href="#fn_3" id="reffn_3">3</a></sup>文献中，Koopman modes 和 POD 模态同时使用，the most economical choices for constructing low-dimensional approximations of the quasi-periodic and chaotic components of the flow respectively.</p>
<script type="math/tex; mode=display">
u_{n_k,n_p}(x,t)= \sum_{j=1}^{n_k} u_j(x)e^{i w_j t} + \sum_{l=1}^{n_p} \phi_l(x)a_l(t)</script><p>stack the modes by starting from the Koopman modes (including the mean flow) in the order of decreasing energy and then use the POD modes of the chaotic component with the same order.</p>
<h3 id="standard-DMD"><a href="#standard-DMD" class="headerlink" title="standard DMD"></a>standard DMD</h3><script type="math/tex; mode=display">
x_{j+1}=F(x_j)</script><script type="math/tex; mode=display">
X_k=[x_1 \space x_2 \space ... \space x_k],Y_k=[y_1 \space y_2 \space ... \space y_k],</script><script type="math/tex; mode=display">
J_k =\sum_{i=1}^{k} ||y_i -A_k x_i||^2 = ||Y_k - A_k X_k||^2_F</script><p>where $F$ denotes the Frobenius norm on matrices. The unique minimum-norm solution to this least-squares problem is given by</p>
<script type="math/tex; mode=display">
A_k=Y_k X_k^+</script><p>where $X_k^+$ denotes the Moore-Penrose pseudoinverse of $X_k$.</p>
<p>   Here, we shall assume that $X_k$ has full row rank, in which case $X_k X_k^T$ is invertible, and</p>
<script type="math/tex; mode=display">
X_k^+ = X_k^T (X_k X_K^T)^{-1}</script><p>The $A_k$ given above is the unique solution that minimizes $J_k$. </p>
<p>Consider minimizing a modified cost function:</p>
<script type="math/tex; mode=display">
\tilde{J_k} = \sum_{i=1}^k \rho^{k-i} ||y_i - A_k x_i||^2</script><p>where $0&lt;\rho \leqq 1$. </p>
<h3 id="On-line-DMD1"><a href="#On-line-DMD1" class="headerlink" title="On-line DMD1"></a>On-line DMD<sup><a href="#fn_1" id="reffn_1">1</a></sup></h3><p>这个算法特别适合实验数据测点数n比较小，而时间t非常大的实时迭代更新.</p>
<p>一般一个snapshots的展开的列数相对较大，但snapshot数较少. 为了满足实时性计算性能要求，参考文献提出了类似于classical recursive least-squares estimation algorithm recursive least-squares algorithm update a vector in real time.</p>
<p>首先，将上面$A_k=Y_k X_k^+$改写为</p>
<script type="math/tex; mode=display">
A_k = Y_k X_k^T (X_k X_k^T)^{-1}= Q_k P_k</script><p>那么，为了计算下个时间步的$A<em>k$，则需要更新$Q</em>{k+1}$和$P_{k+1}$</p>
<script type="math/tex; mode=display">
Q_{k+1}= Y_{k+1}X_{k+1}^T = [Y_k \space y_{k+1}][X_k \space x_{k+1}]^T = Y_k X_k^T + y_{k+1}x_{k+1}^T\\\\
P_{k+1}^{-1}= X_{k+1}X_{k+1}^T =[X_k \space x_{k+1}][X_k \space x_{k+1}]^T= X_kX_k^T + x_{k+1}x_{k+1}^T</script><p>上述公式说明了，可以通过单单更新rank-1来找到下一个时间不的Q和P矩阵。</p>
<script type="math/tex; mode=display">
Q_{k+1}= Q_k + y_{k+1}x_{k+1}^T\\\\
P_{k+1}^{-1}=P_k^{-1} + x_{k+1}x_{k+1}^T</script><p>这样就可以更新下个时间步的DMD矩阵：</p>
<script type="math/tex; mode=display">
A_{k+1}=Q_{k+1}P_{k+1}^{-1}=(Q_k + y_{k+1}x_{k+1}^T) (P_k^{-1} + x_{k+1}x_{k+1}^T)^{-1}</script><p>计算$P_k^{-1}$还要设计到求逆，这是非常耗时的，$O(n^3)$. 可以通过Sherman-Morrision formula进行简化<sup><a href="#fn_2" id="reffn_2">2</a></sup></p>
<script type="math/tex; mode=display">
\cssId{Overlinev}{(A+ uv^T)^{-1}} = A^{-1} - {A^{-1}uv^T A^{-1}\over 1+v^T A^{-1}u}</script><p>把上面$\href{ #Overlinev}{公式}$ 应用到P</p>
<script type="math/tex; mode=display">
P_{k+1}= (P_k^{-1}+ x_{k+1}x_{k+1}^T)^{-1} = P_k - {P_k x_{k+1}P_k \over1+x_{k+1}^T P_k x_{k+1}}</script><p>令</p>
<script type="math/tex; mode=display">
\gamma_{k+1}={1 \over1+x_{k+1}^T P_k x_{k+1}}</script><p>因此：</p>
<script type="math/tex; mode=display">
A_{k+1}= (Q_k + y_{k+1}x_{k+1}^T) ( P_k - \gamma_{k+1} {P_k x_{k+1}P_k })\\\\
= Q_kP_k - \gamma_{k+1}Q_k P_k x_{k+1}x_{k+1}^T P_k \\\\
+ y_{k+1}x_{k+1}^T P_k- \gamma_{k+1}y_{k+1}x_{k+1}^T P_k x_{k+1}x_{k+1}^T P_k</script><p>简化last two terms，</p>
<script type="math/tex; mode=display">
y_{k+1}x_{k+1}^T P_k- \gamma_{k+1}y_{k+1}x_{k+1}^T P_k x_{k+1}x_{k+1}^T P_k = \gamma_{k+1}y_{k+1}(\gamma_{k+1}^{-1}-x_{k+1}^TP_k x_{k+1})x^T_{k+1}P_k\\\\
= \gamma_{k+1}y_{k+1}x^T_{k+1}P_k</script><p>所以：</p>
<script type="math/tex; mode=display">
A_{k+1} = A_k - \gamma_{k+1}Q_k P_k x_{k+1}x_{k+1}^T P_k + \gamma_{k+1}y_{k+1}x^T_{k+1}P_k</script><ul>
<li>解释：更新A的过程可以看成 将$y<em>{k+1}-A_kx</em>{k+1}$的误差用于更正$A_{k+1}$.</li>
<li>$A<em>k x</em>{k+1}$ 和 $P<em>k x</em>{k+1}$大概需要$4n^2$floating-point. 而 standard DMD 为 $O(kn^2</li>
</ul>
<ul>
<li><p>思考: 这个获取可以用在DMD旋转失稳的旋转速度的捕捉，随着工况的变化，该速度一直在变化，也带来了频率的变化。</p>
<p>可以用来作失速前的预警。</p>
</li>
</ul>
<p>目前有做过尝试，但是由于time-delay的限制，效果不明显。</p>
<h2 id="Hankel-DMD"><a href="#Hankel-DMD" class="headerlink" title="Hankel-DMD"></a>Hankel-DMD</h2><p>Calculate the Koopman spectrum is to apply DMD to Hankel matrix of data. The Hankel matrix is created by the delay-embedding of time series measurements on the observables. Delay-embedding is an established  method for geometric reconstruction of attractors for nonlinear systems based on measurements of generic observables. </p>
<p>Connection between linear analysis of delay-embedded data and identification of nonlinear systems using the Koopman linear analysis. </p>
<p>projections of data vectors converge to function projections in the space of observables.</p>
<p>new connection between the SVD and POD on the ensemble of observables on ergodic dynamical systems.</p>
<h2 id="Koopman-mode-decomposition-4"><a href="#Koopman-mode-decomposition-4" class="headerlink" title="Koopman mode decomposition 4"></a>Koopman mode decomposition <sup><a href="#fn_4" id="reffn_4">4</a></sup></h2><p>首先从基本的N-S方程的简化形式出发：</p>
<script type="math/tex; mode=display">
\partial_t u(x,t)=F(u(x,t))</script><script type="math/tex; mode=display">
g^{\tau}(u(x,t)):= U^\tau g(u(x,t))= g(u(x,t+\tau))</script><p>g 表示可观，$U^\tau$ denotes maps the function g to a new function $g^\tau$., 为线性算子。所以，通过spectrum和特征值可以了解系统的运行机制。Koopman 特征值具有以下特性：</p>
<script type="math/tex; mode=display">
\phi^{\tau}(u): = U^\tau \phi_j(u) = e^{\lambda_j \tau}\phi_j (u)</script><p>The Koopman freuqencies, $w_j$:</p>
<script type="math/tex; mode=display">
\lambda_i = iw_j, w_j \in R</script><p>假定所有可观测的数据全部收敛到Koopman特征函数上，</p>
<script type="math/tex; mode=display">
g(u)= \sum_{j=1}^{\infty}g_j \phi_j (u)</script><p>最后形成Koopman mode decomposition 的基本表达：</p>
<script type="math/tex; mode=display">
g^{\tau}(u):= U^{\tau} g(u) = \sum_{j=1}^\infty g_j \phi_j(u)e^{i w_j \tau}</script><p>The vector $g_i$ called the Koopman mode assosiated  with the Koopman frequency $w_j$, describes the components of the observable g obtained by projection of the observable onto the Koopman eigenfunction $\phi_j$. </p>
<p>For chaos behavior, the scalar observable g can be written as</p>
<script type="math/tex; mode=display">
U^\tau g = \sum_{k\in Z} g_k \phi_k e^{i k\cdot \Omega \tau} + \int_{-\infty}^{\infty} e^{i\alpha \tau} dE_\alpha (g)</script><p>Informally speaking, $i\alpha$ with $\alpha \in (-\infty, \infty)$, denotes a continuum of eigenvalues distributed along the imaginary axis. $dE_\alpha(\cdot)$ is the spectral measure of the Koopman operator.</p>
<p>为了更好的应用于flow application, 转化为内积的形式：</p>
<script type="math/tex; mode=display">
<g, U^\tau g>_H = \sum_{k=1}^\infty |g_k|^2 e^{i w_k \tau} + \int_{-\infty}^{\infty} e^{i \alpha \tau} \rho+g (\alpha) d\alpha</script><p>在满足遍历性假设的基础上，有：</p>
<script type="math/tex; mode=display">
<g, U^\tau g>_H =r_g(\tau): lim_{T->\infty} {1\over T} \int_0^T g(t)g^*(t+\tau) dt</script><p>即为g的自相关函数。</p>
<p>因此，we can approximation the spectral density of the Koopman operator by first extracting the chaotic component of g, then approximating $r_g$ using finite-time observations, and finally applying inverse Fourier transform to $r_g$.  </p>
<script type="math/tex; mode=display">
cov(g, U^\tau g)= \int_{-\infty}^{\infty} e^{i\alpha \tau} \rho(\alpha) d\alpha</script><p>where $\rho$ is called the Power Speactral Density (PSD) of the stochastic process.</p>
<p>Koopman modes 自然也满足N-S 方程：</p>
<script type="math/tex; mode=display">
u_j = \nabla^\perp \psi_j, j=1,2,3</script><p>其vorticity field</p>
<script type="math/tex; mode=display">
\xi_j = \nabla \times u_j, j=1,2,3...</script><ul>
<li>优于DMD的点在于：可以处理宽带噪声；</li>
</ul>
<p>三步：</p>
<ul>
<li>we apply a high-resolution algorithm - adapted from Laskar- to detect the candidate discrete Koopman frequencies and modes. The Laskar algorithm provides a controllable balance between accuracy and computational efficiency which makes it suitable for large data sets like high-resolution flow snapshots. Moreover, it makes direct use of the harmonic averaging which has proven convergence properties for computation of koopman mode.</li>
<li>use the ergodic properties of the attractor to discard the spurious frequencies that are artifacts of the continuous spectra.</li>
<li>After extracting the periodic components of the flow, we estimate the continuous Koopman spectrum by the Welch method to the chaotic residual.1 </li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/koopman.png" alt="koopman"><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/koopman1.png" alt="koopman"></p>
<p>提取离散频率，然后continuous spectra estimator to the remainder.</p>
<p>A. Harmonic averaging and DFT</p>
<p>The koopman modes can be computed via direct projection of observables onto the Koopman eufebfybction, $\phi_j$.</p>
<script type="math/tex; mode=display">
g_j : <g,\phi_j>_H=\lim_{T \to \infty} {1\over T} \int_0^T g(\tau) e^{-iw_j \tau}d\tau</script><p>Assuming uniform sampling at time instants, approximate the harmonic average as</p>
<script type="math/tex; mode=display">
g_j^N = {1\over N} \sum_{k=0}^{N-1} g(k)e^{-i w_j\tau_k}g_j^N = {1\over N} \sum_{k=0}^{N-1} g(k)e^{-i w_j\tau_k}</script><p>The harmonic average of observation by DFT:</p>
<script type="math/tex; mode=display">
\hat{g}_j={1\over N} \sum_{k=0}^{N-1} g(k)e^{-i\Omega_j k \triangle \tau}</script><p>DFT is shown to be equivalent to DMD when applied to a linearly independent sequence of snapshots with zero mean. </p>
<p><strong>对比</strong></p>
<p>标准DMD：前6阶模态</p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/20201205142407.png" alt="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424071.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424072.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424073.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424074.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424075.png" al="koopman" style="zoom: 25%;" /></p>
<p>Koopman DMD：前7阶模态Sp</p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424076.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424077.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424078.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051424079.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120514240710.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120514240711.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120514240712.png" al="koopman" style="zoom: 25%;" /></p>
<p>前7阶模态Wm;轴向速度</p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/t20201205152957.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/t202012051529571.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529572.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529573.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529574.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529575.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529576.png" al="koopman" style="zoom: 25%;" /></p>
<p>前7阶模态Wr;径向速度</p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529577.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529578.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/202012051529579.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295710.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295711.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295712.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295713.png" al="koopman" style="zoom: 25%;" /></p>
<p>前7阶模态Wt;径向速度</p>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295714.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295715.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295716.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295717.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295718.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295719.png" al="koopman" style="zoom: 25%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020120515295720.png" al="koopman" style="zoom: 25%;" /></p>
<h2 id=""><a href="#" class="headerlink" title=" "></a> </h2><p>但实验效果不佳!</p>
<h3 id="Hypergraph-amp-amp-mix-norm-7"><a href="#Hypergraph-amp-amp-mix-norm-7" class="headerlink" title="Hypergraph &amp;&amp; mix_norm 7"></a>Hypergraph &amp;&amp; mix_norm <sup><a href="#fn_7" id="reffn_7">7</a></sup></h3><p>首先需要获得流场的速度场和速度梯度。</p>
<ul>
<li>方法1：</li>
</ul>
<p>对于non-uniform grid, 作了以下尝试，<a target="_blank" rel="noopener" href="https://www.mathworks.com/matlabcentral/answers/474429-calculate-derivatives-in-a-non-uniform-grid">参考</a>利用Jacobian matrix：</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[dxi,dxj]=gradient(x);</span><br><span class="line">[dyi,dyj]=gradient(y);</span><br><span class="line">[dui,duj]=gradient(u);</span><br></pre></td></tr></table></figure>
<p>then the Jacobian of the transformation is </p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[dxi dxj</span><br><span class="line">dyi dyj]</span><br></pre></td></tr></table></figure>
<p>the determinant is </p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DET=dxi.*dyj- dxj.*dyi;</span><br></pre></td></tr></table></figure>
<p>the inverse of the Jacobian has these 4 coefficients:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JAC11&#x3D;DET.*dxi;</span><br><span class="line">JAC21&#x3D;DET.*dyi;</span><br><span class="line">JAC12&#x3D;DET.*dxj;</span><br><span class="line">JAC22&#x3D;DET.*dyj;</span><br></pre></td></tr></table></figure>
<p>Then to transform the gradient [dui,duj] into dux, duy you just do:      </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dux&#x3D;dui.*JAC11+duj.*JAC12;</span><br><span class="line">duy&#x3D;dui.*JAC21+duj.*JAC22;</span><br></pre></td></tr></table></figure>
<p>这个方法不能适用于非结构网格。</p>
<ul>
<li>方法2：无网格法<sup><a href="#fn_8" id="reffn_8">8</a></sup></li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020-12-05_21-49_meshlessCloud.png" alt="meshless" style="zoom:50%;" /><img src= "/img/loading.gif" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/2020-12-05_21-49_meshlessPoint.png" alt="meshless" style="zoom:50%;" /></p>
<h4 id="Basic-theory-of-the-WLS-meshless-methods"><a href="#Basic-theory-of-the-WLS-meshless-methods" class="headerlink" title="Basic theory of the WLS meshless methods"></a>Basic theory of the WLS meshless methods</h4><p>The coordinate difference between the satellite j and the center i can be express as</p>
<script type="math/tex; mode=display">
h_j^i = x_j -x_i, l_l^i = y_j -y_i</script><p>For simplicity, we use $h_j$ and $l_j$ to denote $h_j^i$ and $l_j^i$, respectively. The vector</p>
<script type="math/tex; mode=display">
\vec{r}_j^i= (h_j , l_j)</script><p>starts from i to j, its length is </p>
<script type="math/tex; mode=display">
r_j^i = \sqrt{h_j^2 + l_j^2}</script><p>and the reference radius of cloud as</p>
<script type="math/tex; mode=display">
R_i = min(r_1^i, r_2^i, ..., r_j^i, ..., r_{M_i}^i)</script><p>$M_i$ is the total number of the satellites in the cloud.</p>
<p>The spirit of least-squares method apply Taylor sires about a point $P_i(x_i, y_i)$:</p>
<script type="math/tex; mode=display">
f = f_i +a_1 h + a_2 l + {1\over 2}a_3 h^2 +{1\over 2} a_4 l^2 + a_5 hl + O(h^3,l^3)</script><p> where $f= f(x,y)$ and $f_i = f(x_i,y_i)$ are the function values, $h=x-x_i$ and $l=y-y_i$ are the coordinate differences between the points. The coefficients $a_k(k=1,2,3,4,5)$ represent the partial derivatives of the function at $P_i(x_i,y_i)$:</p>
<script type="math/tex; mode=display">
a_1= {\partial f\over \partial x}|_i, a_2={\partial f\over \partial y}|_i, a_3={\partial^2 f\over \partial x^2}|_i, a_4={\partial^2f\over \partial y^2}|_i, a_5= {\partial^2 f\over \partial x\partial y}|_i</script><p>Keeping the terms until second order, we obtain the approximate function value at Point $P_j(x_j, y_j)$</p>
<script type="math/tex; mode=display">
\tilde{f}_j = f_i +a_1 h_j + a_2 l_j + {1\over 2}a_3 h_j^2 +{1\over 2} a_4 l_j^2 + a_5 h_jl_j</script><p>一阶精度：</p>
<script type="math/tex; mode=display">
\tilde{f}_j = f_i +a_1 h_j + a_2 l_j</script><p>and the error between the exact and approximate value is</p>
<script type="math/tex; mode=display">
e_j = f_j - \tilde{f}_j = f_j - (f_i + a_1 h_j +a_2 l_j)</script><p>A weight function is introduced here to construct $e_j$ considering the effect of different distance between the satellite j and the center i :</p>
<script type="math/tex; mode=display">
w_j^i = {r_j^i \over R_i}</script><p>Then for cloud $C_i$, the total error can be estimated by the following expression:</p>
<script type="math/tex; mode=display">
\Phi = {1\over 2}\sum_{j=1}^{M_i}(w_j^i e_j)^2</script><p>In order to minimize the error, its derivatives about $a_1$ and $a_2$ are set to zero:</p>
<script type="math/tex; mode=display">
{\partial \Phi\over \partial a_1}={\partial \Phi\over \partial a_2}=0</script><p>and we gain a set of linear equtions</p>
<script type="math/tex; mode=display">
Ax=b</script><script type="math/tex; mode=display">
A= \begin{bmatrix}
\sum w_j^{i^2}h_j^2 & \sum w_j^{i^2}h_jh_j \\
\sum w_j^{i^2}h_j l_j & \sum w_j^{i^2}l_j^2  \\
\end{bmatrix}</script><blockquote id="fn_1">
<sup>1</sup>. <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1707.02876">SIAM-Online dynamic mode decomposition for time-varying systems</a><a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_2">
<sup>2</sup>. Sherman, Adjustment of an inverse matrix corresponding to a change in one element of a given matrix.<a href="#reffn_2" title="Jump back to footnote [2] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_3">
<sup>3</sup>.  Hassan Arbabi, Spectral analysis of mixing in 2D high-Reynolds flows, JFM<a href="#reffn_3" title="Jump back to footnote [3] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_4">
<sup>4</sup>. Study of dynamics in post-transient flows using Koopman mode decomposition-Physical review<a href="#reffn_4" title="Jump back to footnote [4] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_5">
<sup>5</sup>. Geneative stochastic modeling of strongly nonlinear flows with non-Gaussian statistics<a href="#reffn_5" title="Jump back to footnote [5] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_6">
<sup>6</sup>. Particles to Partial Differential Equations Parsimoniously<a href="#reffn_6" title="Jump back to footnote [6] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_7">
<sup>7</sup>. Spectral analysis of mixing in 2D high-Reynolds flows” by H. Arbabi and I. Mezic<a href="#reffn_7" title="Jump back to footnote [7] in the text."> &#8617;</a>
</blockquote>
<blockquote id="fn_8">
<sup>8</sup>. Evolutionary Design Optimization with Nash Games and Hybridized Mesh/Meshless Methods in Computational Fluid Dynamics<a href="#reffn_8" title="Jump back to footnote [8] in the text."> &#8617;</a>
</blockquote>
<p><sup><a href="#fn_9" id="reffn_9">9</a></sup>: </p>
<h3 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h3><h1 id="Application-of-Dynamic-mode-decomposition-for-separating-flow-instability-in-a-high-speed-compressor"><a href="#Application-of-Dynamic-mode-decomposition-for-separating-flow-instability-in-a-high-speed-compressor" class="headerlink" title="Application of Dynamic mode decomposition for separating flow instability in a high-speed compressor"></a>Application of Dynamic mode decomposition for separating flow instability in a high-speed compressor</h1><h3 id="摘要："><a href="#摘要：" class="headerlink" title="摘要："></a>摘要：</h3><p>背景：Dynamic mode decomposition(DMD) has become more popular in extracting dominant features from high dimensional nonlinear systems, especially for computation fluid dynamics. </p>
<p>背景问题：However, experimental application in turbomachinery has been scarcely published. </p>
<p>具体问题：The dilemma is that sensor acquisition is typically highly undersampled with only one dimension of space, no time-spatial animation is available. </p>
<p>解决思路：To overcome this limitation, time-delay DMD, in Hankel alternative view of Koopman (HAVOK)  [Brounton], is newly developed with premise of phase-lock sampling to reconstruct spatial-temporal matrices in time-delay coordinates.</p>
<p>具体方法：Data-driven linear transformation of the dynamical system is reconstructed, truncated SVD is implemented. </p>
<p>应用：It was applied for separating the rotating stall(RS), spike inception(SI), rotating instability(RI) and shock wave(SW) in a high speed compressor. </p>
<p>结论：</p>
<ol>
<li><p>The results prove the effectiveness of decomposing coherent tip leakage flow structure in multiple scale, and its physical meaning associated with the specific azimuthal mode rotating around cylinder.</p>
</li>
<li><p>The method was applied to the analysis of the spectral characteristics of the RI and explained the multi-spike spectrum of nearly 1/2 BPF observed under off-design conditions. </p>
</li>
<li><p>Background removal is access for visualization of RS evolution with its specific filtering characteristics of tip leakage flow, and shock wave is captured as well. </p>
</li>
</ol>
<p>不足与如何克服1：</p>
<ol>
<li><p>The occurrences of tornado-like vortex, tip leakage flow spillage cannot be identified only from the casing wall pressure distribution. For completeness, their occurrences are verified from the velocity field data by numerical simulation. </p>
</li>
<li><p>unsteady use tDMD</p>
</li>
</ol>
<p>DMD-&gt;周向坐标系转换的机理要提议下</p>
<p>Similar characteristics of frequency and dynamic DMD modes were calculated under different working points. </p>
<p>说法要变一下<font color=red><strong>Similar “1/2 BPF spectrum” is observed as the low-velocity cell in the tip region, which is responsible for the self-induced unsteadiness.</strong> </font></p>
<p>The interaction of vortex-breakdown, corner blockage or shock wave were also discussed.</p>
<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>Unsteady flow structures play an essential role in a high-speed compressor. Theories, numerical models, and experimental measurements have been developed over the past 76 years \cite{day2016stall}. However, considerable challenges still stand out, especially for high-speed compressors, such as the accurate modeling and prediction of the stability of the system, better simulation of the tip leakage flow, improved visualization of the flow structures and evolution, etc.</p>
<p>Modal decomposition methods (DMD) are to extract dominant features of modes in a low-dimensional form that contain the most information of complex high-dimensional flow. The DMD method is purely data-driven without the requirement for governing equations. It originated in the fluid dynamics community that allows decomposing a complex flow into fields of localized instability modes. The technique was first introduced, and the ability to handle high-dimensional fluid data was proved by Schmid \cite{schmid2010dynamic}. Indeed, DMD has become more popular since Mezic et al. \cite{mezic2005spectral,mezic2013analysis} and Rowley et al. \cite{rowley2009spectral} showed its connection to the underlying nonlinear dynamics through Koopman operator theory and is readily interpretable using standard dynamical systems techniques. For more interesting modal analysis theory, extension and codes, readers could refer to Kutz’s book \cite{kutz2016dynamic}. </p>
<p>Data-based methods such as proper orthogonal decomposition (POD), balanced POD, dynamic mode decomposition (DMD), and model-based methods such as Koopman analysis, global linear stability, resolvent analysis have been compared with each other in detail \cite{taira2017modal}. Besides, model-based eigenvalue approach for global stability analysis has been well applied for a low-speed single-stage compressor \cite{Sun2016}. However, solving a realistic model with SVD matrix decomposition still suffers from a high computational burden for engineering applications.</p>
<p>The core that builds upon eigenvalue or singular value decomposition (SVD) with matrix factorization provides two primary goals in fluid dynamics application: spectral analysis and model reduction. Specifically, two data-driven signal processing strategies could be implemented to persevering “interesting features” of original dataset—background removal and lower-oder representation.  </p>
<p>Although there exist rich multi-scale flow in both time and space for a real system of high-speed compressor. The “active modes” dominating complex evolution of fluid flow is spare. Measured by high-fidelity pressure maps of the tip leakage flow, combined with numerical simulation of unsteady flow, it delivers an accessible approach to understanding the physical mechanism of flow disturbances. DMD is for better identification of the characteristic correlation between the flow profile, the dominant vortex structures, and the rotating dynamic modes. Time-delay coordinates are to overcome the undersampled acquisition problem with the unsynchronized data set. With matrix of snapshot data in hand, the approximating system A could be reconstructed to extract modes, eigenvalues, and amplitudes. Overall dynamics can be related as the sum of contribution from simple modal dynamics:</p>
<script type="math/tex; mode=display">
X_k = \sum_{i=1}^r (\underbrace{Mode \space i}_{Space})(\underbrace{Eigenvalue \space i}_{Time} )^k(\underbrace{Amplitude \space j}_{Contribution})</script><p>Some imitation and weaknesses of DMD should be solved in application of high speed compressor?</p>
<ul>
<li><p>transition near stall condition, unstable system(tDMD) []</p>
</li>
<li><p>Sensitivity to noisy data. (introduce tDMD)</p>
</li>
<li>Inability yo model nonlinear dynamics.</li>
<li>Inability to model the effect of actuation</li>
<li>Can be computationally expensive or intractable for large datasets?</li>
</ul>
<p>g</p>
<p><a target="_blank" rel="noopener" href="https://www.pathlms.com/siam/courses/11697/sections/14896/video_presentations/129682">提出问题</a>：</p>
<ul>
<li><p>time-delay coordinate  的一些问题讨论？     </p>
</li>
<li><p>What spatial structures are involved in the modal dynamics? 他代表什么物理含义？在相对坐标系转换中，又起到了什么作用？案例：不同工况下</p>
</li>
<li><p>What spatial regions are active in each mode?可以用来回到这些模态分别在空间哪些区域发挥作用。进一部帮助解释叶顶间隙流的行为（magnitude）</p>
</li>
<li>What spatial regions lead/lag others in each mode?(phase)</li>
<li><p>Backgound</p>
</li>
<li></li>
</ul>
<p>再加一部分叙述：提出问题（工作背景，整体思路，实现目的，缺陷如何弥补）？</p>
<p>The organization of this paper is as follows: Sec. II introduces the general experimental setup of the test compressor. Unsteady behavior of tip leakage flow is investigated in Sec. III. Sec. IV presents the theory of time-delay DMD for a real rotating system. The application of dynamic spectrum analysis for robustly extracting RS and RI modes and its mechanism behind is explained in Sec. V. Sec. VI visualizes the RS evolution of different average-scales by DPLA-DMD method. The conclusion is made in Sec. VII.</p>
<h2 id="2-Experimental-setup"><a href="#2-Experimental-setup" class="headerlink" title="2. Experimental  setup"></a>2. Experimental  setup</h2><p>The research platform is a high-speed axial compressor at the State Key Laboratory of Mechanical System and Vibration in Shanghai Jiao Tong University. Fig. 1 presents a schematic view of the 1.5 stage axial compressor, as well as the sensor setup. The design parameters are shown in Table 1. The annular section between sections B and C provided a transparent window, and eight high response static pressure sensors (Kulite-XCL) were arranged on it. The sensors (R1-R8) were designed in an oblique line parallel to the chord of the blade tip, increasing the axial arrangement density for better resolution of the measurements. Moreover, B1 and C1 probes could be merged into the chordwise array by location transfer method. The sampling rate should be set as high as possible for tracking flow disturbances with better spatial resolution. In practice, the natural frequency of the Kulite sensor we used is about 400 kHz, which is capable of measuring dynamic signals accurately within 80 kHz. Besides, the spatial interpolation is implemented with the sensors “scanning” relative to the rotor in the contra-rotating direction for improved visualization. Each sensor acquires the data in 1024 circumferential sampling points per rotor revolution (204.8kHz, 12,000 rpm), which means about 35 point precision in each blade channel (1024/29). </p>
<p><img src= "/img/loading.gif" data-src="/home/wjq/文档/GitHub/私人图床/DMD/Figure1.png" alt="Figure1"></p>
<p>Fig1 The test rig and sensor setup (probes arranged in an oblique line between B &amp; C section and the key sensor for phase lock)</p>
<p>Table 1 Design Parameters of the compressor</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>Tip diameter</strong></th>
<th style="text-align:right">0.76 averaged</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Hub-to-tip ratio</strong></td>
<td style="text-align:right"><strong>0.76 averaged</strong></td>
</tr>
<tr>
<td><strong>Blade count (IGV, Rotor, Stator)</strong></td>
<td style="text-align:right"><strong>32, 29, 37</strong></td>
</tr>
<tr>
<td><strong>Rotor chord</strong></td>
<td style="text-align:right"><strong>63.26 mm</strong></td>
</tr>
<tr>
<td><strong>Rotor tip clearance</strong></td>
<td style="text-align:right"><strong>0.6mm (0.95% chord)</strong></td>
</tr>
<tr>
<td><strong>Test off-design speed(design)</strong></td>
<td style="text-align:right"><strong>12,000 rpm (17,000 rpm)</strong></td>
</tr>
<tr>
<td><strong>Design mass flow rate</strong></td>
<td style="text-align:right"><strong>8.5 kg/s</strong></td>
</tr>
<tr>
<td><strong>Design pressure ratio</strong></td>
<td style="text-align:right"><strong>1.445</strong></td>
</tr>
</tbody>
</table>
</div>
<h2 id="3-Time-delay-DMD-for-a-real-rotating-system"><a href="#3-Time-delay-DMD-for-a-real-rotating-system" class="headerlink" title="3. Time-delay DMD for a real rotating system"></a>3. Time-delay DMD for a real rotating system</h2><p>We start to develop a dynamic spectrum analysis for characterizing spectral properties of nonlinear dynamical systems by model reduction and decomposition. These modes, referred to as Koopman modes, are associated with a particular observable and may be determined directly from data (either numerical or experimental). Koopman first proposed the perspective of Koopman analysis in 1931 \cite{koopman1931hamiltonian} and demonstrated that it is possible to represent a nonlinear dynamical system in terms of an infinite-dimensional linear operator acting on a Hilbert space of measurement functions of the state of the system.</p>
<p>Consider a dynamical system of the form:</p>
<p>where is the state at time  and  represents the dynamic function that implies the property of a system. When it related to algorithm, we often sample the equation (1) discretely in time:</p>
<p>where . Koopman analysis relies on the existence of a linear operator  for dynamical system in equation (2), given by</p>
<p>For a real rotating system, the sensor acquisition is normally highly under-sampled with only one dimension of space. To overcome this limitation, time-delay DMD is developed with the premise of phase-lock sampling method to acquire the analogous discrete-time system with an interval of one revolution of the compressor. The idea of data structure is illustrated in Fig. 3. Here We actually acquire two sets of spatiotemporal data based on time-delay coordinates:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_709ef51d3bbf61bb.png" alt="img"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure         2 Data structure of         time-delay DMD with phase-lock</td>
</tr>
</tbody>
</table>
</div>
<p>They are connected by a linear transformation A with interval of T for every cycle of rotation, i.e.</p>
<p>In practice, the column dimension is large; the matrix A may be intractable to analyze directly. Instead, a more stable and efficient method was suggested as follows:</p>
<p>First, take the reduced singular value decomposition (economy-sized SVD) of X, as opposed to the full SVD:</p>
<p>where * denotes the conjugate transpose, , , and . Here  is the rank of the reduced SVD approximation to . The left singular vectors  are proper-orthogonal-decomposition (POD) modes. The columns of  are orthonormal, so ; similarly, .</p>
<p>Second, substitute equation (5) into equation (4) yields:</p>
<p>where , which means the matrix  defines a low-deimensional linear model of the dynamical system on the POD coordinates. The equation  can be used to reconstruct the high-dimensional state.</p>
<p>Third, solve the eigenvalues and eigenvectors of  yields:</p>
<p>where columns of W are eigenvectors and  is a diagonal matrix containing the corresponding eigenvalues . Here,  is more convenience for physical frequency interpretation.</p>
<p>Finally, the DMD modes are reconstructed:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The Alogorithm:</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="不同的DMD-algorithms-对比和结果"><a href="#不同的DMD-algorithms-对比和结果" class="headerlink" title="不同的DMD algorithms 对比和结果"></a>不同的DMD algorithms 对比和结果</h3><p>In application of compressor data, several tips should be concerned: </p>
<ol>
<li>The interval of snapshots should be small enough in order to acquire a better approximation of system operator . It implies that time-delay DMD is more suitable for high-speed compressors, while high sampling rate measurement is also required for the better quality of visualization.</li>
<li>For real rotating systems, there is the hypothesis that the operator of a dynamical system is invariant, i.e., . It indicates that the dynamical system of the compressor should be globally stable in the reference axis. Practical test has proved the robustness of DMD, even when the compressor is in the prestall process, while fast-decay modes with an ambiguous characteristic structure are considered as noise.</li>
<li>As a nonlinear dynamical system, all of the state variables of a system may not be directly measurable or only partially measurable, for instance, if the component is in an inaccessible location. It suggests that the position of measurements should be carefully selected for reliable system estimation. Without care, the connection with the Koopman operator and the underlying dynamical system may be lost. In our case, the tip leakage flow near the casing wall is the most sensitive flow reflecting RS. Our array sensors should capture its characteristics.</li>
</ol>
<h2 id="4-Dynamic-spectrum-analysis"><a href="#4-Dynamic-spectrum-analysis" class="headerlink" title="4. Dynamic spectrum analysis"></a>4. Dynamic spectrum analysis</h2><h3 id="Eigenvalues-of-RI-SI-and-RS"><a href="#Eigenvalues-of-RI-SI-and-RS" class="headerlink" title="Eigenvalues of RI, SI, and RS"></a>Eigenvalues of RI, SI, and RS</h3><p>The time-delay DMD method is applied to decompose the “animation” data into a set of dynamic modes, each with a single characteristic frequency of oscillation and growth/decay rate. They are obtained by a chord-wise array of wall pressure sensors and reorganized with the phase-locking method. The DMD scheme is introduced as a robust dynamic spectrum analysis for the discovery of dynamic mode from high-dimensional data. The solution to this mild stall system may be expressed simply in terms of the eigenvalue and eigenvector of the discrete-time matrix , and the algorithm produces a low-rank eigen-decomposition in a least-square sense. The RI and RS modes were finally extracted as the spatial structures that oscillate at rates calculated by the corresponding eigenvalues. The SI condition was also considered here, but with only stationary mode left. Because the formation of an initial spike is a transient process with local characteristics changed in a short time. It is more suitable for the dynamic time analysis discussed above.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_8c19c36c2ed640b8.jpg" alt="img"></p>
<p>Figure 3 Complex eigenvalues $\lambda_k$ scattered in the unit circle (truncated at 30th mode)</p>
<p>In Fig. 4, the applications of three distinct conditions (RI, SI, RS) were implemented, each truncated by reduced SVD at 30th mode. The eigenvalues are symmetrical with contrary imaginary values and scattered in circles. In general,  suggests the higher attenuation of dynamic modes as eigenvalues approaches the circle center. While the cluster of eigenvalues inside the inner circle should be considered as noise because their eigenvectors have no clear structure and less power as well. Thus, only the dominating modes (colored) with less decay rate were discussed here.</p>
<ol>
<li></li>
<li></li>
</ol>
<h3 id="RS-Dynamic-modes-separation"><a href="#RS-Dynamic-modes-separation" class="headerlink" title="RS:     Dynamic modes separation"></a>RS:     Dynamic modes separation</h3><p>As shown in Fig. 5, the eigenvectors of RS of the dominant eigenvalues were calculated and performed on three-dimensional faces. The pressure is normalized. Each mode represents an independent circumferential order. Here, the first mode represented the stationary component of the flow field, which is the same cycle as the rotor, and the circumferential order is $m=29$. The second mode and third mode are related to the circumferential orders of , respectively.</p>
<p>The dynamic modes of RS reveal global dynamic features of the compressor system. The effect is well explained by its eigenvalue projecting onto a low-dimensional, nonlinear dynamical system that may be dissected into a simple representation based on coherent spatiotemporal features. For the second and third modes, each presents an annulus with two distinctive sections (distinguished by the color), which balance with each other. Behind it, the stalled sector is occupied by a sizeable full-span stall cell in half circumferential wavelength, while the pressure on the unstalled sector spatially increased in succession.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_2187b7c40b9de76e.jpg" alt="img"></p>
<p>Figure 4 Eigenvectors  Top 3 dynamic modes of RS: (1) m=29; (2) m=1/2; (3)m=1.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_6274acaf3b88402e.jpg" alt="img"></p>
<p>Figure 5 Eigenvectors Ψ=X^’ VΣ^(-1) W  Top 3 dynamic modes of RS: (1) m=29; (2) m=12; (3)m=18.</p>
<ol>
<li><h3 id="RI-spectrum-interpretation-by-dynamic-modes"><a href="#RI-spectrum-interpretation-by-dynamic-modes" class="headerlink" title="RI:     spectrum interpretation by dynamic modes"></a>RI:     spectrum interpretation by dynamic modes</h3></li>
</ol>
<p>Generally, RI is considered as one of the flow disturbances and a potential source of blade vibration or acoustic resonance in the compressor. It usually occurs in off-design conditions with 2-3 blade pitches scaled wide in a compressor, and rotates at about a half rotor speed in circumferential extent. Spectrum analysis has indicated the characteristic hump at roughly half of the blade passing frequency.</p>
<p>Modal perspective view of RI is a new idea in recent researches.  Pardowitz et al. first introduced time-resolved mode analysis for detecting “modal events” of the RI \cite{pardowitz2015experiments}. Further correlation techniques for stereo high-speed PIV data were applied for dominant vortex structures identification corresponding to the RI modes of different orders \cite{Pardowitz2015}.</p>
<p>Similarly, by using time-delay DMD, the eigenvectors of RI behind the dominant eigenvalues were calculated, as depicted in Fig. 6. By inspection, we could easily acquire the order of the mode. For RI modes, the first one is also the stationary component, and the characteristic frequency , and the circumferential order $m=29$, respectively. The second and third mode are their particular rotating “modal events” of  and . The sign of the characteristic frequency of oscillation indicates the direction of the modal rotation when observed in the reference axis. The positive sign means the propagating direction is against the blade rotation.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_33c2b8b7bf0c5b1b.png" alt="img"></p>
<p>Figure 6 Spectrum analysis of 10 array sensors, with labeled characteristic spectral signatures of RI (truncated average in the frequency domain with 10 Hz resolution for denoising).</p>
<p>Spectral analysis by Fast Fourier Transform was applied to RI signals of 10 sensors (B1, R1R8, C1). In order to reduce noise, each signal was cut off with a truncated average in the frequency domain. Here in Fig. 7, the characteristic spectrum of RI was found that are not harmonically related to the rotor frequency, which should be explained by the rotating mode events. For example, for , combined with the effect of mode rotation, we can estimate the frequency with the equation , which is consistent with the peak characteristic frequency of  because of 10Hz resolution. is the modulated frequency between RI mode (m=12) and 1<em>BPF (m=29).  are the modulated frequency between RI mode (m=12) and 2</em>BPF (m=58).</p>
<p>In the same way, the calculated parameter  of eigenvalues and eigenvectors can be used to predict the characteristic frequency of  by .  is the modulated frequency between RI mode (m=18) and 1*BPF (m=29). In conclusion, the RI pattern is closely related to two dynamic modes calculated by the eigenvectors of time-delay DMD. It is further implied that the characteristic spectral signatures of RI are responsible for the generation of rotating structures visualized by independent rotating modes.</p>
<h2 id="5-DMD-for-RS-extraction"><a href="#5-DMD-for-RS-extraction" class="headerlink" title="5. DMD for RS extraction"></a>5. DMD for RS extraction</h2><h3 id="The-idea-of-DMD-method-for-background-removal"><a href="#The-idea-of-DMD-method-for-background-removal" class="headerlink" title="The idea of DMD method for background removal"></a>The idea of DMD method for background removal</h3><p>DMD of background removal is inspired by a recent paper, which successfully applied this technique for subtracting out backgrounds with moving objects in videos \cite{kutz2016dynamic}. This novel idea of DMD is to separate the state of a system into two-rank terms in the frequency domain. One is the low-rank term; the other is the dynamic counterpart. The video frames output by DPLA can be thought of as snapshots of underlying nonlinear dynamics. The DMD decomposition yields oscillatory time components of the video frames. Namely, those modes with low frequency (near the origin in complex eigenvalues maps) can be interpreted as background (mean flow) or low-rank components of dynamics. In contrast, those modes with faster changing timescale (bounded away from the origin), represent the sparse (dynamical motion of the flow) components of dynamics.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_deb706881c8ce0a0.png" alt="img"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure         7 Procedure for DPLA-DMD         implementation and its matrices.</td>
</tr>
</tbody>
</table>
</div>
<p>In order to better visualize spike-type RS evolution, practical application of double-phase-lock-average (DPLA), combined with DMD method was implemented, which can be considered as the further phase-lock of time-delay DMD. The procedure and structure of DMD matrices are depicted in Fig. 8. First, construct the data matrix of ten high-response pressure transducers (B1, R1-R8, and C1). Next, split it by shaft key signal into fragments and label in the order. Third, smooth the signal and extract local extrema in each cycle. Fourth, re-organize the fragments by the phase and average them in a specific interval. Finally, the whole cycle of RS evolution is formed and exported as an animation.</p>
<p>There were several motivations for improved visualization of RS evolution.</p>
<p>1)   The algorithm is well developed to “de-convolute” the scanned pressure signal. However, it is mainly focused on a fixed frequency of the stall cycle, which means the other transient characteristics of the flow will be grossly distorted and should be classified as “noise” in the low-frequency domain.</p>
<p>2)   The upstream disturbance of the stator is relatively fixed to the sensors, which causes a misleading phenomenon that the upstream wake repeatedly appeared in each channel without actual physical meaning.</p>
<p>3)   The whole RS evolution can be regarded as two parts: the steady background flow and the transient stall cells rotating around the channel.</p>
<p>The first concern was improved by overlapping segments and parameter optimization of the smooth method for high signal-to-noise-ratio (SNR). The second and third concerns were solved with the idea of DMD. Because the stator wake or steady flow does not change or changes very slowly in time in the relative reference frame, it could be separated and removed for a better understanding of the mechanism of RS.</p>
<ol>
<li><h3 id="Average-scale-results-with-background-removal"><a href="#Average-scale-results-with-background-removal" class="headerlink" title="Average-scale results with background removal"></a>Average-scale results with background removal</h3></li>
</ol>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_aad6627b5b3a6d23.png" alt="img"></p>
<p>Figure 8 Large scale (20-degree average interval) components of RS evolution with DPLA-DMD background removal.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_d706aab80bd635a6.png" alt="img"></p>
<p>Figure 9 Small scale (2-degree average interval) components of RS evolution with DMD background removal.</p>
<p>Two average-scale results were compared with each other, and both made a difference with the mean flow.</p>
<p>Fig. 9 presents the dynamic pressure contours of the foreground (stall rotation) components in the relative frame within a half cycle of RS evolution, each average interval set to 20 degrees of the RS cycle. Its effect acts as the low-frequency pass filter of the signals. The straightforward visualization showed that the large-scale stall cells rotate in the opposite direction of the rotor at around 50% of rotor speed. Generally, the flow field can be divided into two sections—stalled and unstalled flow. For better physical understanding, we drew the attack angle of the main flow by merely inspecting the rapid descent of the static pressure chute. In the beginning, the successive low-pressure spots gradually form on the pressure side with the shifting attack angle. It follows with the high-pressure spot on the suction side with high-level spillage of the tip leakage flow into the next passage. The flow calms down again when the whole stall cells get over here.</p>
<p>The general pattern of RS evolution was concluded. Similar conclusions have made with Emmons’s model \cite{emmons1955compressor} used for explaining the propagation mechanism of the RS. The improved visualization presented more detail of the flow interaction in different flow scale with the help of background removal. As the blade has triggered the separation or blockage in the channel, the main flow will change the direction to adjacent blade channels on both sides. Due to the rotation of the rotor, the incidence angle in the upstream channel (same direction of the rotor) reduces, as well as the load; vice versa in the downstream channel, the incidence angle and load increase, and began to separate, then cause the decreased load of the initially blocked channel. </p>
<p>Fig. 10 shows the small-scale structure of tip leakage flow within a 2-degree-average interval. The interval from 20-degree to 40-degree is selected. The flow of three-blade channels interacts with each other, with the first-channel separation and second-channel blockage and flow spillage into the next channel. More specifically, the tip flow in the pioneer of suction side becomes unsteady with an increased incidence of main flow. As crosses to the leading edge of second blade, it induces vortex separation. A “tornado-like” radial vortex may be formed and behaves as a sizeable low-pressure region, which is early formation of spike. Several sources of flow such as TLV, main flow, as well as the leading-edge shedding flow and backflow mix together, causing a low-level spillage. However, it is much unstable and induces the high-level spillage in the same channel with time, further represented as a fixed period of RS cells around the compressor, which could maintain in a particular operation. It also reveals that the flow mechanism of RS pioneer cells is much related to the spike-type SI but in more severe stability of the system.</p>
<h2 id="6-DMD-for-shock-wave-extraction"><a href="#6-DMD-for-shock-wave-extraction" class="headerlink" title="6. DMD for shock wave extraction"></a>6. DMD for shock wave extraction</h2><p>At a transonic working point (17000 rpm), the static pressure data of the oblique array is subjected to time-delayed DMD to calculate multiple characteristic modes. The following figure shows the two most dominant modes. The left picture is the static pressure of the uniform background flow in the tip clearance, and the right picture shows the separated shock wave components. Only from static pressure maps, the phenomena of interaction between the leading edge shedding vortex and the shock wave is clearly detected: the shock wave cuts off the extension channel of the leakage vortex and accelerates the vortex shedding, so that the flow field becomes more unstable. More detailed information will be interpreted further by numerical DMD modes.</p>
<p><img src= "/img/loading.gif" data-src="file:///tmp/lu449633zoap4.tmp/lu449633zoauv_tmp_b9b8243b9204834a.png" alt="img"></p>
<p>Figure 10DMD separated modes at a transonic condition(17000 rpm)</p>
<p>The numerical calculation is accomplished by the using of a commercial CFD code, Euranus, which contains steady and unsteady solvers supported by 3D structured mesh scheme. Real air model is adopted as working fluid. For the spatial scheme, 2-order upwind with Van Leer TVD limiter is adopted. Dual time step method of Jameson[21] is used with single passage model of Rai[22] to obtained unsteady result. Spalart-Allmaras [23] model is used in modeling the turbulence. The area between section A and D in Fig.1 is chosen to be the calculation domain. The upstream channel and downstream channel are extended as much as two IGV blade chord length and three stator blade chord length respectively. O4H-type topology is adopted in every row. The y+ is less than 5 to ensure to capture the blade loading more accuracy. In order to capture the leakage flow and endwall flow, mesh in tip clearance is refined to 33 layers in radial direction. Three level multi-grid is adopted to accelerate the calculation. Mixing plane method is used to transfer the flow information between stational region and rotational region. In order to perform the unsteady simulation in single passage, the blade number of IGV and R1 are scale to the same number as R1.</p>
<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>Experimental measurements in fluid dynamics can now generate more high-fidelity data than ever before. For improved visualization of flow disturbances including RS, SI, and RI in a high-speed compressor, it calls for expert knowledge and appropriate data analysis to extract physically relevant information.<br>Dynamic spectrum analysis by the time-delay DMD method is a newly developed technique for robustly extracting RS and RI modes with the premise of phase-lock sampling. It allows for the identification and analysis of dynamical features of time-spatial fluid flows, using data obtained from the chord-wise array sensors. One-dimensional data were phase-locked and converted into two-dimensional matrices in time-delay coordinates. The Koopman theory has proved the feasibility of an approximation of nonlinear systems into an infinite-dimensional linear operator. Thus, data-driven linear transformation of the dynamical system is reconstructed, truncated SVD is implemented in order to extract the dominating modes of the dynamic system. The algorithm can effectively decompose multiple discrete structural modes, which is directly associated with the characteristic frequencies and growth/decay rates. It characterizes the corresponding circumferential mode of the rotating wave. The method was applied to the analysis of the spectral characteristics of the RI and explained the multi-spike spectrum of nearly 1/2 BPF observed under off-design conditions.</p>
<p>DPLA-DMD method was applied for reconstructing the whole cycle animation of spike-type RS in different average-scale. Background removal by DMD is better for visualization of RS evolution with its specific filtering characteristics of tip leakage flow. The result indicates that pioneer spikes of RS, originating from flow separation on the suction side near the rotor leading edge, are not formed independently but have a high connection to the flow of the adjacent channels. The channel flow between blades interacts with each other and triggers the embryonic spike to propagate. Also, the criteria for pioneer spikes initiated RS was concluded as the channel blockage and flow spillage into the next channels.</p>
<blockquote id="fn_1">
<sup>1</sup>. Day, I., 2016. “Stall, surge, and 75 years of research”. Journal of Turbomachinery, 138(1),<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#8617;</a>
</blockquote>
<p>p. 011001.<br>[2] Day, I. J., 1976. “Axial compressor stall”. PhD thesis, University of Cambridge.<br>[3] März, J., Hah, C., and Neise, W., 2001. “An experimental and numerical investigation into the<br>mechanisms of rotating instability”. In ASME Turbo Expo 2001: Power for Land, Sea, and Air,<br>American Society of Mechanical Engineers, pp. V001T03A084–V001T03A084.<br>[4] Inoue, M., Kuroumaru, M., Tanino, T., Yoshida, S., and Furukawa, M., 2001. “Comparative<br>studies on short and long length-scale stall cell propagating in an axial compressor rotor”.<br>Journal of Turbomachinery, 123(1), pp. 31–32.<br>[5] Inoue, M., Kuroumaru, M., Tanino, T., and Furukawa, M., 1999. “Propagation of multiple short<br>length-scale stall cells in an axial compressor rotor”. In ASME 1999 International Gas Tur-<br>bine and Aeroengine Congress and Exhibition, American Society of Mechanical Engineers,<br>pp. V001T03A023–V001T03A023.<br>[6] Kutz, J. N., Fu, X., Brunton, S. L., and Erichson, N. B., 2015. “Multi-resolution dynamic<br>mode decomposition for foreground/background separation and object tracking”. In 2015<br>IEEE International Conference on Computer Vision Workshop (ICCVW), IEEE, pp. 921–929.<br>[7] Moore, F. K., and Greitzer, E. M., 1986. “A theory of post-stall transients in axial compression<br>systems: Part idevelopment of equations”. Journal of engineering for gas turbines and power,<br>108(1), pp. 68–76.<br>[8] McDougall, N. M., Cumpsty, N., and Hynes, T., 1989. “Stall inception in axial compressors”. In<br>ASME 1989 International Gas Turbine and Aeroengine Congress and Exposition, American<br>Society of Mechanical Engineers, pp. V001T01A034–V001T01A034.<br>[9] Day, I., 1991. “Stall inception in axial flow compressors”. In ASME 1991 International Gas Tur-<br>bine and Aeroengine Congress and Exposition, American Society of Mechanical Engineers,<br>pp. V001T01A034–V001T01A034.<br>[10] Vo, H. D., Tan, C. S., and Greitzer, E. M., 2008. “Criteria for spike initiated rotating stall”.<br>Journal of turbomachinery, 130(1), p. 011023.<br>25<br>ASME-manuscript-DongImproved visualization of spike-type stall-wjq<br>[11] Yamada, K., Kikuta, H., Iwakiri, K.-i., Furukawa, M., and Gunjishima, S., 2013. “An expla-<br>nation for flow features of spike-type stall inception in an axial compressor rotor”. Journal of<br>turbomachinery, 135(2), p. 021023.<br>[12] Pullan, G., Young, A., Day, I., Greitzer, E., and Spakovszky, Z., 2015. “Origins and structure<br>of spike-type rotating stall”. Journal of Turbomachinery, 137(5), p. 051007.<br>[13] Weichert, S., and Day, I., 2014. “Detailed measurements of spike formation in an axial com-<br>pressor”. Journal of Turbomachinery, 136(5), p. 051006.<br>[14] Pardowitz, B., Tapken, U., Sorge, R., Thamsen, P. U., and Enghardt, L., 2014. “Rotating insta-<br>bility in an annular cascade: detailed analysis of the instationary flow phenomena”. Journal<br>of Turbomachinery, 136(6), p. 061017.<br>[15] Pardowitz, B., Tapken, U., Neuhaus, L., and Enghardt, L., 2015. “Experiments on an axial fan<br>stage: time-resolved analysis of rotating instability modes”. Journal of Engineering for Gas<br>Turbines and Power, 137(6), p. 062505.<br>[16] Mailach, R., Lehmann, I., and Vogeler, K., 2001. “Rotating instabilities in an axial compressor<br>originating from the fluctuating blade tip vortex”. Journal of turbomachinery, 123(3), pp. 453–<br>460.<br>[17] Schmid, P. J., 2010. “Dynamic mode decomposition of numerical and experimental data”.<br>Journal of fluid mechanics, 656, pp. 5–28.<br>[18] Mezić, I., 2005. “Spectral properties of dynamical systems, model reduction and decomposi-<br>tions”. Nonlinear Dynamics, 41(1-3), pp. 309–325.<br>[19] Mezić, I., 2013. “Analysis of fluid flows via spectral properties of the koopman operator”.<br>Annual Review of Fluid Mechanics, 45, pp. 357–378.<br>[20] Rowley, C. W., Mezić, I., Bagheri, S., Schlatter, P., and Henningson, D. S., 2009. “Spectral<br>analysis of nonlinear flows”. Journal of fluid mechanics, 641, pp. 115–127.<br>[21] Koopman, B. O., 1931. “Hamiltonian systems and transformation in hilbert space”. Proceed-<br>ings of the National Academy of Sciences of the United States of America, 17(5), p. 315.<br>[22] Kutz, J. N., Brunton, S. L., Brunton, B. W., and Proctor, J. L., 2016. Dynamic mode decom-<br>position: data-driven modeling of complex systems. SIAM.<br>26<br>ASME-manuscript-DongImproved visualization of spike-type stall-wjq<br>[23] Taira, K., Brunton, S. L., Dawson, S. T., Rowley, C. W., Colonius, T., McKeon, B. J., Schmidt,<br>O. T., Gordeyev, S., Theofilis, V., and Ukeiley, L. S., 2017. “Modal analysis of fluid flows: An<br>overview”. Aiaa Journal, pp. 4013–4041.<br>[24] Emmons, H., 1955. “Compressor surge and stall propagation”. Trans. of the ASME, 77(4),<br>pp. 455–467.<br>[25] Sundström, E., and Mihaescu, M., 2015. “Centrifugal compressor: The sound of surge”. In<br>21st AIAA/CEAS Aeroacoustics Conference, p. 2674.<br>[26] Semlitsch, B., and Mihăescu, M., 2016. “Flow phenomena leading to surge in a centrifugal<br>compressor”. Energy, 103, pp. 572–587.<br>[27] Xue, X., Wang, T., Shao, Y., Yang, B., and Gu, C., 2018. “Experimental and numerical analysis<br>of unsteady flow structure in a centrifugal compressor with variable vaned diffuser”. In ASME<br>Turbo Expo 2018: Turbomachinery Technical Conference and Exposition, American Society</p>
<h5 id="of-Mechanical-Engineers-pp-V02AT45A024–V02AT45A024"><a href="#of-Mechanical-Engineers-pp-V02AT45A024–V02AT45A024" class="headerlink" title="of Mechanical Engineers, pp. V02AT45A024–V02AT45A024."></a>of Mechanical Engineers, pp. V02AT45A024–V02AT45A024.</h5><h3 id="草稿"><a href="#草稿" class="headerlink" title="草稿"></a>草稿</h3><p>As shown in Fig. 1, the exhaust valve was throttled from the maximum opening (100%) to stall. The test case was set at off-design conditions of the compressor because of the presence of RI. Approximately, we can divide the throttling process into three parts: RI, prestall, and RS. Between prestall and RS, there is a critical condition of SI. The pressure is normalized as , where  is static pressure,  is the reference pressure,  is velocity of the blade tip. In the prestall process, the mass flow rate was distinctly decreased. Until the pressure ratio reaches a rather flat region and suddenly stall occurs with the rapidly decreased pressure ratio and flow rate.</p>
<!-- flag of hidden posts --></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Jiaqi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://deal-ii.com/post/DMD/">http://deal-ii.com/post/DMD/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://deal-ii.com" target="_blank">DEAL-II-Fluid</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DMD/">DMD</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/03/30/ULzlsMHcmNjKaQt.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/post/96228c88/" title="Interesting Dynamical Systems & Applications"><img class="relatedPosts_cover" data-src="https://cdn.jsdelivr.net/gh/Jiaqi-knight/imgBase@main/cover-dynamic.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-26</div><div class="relatedPosts_title">Interesting Dynamical Systems & Applications</div></div></a></div><div class="relatedPosts_item"><a href="/post/DMD1/" title="DMD"><img class="relatedPosts_cover" data-src="https://i.loli.net/2020/12/25/JsiaoQXpFZg7YI2.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-30</div><div class="relatedPosts_title">DMD</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headling"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div class="comments-items-1" data-name="Valine"><div class="vcomment" id="vcomment"></div><script>function loadvaline () {  
  var requestSetting = function (from,set) {
    var from = from
    var setting = set.split(',').filter(function(item){
    return from.indexOf(item) > -1
    });
    setting = setting.length == 0 ? from :setting;
    return setting
  }

  var guestInfo = requestSetting(['nick','mail','link'],'nick,mail,link')
  var requiredFields = requestSetting(['nick','mail'],'nick,mail')

  function initValine () {
    window.valine = new Valine({
      el:'#vcomment',
      appId: 'lJ3vEzEWaeVa6HpWNNbPrauw-gzGzoHsz',
      appKey: '16FI6zgDXwvw71g04yhHnnW0',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: guestInfo,
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      requiredFields: requiredFields
    });
  }
  loadScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || false) {
  window.addEventListener('load', loadvaline)
}
else {
  function loadOtherComment () {
    loadvaline()
  }
}</script></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> Jiaqi</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/calendar.js"></script><script src="/js/languages.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="/gitcalendar/js/gitcalendar.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":120,"height":260},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>